\documentclass[12pt]{report}


\usepackage{fouriernc}%la fuente
%\usepackage[sc]{mathpazo} %antigua fuente

\usepackage[utf8]{inputenc}

\usepackage[a4paper,width=150mm,top=25mm,bottom=25mm]{geometry}






\usepackage{graphicx}

\graphicspath{{./Figuras/Teoria extremal de grafos/}{./Figuras/}{./Figuras/Numeros extremales en grafos bipartitos/}{./Figuras/Teoria de Ramsey/}{./Figuras/Metodo-probabilistico-1/}{./Figuras/Conexidad-de-grafos-aleatorios/}{./Figuras/Eleccion-aleatoria-dependiente/}} %esto es para que encuentre las figuras hechas con pdf_tex en inkscape

\usepackage{framed}
\usepackage[dvipsnames]{xcolor} %agrega mas colores para xcolor.

%\usepackage[outdir=./]{epstopdf} %sin esto importar eps es imposible



\usepackage{xparse}
\usepackage{xstring}

\usepackage{stmaryrd} %para poner el comando \mapsfrom "<---|"

\usepackage{amssymb}

\usepackage{amsmath}

\usepackage{subfig}

\usepackage{mathrsfs} % para tener mas tipos de texto: \mathscr que es una letra mayuscula cursiva.

\usepackage{tikz-cd}

\usepackage{tkz-graph}%este paquete es para crear grafos con el ambiente \begin{tikzpicture}

\usepackage{caption}

\usepackage[shortlabels]{enumitem}

\usepackage{mathabx}
\let\widering\relax %esto es porque hay problemas con el comando \widering que se define en la fuenta fouriernc y en el paquete \usepackage{mathabx}

\usepackage[spanish,activeacute]{babel}

\usepackage{xparse}
\usepackage{xstring}

\usepackage{braket} %para definir \set , \Set y que los conjuntos se vean mas lindos

\usepackage{mathtools}

\usepackage[shortlabels]{enumitem}


\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=red,
    filecolor=red,
    linkcolor=red,
    urlcolor=red
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsthm}

\usepackage{subfiles} %esto es para modularizar el overleaf
%para usar este paquete solamente hay que usar el comando
%\subfile{}
%funciona mejor al final


\theoremstyle{plain}
\newtheorem{theorem}{Teorema}[section]
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{proposition}[theorem]{Proposición}
\newtheorem{proposition/definition}[theorem]{Proposición/Definición}
\newtheorem{corollary}[theorem]{Corolario}
\newtheorem{conjecture}[theorem]{Conjetura}
\newtheorem{afirmacion}[theorem]{Afirmación}
\newtheorem{recuerdo}[theorem]{Recuerdo}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definición}
\newtheorem{hypothesis}[theorem]{Hipótesis}
\newtheorem{example}[theorem]{Ejemplo}
\newtheorem{obs}[theorem]{Observación}
\newtheorem{notation}[theorem]{Notación}
\newtheorem{remark}[theorem]{Comentario}


%por alguna razon el teorema $warning  est aen uso, asi que lo remuevo de maqnera trucha
\newtheorem{warn}[theorem]{\textbf{ADVERTENCIA}}
\renewenvironment{warning}{\begin{warn}}{\end{warn}}

%crear ejercicio
\newtheorem{exercise}[theorem]{Ejercicio}
%solución
\newenvironment{solution}{\begin{proof}[Solución]}{\end{proof}}





%como crear un nuevo ambiente de teorema o proposición que este sobreado con un recuadro de "color". primero hacemos

%\newenvironment{Theorem}{\colorlet{shadecolor}{color} \begin{shaded} \begin{theorem} }{ \end{theorem} \end{shaded} }

%Notar que primero hay que definir el color del sobreado con el comando
%"\colorlet{shadecolor}{color}" y luego hay que usar el environment "shaded". Adentro de este ponemos el environment que queremos, en nuestro caso queremos "pintar" el environment "\begin{theorem}".


%se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newenvironment{Definition}{\colorlet{shadecolor}{Apricot!12} \begin{shaded} \begin{definition} }{ \end{definition} \end{shaded} }

\newenvironment{Example}{\colorlet{shadecolor}{Goldenrod!16} \begin{shaded} \begin{example}}{ \end{example} \end{shaded}}

\newenvironment{Remark}{\colorlet{shadecolor}{Orchid!12} \begin{shaded} \begin{remark}}{ \end{remark} \end{shaded}}

\newenvironment{Warning}{\colorlet{shadecolor}{red!12} \begin{shaded} \begin{warning}}{ \end{warning} \end{shaded}}

\newenvironment{Conjecture}{\colorlet{shadecolor}{magenta!16} \begin{shaded} \begin{conjecture}}{ \end{conjecture} \end{shaded}}

\newenvironment{Theorem}{\colorlet{shadecolor}{OliveGreen!18} \begin{shaded} \begin{theorem}}{ \end{theorem} \end{shaded}}

\newenvironment{Lemma}{\colorlet{shadecolor}{LimeGreen!12} \begin{shaded} \begin{lemma}}{ \end{lemma} \end{shaded}}

\newenvironment{Proposition}{\colorlet{shadecolor}{Green!12} \begin{shaded} \begin{proposition}}{ \end{proposition}\end{shaded}}

\newenvironment{Corollary}{\colorlet{shadecolor}{TealBlue!16} \begin{shaded} \begin{corollary}}{ \end{corollary} \end{shaded}}

\newenvironment{Obs}{\colorlet{shadecolor}{Dandelion!22} \begin{shaded} \begin{obs}}{ \end{obs} \end{shaded}}

\newenvironment{Exercise}{\colorlet{shadecolor}{Lavender!12} \begin{shaded} \begin{exercise}}{ \end{exercise} \end{shaded}}

%%%%%COLORES%%%%%%%%%%%%
%Hay varios comandos del paquete Xcolor:
%\color{blue,green,red,yellow,orange,black,white,pink,purble,etc...} hace que todo el bloque de texto se transforme en este color, se puede encerrar entre {} el bloque de texto que uno quiere colorear
%\textcolor{color}{text} escribe el texto "text" en "color".
%\colorbox{color}{text} pinta un rectangulo de "color" detrás del "text".
%\shaded



%lista de colores base de xcolor, como son colores de la extension del paquetem, empiezan con la primera letra mayuscula: si usaramos solo el paquete {xcolor} entonces no sería necesario.

%red, Green (fluorecente), Blue (muy obscuro), Cyan, Magenta, Yellow, Black, Gray, lightgray, White, darkgray, lightgray, Brown, lime (este verde mas lindo manzana), olive (marron verdoso feo), Orange, pink, Purple, teal (verde marino), Violet

%marco los colores lindos: red, Cyan, Magenta, Yellow, Black, Gray, White,  lime, Orange, pink, teal, Violet

%Colores que incluye el paquete dvipsnames: Apricot (color beige), Brown, Goldenrod, JungleGreen, Salmon, Lavender, SpringGreen, Turquoise, Plum, Emerald, BurntOrange (naranja piola), ForestGreen (verde oscuro), BrickRed (rojo obscuro)


\newcommand{\red}[1]{\textcolor{BrickRed}{#1}}

			\newcommand{\comentario}[1]{\red{#1}}

\newcommand{\green}[1]{\textcolor{SpringGreen}{#1}}

\newcommand{\blue}[1]{\textcolor{Cyan}{#1}}

\newcommand{\darkblue}[1]{\textcolor{Cyan!70!Black}{#1}}

\newcommand{\yellow}[1]{\textcolor{yellow!80!Black}{#1}} %se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newcommand{\black}[1]{\textcolor{Black}{#1}}

\newcommand{\gray}[1]{\textcolor{Gray}{#1}}

\newcommand{\purple}[1]{\textcolor{Purple}{#1}}

\newcommand{\beige}[1]{\textcolor{Apricot}{#1}}

\newcommand{\darkgreen}[1]{\textcolor{ForestGreen}{#1}}

\newcommand{\pink}[1]{\textcolor{Lavender}{#1}}

\newcommand{\salmon}[1]{\textcolor{Salmon}{#1}}

\newcommand{\brown}[1]{\textcolor{RawSienna!50!Black}{#1}}

\newcommand{\white}[1]{\textcolor{White}{#1}}

\newcommand{\orange}[1]{\textcolor{BurntOrange}{#1}}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%grupos de matrices
%SL
\newcommand{\SL}[2]{\operatorname{SL}_{#1} ( #2)}
%GL
\newcommand{\GL}[2]{\operatorname{GL}_{#1} ( #2)}

%matriz identidad
\newcommand{\Id}{\operatorname{Id}}



%enteros Z
\newcommand{\integers}{\mathbb{Z}}
%racionales
\newcommand{\rationals}{\mathbb{Q}}
%naturales
\newcommand{\naturals}{\mathbb{N}}
%reales R
\newcommand{\reals}{\mathbb{R}}
%imaginarios
\newcommand{\complex}{\mathbb{C}}
%p-adicos
\newcommand{\padics}{\mathbb{Q}_p}
%enteros p-adicos
\newcommand{\padicintegers}{\mathbb{Z}_p}

%cuerpos finitos
%Fp
\newcommand{\Fp}{\mathbb{F}_p}
%Fq
\newcommand{\Fq}{\mathbb{F}_q}



%valor absoluto p-adico
\newcommand{\abs}[1]{\left \vert #1 \right \vert}
%valor absoluto p-adico
\newcommand{\Abs}[1]{\left \vert \left \vert #1 \right \vert \right \vert}
%valuacion p-adica
\newcommand{\val}[1]{\operatorname{val} (#1)}

%Hom
\newcommand{\Hom}{\operatorname{Hom}}

%imagen y núcleo
\newcommand{\Imagen}{\operatorname{Im}}
\newcommand{\Ker}{\operatorname{Ker}}

%coker
\newcommand{\Coker}{\operatorname{Coker}}

%limite inverso
\newcommand{\liminv}{\varprojlim}


%un poco de typeset para categorias
\newcommand{\catname}[1]{{\operatorfont\textbf{#1}}}


\renewcommand{\hat}[1]{\widehat{#1}}
\renewcommand{\bar}[1]{\overline{#1}}

%declaro un comando nuevo para escribir restricción de funciones
\newcommand\rest[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}


%%%%   COMANDO ALGEBRA CONMUTATIVA   %%%%

%altura de un ideal:
\newcommand{\height}{\textsc{height}}

%Clausura topológica
\newcommand{\closure}[1]{\overline{#1}}

%longitud de un A-modulo. Notacion: \length_A M
\newcommand{\length}{\operatorname{length}}

%Anulador de un $A$-módulo.
\newcommand{\Ann}[1]{\operatorname{Ann} (#1)}

%Cuerpo de fracciones. Notacion $\FracField A$.
\newcommand{\FracField}[1]{\operatorname{Fr} (#1)}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






%%%%   COMANDO TEORÍA DE NÚMEROS  %%%%

%Discriminante
\newcommand{\discriminant}[1]{\mathfrak{d} (#1 )}

%%%%Ideales primos%%%
%escribe una letra en notación mathfrak, para denotar a un ideal o elemento primo.

\newcommand{\primo}[1]{\mathfrak{#1}}
\newcommand{\Primo}[1]{\mathfrak{\MakeUppercase{#1}}}

%anillo de enteros O_K
\renewcommand{\O}{\mathcal{O}}
%anillo de enteros con subindice de cuerpo (input, por ejemplo $K$).
\newcommand{\integralring}[1]{O_{#1}}

%caracteristica de un cuerpo Char k
\newcommand{\Char}[1]{\operatorname{Char} #1}

%traza. Notación \trace = Tr
\newcommand{\trace}{\operatorname{Tr}}

%Traza de extensiones. Notación \Tr L K \alpha = \operatorname{Tr}_{L/K} (\alpha)
\newcommand{\Tr}[1]{\operatorname{Tr}_{L/K} (#1)} %la extension es L/K por default
\newcommand{\tr}[3]{\operatorname{Tr}_{#1/#2} (#3)}

%Norma de extensiones. Notación \Norm L K \alpha = \operatorname{N}_{L/K} (\alpha)
\newcommand{\Norm}[1]{\operatorname{N}_{L/K} (#1)}%la extension es L/K por default
\newcommand{\norm}[3]{\operatorname{N}_{#1/#2} (#3)}


%discriminante de una forma bilineal simetrica. notacion \disc{B} = \operatorname{disc} ( B)
\newcommand{\disc}[1]{\operatorname{disc} (#1)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%COMANDO GRAFOS%%%%%%%%%%%%%

%\ceil funcion techo
\newcommand{\ceil}[1]{\left\lceil #1  \right\rceil}

%\floor funcion piso
\newcommand{\floor}[1]{\left\lfloor #1  \right\rfloor}

%diámetro de un grafo
\newcommand{\diam}[1]{\operatorname{diam} (#1)}

%radio de un grafo
\newcommand{\rad}[1]{\operatorname{rad}(#1)}

%Kappa:
\newcommand{\Kappa}{\mathcal{K}}

%Defecto:
\newcommand{\defecto}[1]{\mathrm{df}(#1)}

%Conjunto de últimos vértices de una familia \mathcal P de caminos dirigidos: \ter{\mathcal P}
\newcommand{\ter}[1]{\operatorname{ter} (#1)}

%numero de coloreo de un grafo G:
\newcommand{\col}[1]{\operatorname{col} (#1)}

%número de lista coloreo de un grafo G:
\newcommand{\ch}[1]{\operatorname{ch} (#1)}



%Número extremal
\newcommand{\ex}[2]{\operatorname{ex} (#1, #2)}









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{numeroSeccion}[section]%ponemos un contador que empieza en 0 y que cuenta el número de seccion

\newcounter{numeroCapitulo}[chapter]

\newcounter{numeroDibujo}[numeroSeccion]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Cada dibujo se puede automatizar:
%1) necesitamos el archivo "Dibujo n.png" en la carpeta "Clase m", donde $n$ es el número del dibujo y $m$ es el número de la clase.



\renewcommand\thefigure{\thesection.\arabic{figure}}

%el comando Dibujo tiene dos inputs \Dibujo{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Dibujo}{O{1} m m}{
\stepcounter{numeroDibujo}
\begin{center}\label{Figura:Capitulo \thenumeroCapitulo - Seccion \thenumeroSeccion Dibujo \thenumeroDibujo}
\includegraphics[width=#1\columnwidth]{#3}
\captionof{figure}{#2}
\end{center}
}


%el comando Inkscape tiene dos inputs \Inkscape{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Inkscape}{O{1} m m}{
\stepcounter{numeroDibujo}
\begin{center}\label{Figura:Capitulo \thenumeroCapitulo - Seccion \thenumeroSeccion Dibujo \thenumeroDibujo}
\def\svgwidth{#1\textwidth}
\input{#3}
\captionof{figure}{#2}
\end{center}
}

\DeclareCaptionFormat{custom}
{%
    \textbf{#1#2}\textit{ #3}
}
\captionsetup{format=custom}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Apuntes - Tópicos en matemática discreta}
\author{Enzo Giannotta}






\begin{document}

\maketitle

%--------------------------------- ACA VA LA TABLA DE CONTENIDOS

\tableofcontents

%---------------------------------






\chapter{Teoría extremal de grafos}

En este curso trabajaremos con grafos simples, usualmente denotados: $G=(V,E)$.

\section{Teoría extremal de grafos}

¿Cuál es la máxima cantidad de aristas que puede tener un grafo de $n$ vértices sin que aparezca una cierta estructura?

¿Cómo lucen estos grafos maximales?

\begin{example}
\begin{enumerate}
\item Cuando la estructura es un ciclo, la cantidad de aristas es $n-1$ y los grafos maximales son los árboles.
\item Cuando la estructura es un ciclo impar. ¿Cómo lucen los grafos sin ciclos impares y que tienen una cantidad máxima de aristas? Son los completos balanceados $K_{\ceil {\frac n 2},\floor{\frac n 2}}$. En efecto, para que un grafo bipartito con $n$ vértices tenga una cantidad máxima de aristas, tiene dos partes $\abs X, \abs Y$ con $\abs X + \abs Y = n$ y si maximiza la cantidad de aristas es un grafo $K_{\abs X, \abs Y}$. Es decir, tiene $\abs X \cdot \abs Y$ aristas y si maximizamos, hay que maximizar la función $f(y) = (n-y)y$ con $1 \leq y \leq n-1$ e $y$ entero; esto sucede sii $y = \lfloor {\frac n 2} \rfloor$ o $y = \lceil \frac n 2 \rceil$.
\end{enumerate}
\end{example}

\begin{definition}
Sean $G$ y $H$ dos grafos. Decimos que $G$ es \textbf{H}-libre (o \textbf{libre de $H$}) si $H \nsubset G$. El \textbf{número extremal} de $H$ es la cantidad
\[
    \ex n H = \max \{e (G) | G \text{ es un grafo de $n$ vértices $H$-libre}\},
\]
donde $e(G)$ siempre denotará el número de aristas de $G$.

Si $G$ es $H$-libre y $\Abs G = \ex n H$, decimos que $G$ es \textbf{extremal} respecto de $n$ y $H$.
\end{definition}


\begin{theorem}[Mantel, 1907]
Sea $n \in \naturals$, $G$ un grafo $K_3$-libre con $n$ vértices. Entonces, $e(G) \leq \ceil{\frac n 2} \floor {\frac n 2}$. Además, $e(G) = \ceil{\frac n 2} \floor {\frac n 2} \Leftrightarrow G = K_{\ceil{\frac n 2}, \floor {\frac n 2}}$\footnote{Cuando $n = 1,2$ tenemos que $G$ es el completo $K_n$}.
\end{theorem}
\begin{proof}
Por inducción en $n$. Los casos $n = 1, n=2$ son un vértice, un $1$-camino respectivamente. Luego vale para $n=1,2$. Ahora, supongamos que $n \geq 3$. Sea $G$ un grafo $K_3$-libre con $n$ vértices, y $uv \in E(G)$ (si $G$ no tuviera aristas, podríamos agregar una arista y seguiría siendo $K_3$-libre); consideremos $G' = G \setminus \{u,v\}$. Tenemos que $G'$ también es $K_3$-libre y tiene $n-2$ vértices. Por inducción, $G'$ satisface
\[
    e(G') \leq \ceil{\frac {n-2} 2} \floor {\frac {n-2} 2}.
\]
Más aún, como $G$ es $K_3$-libre, no existen vértices $w \in G'$ tal que sea adyacente a $u$ y $v$ al mismo tiempo. Luego existen a lo más $n-2$ aristas en $E(G) \setminus E(G')$ sin contar la arista $uv$. Es decir,
\[
    e(G) \leq e(G') + n-1 \leq \ceil{\frac n 2} \floor {\frac n 2}.
\]
\Inkscape{Ilustración}{"./Figuras/Teoria extremal de grafos/Dibujo 1.pdf_tex"}


Para la segunda parte, $e(G) =\ceil{\frac n 2} \floor {\frac n 2} \Leftrightarrow G = K_{\ceil {\frac{n}{2}} , \floor {\frac{n}{2}}}$. Es claro que si $G = K_{\ceil{\frac n 2}, \floor {\frac n 2}}$ luego $e (G) = \ceil{\frac n 2}, \floor {\frac n 2}$. Veamos la recíproca. Sea $G$ con $n$ vértices y cantidad máxima de aristas tal que es $K_3$-libre. Los casos $n=1,2$ son triviales, luego podemos suponer que $\abs G \geq 3$. Como $G$ es $K_3$-libre, existen una aristas $uv \in E(G)$ por maximalidad. Por inducción, $G':= G \setminus \{u,v\}$ es un $K_{\ceil{\frac {n-2} 2}, \floor {\frac {n-2} 2}}$, digamos con partición $X',Y' \subset V(G')$ de sus vértices. Como $G$ es $K_3$-libre, ni $u$ ni $v$ pueden tener vecinos en $G'$ que estén en ambas particiones $X',Y'$, además, no puede haber una partición que no tenga a $u$ y $v$ como vecinos en $G$ pues podríamos agregar aristas entre vértices de esa particiones: contradiciendo maximalidad. Sin pérdida de generalidad, los vecinos de $u$ en $G'$ están en $X$ y los de $v$ en $Y$. Más aún, por maximalidad, todos los vértices de $X$ son vecinos con $u$ y todos los de $Y$ con $v$. Así, $G$ es un $X,Y$ bigrafo tomando $X := X' \cup \{v\}$ e $Y := Y' \cup \{u\}$. Notar que esto prueba que $G$ es un $K_{\ceil{\frac n 2}, \floor {\frac n 2}}$.


\end{proof}


\begin{definition}
El \textbf{grafo de Turán} $T_k (n)$ es el grafo $k$-partito completo con la mayor cantidad de aristas, es decir, los cardinales de las particiones difieren a lo más en $1$ entre sí (por maximalidad). Notamos
\[
    t_k(n) := e(T_k (n)).
\]
\end{definition}

\begin{obs}
Podemos calcular $t_k(n)$. Sea $\alpha \in \naturals$ el cardinal más grande de una partición de $T_k (n)$. Entonces las demás particiones tienen cardinal $\alpha$ o $\alpha -1$. Sea $r$ la cantidad de particiones con cardinal $\alpha -1$ y $k-r$ de cardinal $\alpha$. Tenemos que sumando los cardinales de todas las particiones:
\[
    \alpha k - r = n.
\]
Como $0 \leq r < k$, $r$ es el resto de la división de $n$ por $k$ y $\alpha$ es el cociente. Despejando obtenemos que $\alpha = \frac{n+r}{k}$ es decir, $\alpha = \lceil \frac{n}{k} \rceil$. En particular $\alpha -1 = \lfloor \frac{n}{k} \rfloor$. Juntado todo, tenemos que la cantidad total de aristas es:
\[
    \alpha^2 \binom{k-r}2 + \alpha (\alpha -1) (k-r)r + (\alpha-1)^2 \binom{r}2,
\]
i.e.,
\[
    \boxed{t_k(n) = \lceil \frac{n}{k} \rceil^2 \binom{k-r}2 + \lceil \frac{n}{k} \rceil \lfloor \frac{n}{k} \rfloor (k-r) r + \lfloor \frac{n}{k} \rfloor^2 \binom r 2.}
\]
\end{obs}


\begin{theorem}[Turán, 1941]\label{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}
Sean $n,k \in \naturals$, $G$ un grafo $K_{k+1}$-libre con $n$ vértice. Entonces
\[
    e(G) \leq t_k (n).
\]
Además, $e(G) = t_k (n) \Leftrightarrow G = T_k (n)$\footnote{Cuando $n = 1,2, \ldots, k-1$ tenemos que $G$ es el completo $K_n$}.
\end{theorem}

\begin{proof}
Hagamos inducción en $n$. Para $n \leq k$ es trivial. Sea ahora $G$ con $n \geq k+1$ que a su vez es $K_{k+1}$-libre y arista maximal. Esto implica que agregar cualquier arista hace aparecer un $K_{k+1}$ como subgrafo. Entonces $G$ contiene un $K_{k}$. Sea $A$ el conjunto de vértices de un subgrafo $K_{k}$ en $G$. Consideremos luego $G' = G\setminus A$. El grafo $G'$ es $K_{k+1}$-libre y tiene $n-k$ vértices. Cada $x \in V(G')$ tiene a lo más $k-1$ vecinos en $A$ dentro del grafo $G$, pues $G$ es $K_{k+1}$-libre. Luego por hipótesis inductiva:
\[
    e(G') \leq t_k(n-k).
\]
Si juntamos esto con la hipotesis inductiva, tenemos que
\[
    e(G) \leq e(G') + (n-k) (k-1) + \binom {k} 2    \leq t_k (n-k) + (n-k) \cdot (k-1) + \binom {k} 2 = t_k (n),
\]
donde el segundo término es la cantidad de aristas entre $A$ y $V(G')$.

Veamos ahora la segunda afirmación. Por definición, $G = T_k (n)$ tiene $t_k (n)$ aristas. Recíprocamente, supongamos que $G$ con $n$ vértices y cantidad máxima de aristas $e(G)$ tal que es $K_{k+1}$-libre. Los casos $n \leq k$ son triviales, luego supongamos que $n \geq k+1$. Por maximalidad, $G$ contiene un $K_{k}$ como subgrafo; llamemos $A$ a su conjunto de vértices en $G$ y consideremos $G' := G \setminus A$. Notar que
\[
    e(G') \geq e(G)- \left ( (n-k) (k-1) + \binom {k} 2 \right ) = t_k (n) -(n-k) (k-1) - \binom{k} 2 = t_k(n-k),
\]
pues cada vértice de $G'$ tiene a lo más $k-1$ vecinos en $A$. Como $G'$ es $K_{k+1}$-libre, en realidad vale la igualdad: $e(G') = t_k (n-k)$, por la primera parte que ya demostramos. Llamemos $X_1, X_2, \ldots, X_k$ a las particiones de $G'$. Como vale la igualdad arriba, tenemos que cada vértice de $G'$ tiene exactamente $k-1$ vecinos en $A$. Para cada $x' \in G'$ llamemos $\alpha(x')$ al único vértice de $A$ que no es adyacente a $x'$ en $G$. Más formalmente, $\alpha : V(G') \rightarrow A$ es una función; afirmamos que:
\begin{enumerate}[(i)]
\item $\alpha$ es sobreyectiva.
\item Si $x_i ' \in X_i$ y $x_j ' \in X_j$ para $i \neq j$, entonces $\alpha (x_i') \neq \alpha (x_j')$.
\end{enumerate}
Antes de probar la afirmación, notemos que esta prueba que
$\rest{\alpha}{X_i}$ es constante para cada $i = 1, \ldots, k$ (y por lo tanto tiene sentido el abuso de notación $\alpha (X_i)$ para denotar al único vértice de $A$ que no es adyacente a ningún vértice $x' \in X_i$). Veamos entonces la afirmación:
\begin{enumerate}[(i)]
\item Supongamos que $\alpha$ no es sobreyectiva: existe un $a_0 \in A$ tal que para todo $i = 1, \ldots, k$ existe $x_i ' \in X_i$ adyacente a $a_0$ en $G$. Pero esto implica entonces que los vértices $x_1' , \ldots, x_k ', a_0$ forman un $K_{k+1}$ en $G$, absurdo.
\item En efecto, si $\alpha (x_i ') = a_0 = \alpha (x_j ')$, entonces $x_i, x_j$ y los vértices de $A \setminus \{a_0\}$ juntos forman un $K_{k+1}$ en $G$, absurdo.
\end{enumerate}

Así, podemos extender la partición de $G'$ a todo $G$: definimos $\tilde X_i := X_i \cup \{\alpha (X_i)\}$. Es claro que de esta manera $G$ es un grafo $k$-partito completo. Como $G$ es maximal en su cantidad de aristas, entonces $G = T_k (n)$.
\end{proof}




\begin{theorem}[Erdös - segunda demostración del teorema]
Sean $n, k  \in \naturals    $ y $G$ un grafo $K_{k+1}$-libre con $n$ vértices. Entonces existe un grafo $H$ que es $k$-partito con $V(H) = V(G)$ tal que:
\[
    d_H (v) \geq d_G (v) , \quad \forall v \in V(G).
\]
\end{theorem}
\begin{proof}[Erdös]
Haremos inducción en $k$. Para $k = 1$ no hay que hacer nada. Sea ahora $k \geq 2$. Sea $v \in V(G)$ con $d_G (v) = \Delta (G)$. La vecindad de $v$, $G' := G[N_G (v)]$ debe ser $K_{k}$-libre. Sea $A := G \setminus N_G (v)$. Notar que
\[
    d_{G} (u) \leq d_{G'} (u) + \abs A.
\]
Por hipótesis inductiva existe un grafo $H'$ que es $(k-1)$-partito con $V(H') = V(G')$ y
\[
    d_{H'} (u) \geq d_{G'} (u), \quad \forall u \in V(G').
\]
Sea $H$ el grafo obtenido a paratir de $H'$ añadiendo los vértices de $A$ y conectando todos los vértices entre $A$ y $V(H')$. Observar que $H$ es $k+1$-partito y como $v$ tiene grado máximo en $G$, tenemos que para cada $u \in A$:
\[
    d_G (u) \leq d_G (v) = \abs{V(H')} = d_H (u)
\]
y para $u \in V(H')$ sabemos que:
\[
    d_G (u) \leq d_{G'} (u) + \abs A    \underset{H.I.}{\leq} d_{H'} (u) + \abs A = d_H (u).
\]
\end{proof}

\begin{exercise}
A partir de la demostración deducir que el grafo $K_{k+1}$-extremal es $T_k (n)$ y es único.
\end{exercise}
\begin{solution}
Sea $G$ un grafo $K_{k+1}$-extremal y $H$ el grafo $r$-partito obtenido por el Teorema anterior. Así, $V(H) = V(G)$ y $d_H (v) \geq d_G (v)$ para todo vértice $v$. Esta desigualdad implica que
\[
    e(H) \geq e(G),
\]
y por lo tanto, $H$ también es $K_{r+1}$-extremal. Pero por definición, $t_k (n) \geq e(H)$. Pero ya vimos que los grafos $K_{r+1}$ extremales tienen $\geq t_k (n)$ aritas. Con lo cual, en realidad $e(G) = e(H)$ y más aún, $d_H (v) = d_G (v)$ para todo $v$.

Esto nos indica que inspeccionando la demostración más detalladamanete, se tiene que $G'$ es un $T_{k-1} (\Delta)$ (con $\Delta := \Delta (G)$) y que $G$ es luego $T_k (n)$.
\end{solution}

\begin{obs}\label{obs:notar que si H es no bipartito entonces ex(n,H)= Theta (n2)}
Sea $H$ un grafo con $\chi (H) \geq 3$, es decir no bipartito, entonces
\[
    \ex n H \sim  n^2.
\]
\end{obs}
\begin{proof}
En primer lugar, si $G$ es un grafo que contiene a $H$, luego no puede ser bipartito. En particular, si $G = K_{\ceil { \frac n 2} , \floor {\frac n 2}}$, entonces es $H$-libre al ser bipartito; de hecho tiene $n$ vértices y $e(G) = \ceil { \frac n 2} \floor {\frac n 2}$. Consecuentemente
\[
    (n-1)^2/4 \leq  \ceil { \frac n 2} \floor {\frac n 2} \leq \ex n H.
\]

Por otro lado, la cantidad de aristas maxima de $G$ es $\binom n 2$ (en general para cualquier grafo con $n$ vértices) y por lo tanto $\ex n H = \Theta (n^2)$.
\end{proof}




\section{Números extremales en grafos bipartitos}


\begin{recuerdo}[Desigualdad de Jensen]
Vamos a usar la desigualdad de Jensen: si $\varphi$ es una función convexa entonces:
\[
    \boxed{\varphi(\mathbb E (X)) \leq \mathbb E (\varphi (X)).}
\]
\end{recuerdo}


\begin{exercise}
Probar las siguientes dos desigualdades elementales para el binomio de Newton:
\[
    \left(\frac n k \right)^k \overset{\text{Cota 1}}{\leq} \binom n k \overset{\text{Cota 2}}{\leq} \left(\frac{n \cdot e}{k}\right)^k.
\]
\end{exercise}
\begin{solution}
\begin{enumerate}
\item[]
\item[Cota 1:] Notar que
\[
    \binom n k = \frac{n}{k} \cdot \frac{n-1}{k-1} \cdots \frac{n-k+1}{1}\geq \left ( \frac n k \right )^k,
\]
pues $\frac n k \leq \frac{n - j}{k - j}$ para todo $j = 0 , \ldots, k$.
\item[Cota 2:] Notar que se tiene una mejor cota:
\[
    \binom n k = \frac{n \cdot (n-1) \cdots (n-k + 1)}{k!} \leq \frac{n^k}{k!}.
\]
Por lo tanto, como $e^x = \sum_{k = 0}^\infty \frac{x^k}{k!}$, se sigue que $e^k \geq \frac{k^k}{k!}$, y luego
\[
    \frac{n^k}{k!} \leq \frac{n^ke^k}{k^k},
\]
como queríamos.
\end{enumerate}
\end{solution}

\begin{theorem}[Erdös, 1938]
Para todo $n \in \naturals$
\[
    \ex n {C_4} \leq n^{\frac 3 2}.
\]
\end{theorem}

\begin{definition}
Una \textbf{cereza} es un $2$-camino $x_0 x_1 x_2$. Llamaremos a $x_1$ el \textbf{centro} y a $x_0,x_2$ las \textbf{hojas}.
\end{definition}

\Inkscape{Dibujo de cereza.}{"./Figuras/Numeros extremales en grafos bipartitos/Dibujo 1.pdf_tex"}

\begin{proof}
Sea $G$ un grafo $C_4$-libre con $n$ vértices. Contaremos cereza en $G$ para acotar el número de aristas $e(G)$.

Para cada vértice $v \in V(G)$ hay exactamente
\[
    \binom{d_G(v)}{2} \text{ cerezas con centro en $v$}.
\]
Por lo tanto, en $G$ hay
\[
    \sum_{v \in V(G)} \binom{d_G(v)}{2} \text{ cerezas en $G$}.
\]
Por la desigualdad de Jensen la sumatoria se minimiza cuando todos los grados son iguales:
\begin{align*}
    \sum_{v \in V(G)} \binom{d_G(v)}{2} &\geq n \cdot \binom{2 e(g) / n}{2} \\
                                        &\overset{Cota 1}{\geq} n \cdot \left ( \frac{e(G)}{n} \right )^2 = \frac{e(G)^2}{n}.
\end{align*}
Por otro lado, dado un par $\{u,v\}$ de hojas de cerezas distintas, entonces tendríamos un subgrafo $C_4$ en $G$, absurdo; por lo tanto hay a lo más
\[
    \binom{n} 2 \text{ cerezas en $G$}.
\]

Juntando todo:
\[
    \frac{e(G)^2}{n} \leq \binom n 2 = \frac{n(n-1)}{2},
\]
consecuentemente $e(G)^2 \leq n^3$, i.e., $e(G) \leq n^{\frac{3}{2}}$.
\end{proof}




\begin{theorem}[Kövani, Sós, Turán]\label{th:teorema de kovani sos turan - extremalidad de Kst}
Sean $s, t \in \naturals$, $s \leq t$. Entonces existe una constante $c = c(s,t) > 0$ tal que
\[
    \ex n {K_{s,t}} \leq c \cdot n^{2 - \frac 1 s}, \quad \forall n \in \naturals.
\]
\end{theorem}

\begin{definition}
Una \textbf{$s$-cereza} es un $K_{1,s}$. Similarmente tenemos la noción de \textbf{centro} y \textbf{hojas} (las cuales son $s$).
\Inkscape{Dibujo de $s$-cereza.}{"./Figuras/Numeros extremales en grafos bipartitos/Dibujo 2.pdf_tex"}
\end{definition}

\begin{proof}
Sea $G$ un grafo $K_{s,t}$-libre en $n$ vértices. Para cada $v \in V(G)$ hay $\binom{d_G(v)}{s}$ $s$-cerezas. Por lo tanto en $G$ hay
\[
    \sum_{v \in V(G)} \binom{d_G(v)}{s} \quad \text{$s$-cerezas},
\]
con lo cual
\[
    \sum_{v \in V(G)} \binom{d_G (v)} s \overset{\text{Cota 1}}{\geq} \sum_{v \in V(G)} \frac{d_G (v)^s}{s^s} \overset{\text{Jensen}}{\geq} \frac{n}{s^s} \left ( \frac{2e(G)}{n} \right)^s .
\]
Procediendo de manera análoga a la demostración del teorema anterior, tenemos que un conjunto de $s$ vértices del grafo puede ser conjunto de hojas de a lo más $(t-1)$ cerezas, pues de lo contrario habría una copia de $K_{s,t}$. Por lo tanto, hay en total a lo más
\[
    (t-1) \cdot \binom{n}s \text{ $s$-cerezas}.
\]

Juntando todo:
\[
    n \left ( \frac{2 e(G)}{s n} \right)^s \leq (t-1) \cdot \binom n s \overset{\text{Cota 2}}{\leq} (t-1) \cdot \left (\frac{n e}{s} \right )^s,
\]
luego
\[
    \frac{2 e(G)}{s n} \leq \frac{(t-1)^{\frac 1 s}}{n^{\frac 1 s}} \cdot \frac{n e}{s},
\]
equivalentemente,
\[
    e(G) \leq {\frac{(t-1)^{\frac 1 s} s e}{2 s}} \cdot n^{2-\frac{1}{s}} = c(s,t ) \cdot n ^{2 - \frac 1 s}.
\]
\end{proof}

\begin{exercise}
Demostrar que
\[
    \ex n H = o (n^2) \quad \Leftrightarrow \quad H \text{ es bipartito}.
\]
\end{exercise}
\begin{solution}
Como $H$ es bipartito, existen $s,t \in \naturals$, digamos $s \leq t$, tales $H \subset K_{s,t}$. Así, por el Teorema de \ref{th:teorema de kovani sos turan - extremalidad de Kst},
\[
    \ex n H \leq c(s,t) \cdot n^{2 - \frac{1}{s}},
\]
pues si $G$ no contiene a $H$, tampoco contiene a $K_{s,t}$. Así, obtenemos que $\ex n H = o(n^2)$.

Recíprocamente, supongamos que $H$ no es bipartito, luego por la Observación \ref{obs:notar que si H es no bipartito entonces ex(n,H)= Theta (n2)}, $\ex n H = \Theta (n^2)$. Con lo cual, si $\ex n H= o (n^2)$, necesariamente $H$ es bipartito.
\end{solution}


\section{Números extremales para árboles}



\begin{theorem}
Sean $n,k \in \naturals$ y $T$ un árbol con $k+1$ vértices. Entonces,
\[
    \ex n T \leq (k-1) \cdot n.
\]
\end{theorem}

\begin{lemma}\label{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices}
Sean $k \in \naturals$ y $T$ un árbol con $k+1$ vértices. Entonces si $G$ es un grafo con $\delta (G) \geq k$, luego contiene a $T$ como subgrafo.
\end{lemma}
\begin{proof}
Haremos inducción en $k$. Para $k = 1$ es claro, pues existe un vértice con al menos un vecino. En general, supongamos que $k \geq 2$. Sea $h$ una hoja de $T$ y consideremos el árbol $T' = T \setminus \{h\}$. Por hipótesis inductiva, $T' \subset G$. Sea $p$ el único vecino de $h$ en $T$, i.e. $p \in T'$. Como $T$ tiene $k+1$ vértices, $p$ tiene a lo más $k-1$ vecinos en $T'$, luego $p$ tiene un vecino en $G$ que no está en $T'$ pues $\delta_G (p) \geq k$. Entonces podemos incrustar $T$ en $G$ considerando $h$ como este vértice.
\end{proof}

\begin{lemma}\label{lema:lema 2 - teorema de extremalidad de arboles}
Todo grafo $G$ contiene un subgrafo $H$ con $\delta (H) > \varepsilon (H) \geq \frac{e(G)}{n}$, donde $n = \abs G$.
\end{lemma}
\begin{proof}
Construiremos una secuencia de subgrafos de $G$:
\[
    G =: G_0 \supset G_1 \supset \cdots
\]
de la siguiente manera, si $v_i \in G_i$ es un vértice con $d_{G_i} (v_i) \leq \varepsilon (G_i) := \frac{e(G_i)}{\abs{G_i}}$, entonces definimos $G_{i+1} := G_i \setminus \{v_i\}$. Eventualmente esta secuencia termina, digamos en $H := G_{j_0}$.

Notar que $\varepsilon (G_{i+1}) \geq \varepsilon (G_i)$, y por lo tanto $\varepsilon (H) \geq \varepsilon (G)$. En efecto,
\[
    \varepsilon (G_{i+1}) = \frac{e(G_{i+1})}{\abs{G_{i+1}}} = \frac{e(G_i) - d_{G_i} (v_i)}{\abs{G_i} - 1},
\]
que es mayor o igual que $\frac{e(G_i)}{\abs{G_i}}$ si y solo si
\[
    (e(G_i) - d_{G_i} (v_i)) \abs{G_i} \geq e(G_i)(\abs{G_i} - 1),
\]
equivalentemente,
\[
    e(G_i) \geq \abs{G_i} d_{G_i} (v_i),
\]
i.e.,
\[
    \frac{e(G_i)}{\abs{G_i}} \geq d_{G_i} (v_i),
\]
que es cierto por construcción. Por otro lado, por minimalidad de $H$, se sigue que $\delta (H) > \varepsilon (H)$.
\end{proof}

\begin{proof}[Demostración del teorema]
Sea $G$ un grafo con $\geq (k-1) \cdot n + 1$ aristas. Por el segundo lema, $G$ contiene $H$ con
\[
    \delta (H) \geq \frac{e(G)}{n} > \frac{(k-1) n}{n},
\]
y por el primer lema $T \subset H \subset G$.
\end{proof}

\begin{conjecture}[Erdös, Sós, 1963]
Se conjetura que en el teorema anterior se tiene una mejor cota:
\[
    \ex n T \leq \frac 1 2 (k-1) n.
\]

Notar que de ser verdadera la conjetura, entonces esta cota es tight cuando $n$ es un múltiplo de $k$: Sea $G$ el grafo obtenido al unir $\frac n k$ copias de $K_k$, así $e(G) = \frac n k \binom k 2 = \frac n 2 (k-1)$.

Esta conjetura es verdadera en el caso \underline{$T$ un camino}:
\end{conjecture}

\begin{theorem}[Erdös \& Gallai, 1959]
Sean $n, k \in \naturals$. Entonces,
\[
    \ex n {P_k} \leq \frac{(k-1) \cdot n}{2}
\]
\end{theorem}
\begin{exercise}
A partir de la demostración de este teorema, obtenga que los grafos extremales son únicos.
\end{exercise}

\begin{lemma}\label{lema:grafo G conexo con n vertices tiene un camino de largo al menos 2 delta o n-1}
Todo grafo conexo $G$ con $n$ vértices contiene un camino de largo
\[
    k := \min \{2 \delta (G)+1, n-1\}.
\]
\end{lemma}
\begin{proof}
Tomemos $P := v_0, \ldots, ,v_l$ camino de largo máximo. Sabemos que $N_G (v_0)$, $N_G (v_l) \subset V(P)$ por maximalidad de $P$. Si $V(P) = V(G)$ ganamos. Así que supongamos que no; supongamos también que $l < k\leq 2\delta (G)+1$. Demostraremos que existe un ciclo de longitud $l$ contenido en $G[V(P)]$, así llegaremos a una contradicción pues al existir un vértice $x$ fuera de $G[V(P)]$ en $G$, podríamos extender el ciclo a un camino de longitud al menos $l+1$ en $G$ conectándolo con $x$.

\Inkscape{Notar que en este caso $v_0 P v_{i-1} v_l P v_i v_0$ es un ciclo de longitud $\abs P$ en $G[V(P)]$.}{"./Figuras/Numeros extremales para arboles/figura.pdf_tex"}

En efecto, supongamos que no existe tal ciclo, luego para cada $i \in \{1, \ldots, l-1\}$ se tiene que $v_{i-1}v_l \not \in E(G)$ o $v_0 v_i \not \in E(G)$. Entonces
\[
    2 \delta(G) \leq d_G (v_0) + d_G (v_l) \leq l -1< 2 \delta (G),
\]
absurdo.
\end{proof}


\begin{proof}[Demostración del teorema]
Haremos inducción en $n$. Afirmamos que $G$ es $P_k$-libre en $n$ vérties, entonces
\[
    e(G) \leq \frac{(k-1)\cdot n}{2}.
\]
El caso base es $n \leq k$, luego $e(G) \leq \binom n 2 = \frac{n (n-1)}{2} \leq \frac{n (k-1)}{2}$. Luego supongamos que $n \geq k+1$. Si $G$ no es conexo: sean $G_1, \ldots, G_r$ las componentes conexas, por hipótesis
\[
    e(G_i) \leq \frac{\abs{G_i} (k-1)}{2},
\]
entonces
\[
    e(G) = \sum_{i = 1}^r e(G_i) \leq \frac{k-1}{2} \sum_{i =1}^r \abs {G_i} = \frac{n (k-1)}{2}.
\]

Ahora, supongamos que $G$ es conexo. Si $n-1 \leq 2 \delta (G)$, entonces por el Lema \ref{lema:grafo G conexo con n vertices tiene un camino de largo al menos 2 delta o n-1}, $G$ contiene un camino de largo $n-1 \geq k$, absurdo. Con lo cual, podemos asumir que $2 \delta (G) \leq n-1$, y por el Lema, $G$ contiene un camino de largo $2 \delta (G)$ que debe cumplir
\[
    2\delta (G) < k \quad \Leftrightarrow \quad \delta (G) \leq \frac{k-1}{2}.
\]
Sea $v$ un vértice de grado $\leq \frac{k-1}{2}$, consideremos $G' := G \setminus \{v\}$. Por hipótesis inductiva
\[
    e(G') \leq \frac{(n-1)(k-1)}{2},
\]
con lo cual,
\[
    e(G) \leq e(G') + \frac{k-1}{2} \leq \frac{(n-1)(k-1)}{2} + \frac{k-1}{2} = \frac{n(k-1)}{2}.
\]
\end{proof}



\section{Estabilidad y supersaturación}

\begin{theorem}[Füredi, 2015]\label{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos}
Sean $n,t \in \naturals$, y $G$ con $n$ vértices. Si $G$ está \textbf{$t$-lejos} de ser bipartito\footnote{Esto significa que si $H$ es un subgrafo bipartito de $G$, entonces $e(H) \leq e(G)-t$.}, entonces hay al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos en $G$.
\end{theorem}
\begin{proof}
Para cada $u \in V(G)$, definimos
\[
    B_u := N_G (u) \quad \text{y} \quad A_u := V(G) \setminus B_u.
\]
Luego la cantidad de tríangulos de $G$ es:
\[
    k_3 (G) = \frac 1 3 \sum_{u \in V(G)} e(B_u).
\]

Para cada $u \in V(G)$, si borro las aristas de $G[B_u]$ y las de $G[A_u]$, obtengo un subgrafo bipartito de $G$: el $(A_u,B_u)$-bigrafo; luego tuvimos que haber quitado al menos $t$ aristas porque $G$ está $t$-lejos de ser bipartito, es decir:
\[
    e(B_u) + e(A_u) \geq t.
\]

Además, para cada $u \in V(G)$
\[
    \sum_{v \in A_u} d_G (v) = e(B_u, A_u) + 2e (A_u).
\]
Como
\[
    e(G) = e(A_u) + e(A_u, B_u) + e(B_u),
\]
se sigue que $e (A_u) = e(B_u) - e(G) + \sum_{v \in A_u} d_G (v)$ (juntando ambas ecuaciones). Ahora, por la desigualdad $e(B_u) + e (A_u)\geq t$, se tiene que
\[
    e(B_u) \geq t - e(A_u) = t +e(G) - e(B_u) - \sum_{v \in A_u} d_G (v)
\]
y por lo tanto
\[
    2 e(B_u) \geq t + e(G) - \sum_{v \in A_u} d_G (v).
\]
Sumando sobre todos los $u \in V(G)$ y utilizando que $k_3 (G) = \frac 1 3 \sum_{u \in V(G)} e (B_u)$, concluimos:
\[
    k_3 (G) \geq \frac 1 2 \cdot \frac 1 3 (n t + n e(G) - \sum_{u \in V(G) } \sum_{v \in A_u} d_G (v));
\]
sin embargo, afirmamos que vale la siguiente igualdad:
\[
    \sum_{u \in V(G)} \sum_{v \in A_u} d_G (v) = \sum_{x \in V(G)} d_G (x) ( n - d_G (x));
\]
ya que cada término de la sumatoria se acota inferiormente por $\frac n 2  \cdot (n - \frac n 2) = \frac{n^2}{2}$, concluimos el resultado.

Veamos la afirmación: notar que para cada $x \in V(G)$, su cantidad de aristas $d_G (x)$ es contada exactamente $\abs {A_x} = n - d_G (x)$ veces del lado izquierdo de la sumatoria.
\end{proof}

Como corolario, se prueban los siguientes dos teoremas:
\begin{theorem}[Estabilidad]
Sean $n,t \in \naturals$, y $G$ es $K_3$-libre con $n$ vértices. Si $e(G) \geq \frac{n^2}{4}- t$, entonces $G$ contiene un grafo bipartito con al menos $e(G)-t$ aristas.
\end{theorem}
\begin{proof}
Si $G$ no tuviera un grafo bipartito con al menos $e(G) - t$ aristas, entonces $G$ estaría $(t+1)$-lejos de ser bipartito. Por el Teorema \ref{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos} tiene al menos
\[
    \frac{n}{6} \left ( e(G) - \frac{n^2}{4} + (t + 1) \right ) \geq \frac n 6
\]
triángulos, i.e., al menos uno, lo cual es absurdo.
\end{proof}

\begin{theorem}[Supersaturación]
Sean $n,t \in \naturals$, y $G$ un grafo con $n$ vértices. Si $e(G) \geq \frac{n^2}{4} + t$, entonces $G$ contiene al menos $t \cdot n /3$ triángulos.
\end{theorem}
\begin{proof}
Notar que $G$ está $t$-lejos de ser bipartito, en efecto, un grafo bipartito de orden $m \leq n$ tiene a lo más $\frac{m^2}{4}\leq \frac{n^2}{4}$ aristas, pero $G$ tiene al menos $\frac{n^2}{4} + t \geq \frac{m^2}{4} + t$ aristas. Luego por el Teorema \ref{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos}, $G$ tiene
\[
    \frac{n}{6} \left ( e(G) - \frac{n^2}{4} + (t + 1) \right ) \geq \frac{n}{3} t
\]
triángulos.
\end{proof}


\bigskip

\begin{theorem}[Füredi, 2015 -- Estabilidad]\label{theorem:teorema de estabilidad de furedi}
Sean $n,k \in \naturals$, $t \geq 0$ y $G$ un grafo $K_{k+1}$-libre en $n$-vértices. Si $e(G) \geq t_k (n)- t$, entonces $G$ contiene un subgrafo generador $k$-partito con al menos $e(G)-t$ aristas.
\end{theorem}
\begin{proof}
Haremos inducción en $k$. El caso $k = 1$ tenemos que $t_k (n) = 0$ y siempre se cumple. Entonces supongamos que $k \geq 2$. Tomemos $u \in V(G)$ con $d_G (u) = \Delta (G)$. Definamos $G' := G[B]$ con $B = N_G (u)$. Sea $A = V(G) \setminus B$. El grafo $G'$ es $K_k$-libre porque $G$ es $K_{k+1}$-libre, luego por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}, $e(G') \leq t_{k-1} (d)$ con $d := \abs B$ y entonces podemos definir $t' := t_{k-1}(d) - e(G') \geq 0$ y aplicar hipótesis inductiva al grafo $G'$. Así, $G'$ contiene un subgrafo $H'$ generador $(k-1)$-partito con al menos $e(G') - t' = 2 e(G') - t_{k-1} (d)$ aristas.

 Probemos que
\[
    H := \big (V(H') \cup A, E(H') \cup E(A,B) \big)
\]
tiene al menos $e(G) - t$ aristas, y así $H$ es un subgrafo $k$-partito generador de $G$ con al menos $e(G)- t$ aristas. En efecto, queremos probar que
\[
    e(H') + e(A, B) \geq e(G) - t;
\]
como $e(G) = e(A,B) + e(G') + e(A)$, la desigualdad de arriba es equivalente a
\[
    e(H') \geq e(G') + e(A) - t \quad \Leftrightarrow \quad e(H') - e(G') + t \geq e(A).
\]
Ya que $e(H') \geq e(G') - t'$, nos queda que la última desigualdad es cierta si $e(A) \leq t - t'$.

Sabemos que
\[
     2 e(A) + e(A,B) = \sum_{v \in A} d_G (v) \leq d \cdot (n - d),
\]
donde la desigualdad sale de que la sumatoria tiene $(n-d)$ términos y cada grado $d_G(v) \leq \Delta (G) = d_G(u) = \abs B = d$;
y reemplacemos $e(A,B) = e(G) - e(A) - e(G')$ y nos queda
\[
    e(A) + e(G) - e(G') \leq d \cdot (n-d).
\]
Ahora, notar que
\[
    t_k (n) \geq t_{k-1} (d) + d \cdot (n-d),
\]
pues el lado izquierdo es la cantidad de aristas de un grafo de Turán (la cual es máxima) y el lado derecho es la cantidad de aristas de un grafo $k$-partito en $n$-vértices: el obtenido a patir del grafo de turán $T_{k-1} (d)$ agregando $n-d$ vértices y conectándolos a las $k-1$ particiones de $T_{k-1} (d)$. Juntando todo,
\[
    e(A ) \leq d \cdot (n-d) - \overbrace{e(G)}^{\geq t_k (n) -t} + \overbrace{e(G')}^{=t_{k-1} (d) - t'} \leq d \cdot (n-d) - t_k (n) + t + t_{k-1} (d) - t' \leq t - t'
\]
como queríamos probar.
\end{proof}



\section{Teorema de Erdös-Stone}


\begin{notation}
Notaremos por $K_s (t)$ al grafo de Turán $T_{s} (t \cdot s)$.
\end{notation}

\begin{theorem}[Erdös-Stone, 1946]\label{th:teorema de Erdos-stone}
Sea $H$ un grafo con $e(H) \geq 1$. Entonces
\[
    \ex n H \leq \left ( 1 - \frac{1}{\chi (H) - 1}  + o (1) \right) \cdot \frac{n^2}{2} \quad (n \to \infty). \\
\]
\end{theorem}

\begin{obs}
Sea $H$ un grafo con $e(H) \geq 1$. Entonces
\[
    t_{\chi (H) -1} (n) \leq \ex n H,
\]
pues todo grafo $G$ necesita de al menos $\chi (H)$ colores para tener a $H$ incrustado, por lo tanto $T_{\chi (H) - 1} (n)$ es $H$-libre.
\end{obs}

\begin{obs}\label{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2}
\[
t_{\chi (H) - 1 } (n) \sim \left ( 1 - \frac{1}{\chi (H)- 1}\right ) \frac{n^2}{2}.
\]
Con lo cual, la desigualdad de Erdös-Stone es asintóticamente justa.
\end{obs}
\begin{proof}
En efecto, esto equivale a probar que
\[
    t_{k} (n) \sim \left (1 - \frac 1 {k} \right ) \frac{n^2}{2} \quad (n \to \infty),
\]
para $k \geq 2$ fijo. Escribiendo $n = q k + r$ con $0 \leq r < k$, tenemos que
\[
    t_k (q k) \leq t_k (n) \leq t_k((q+1)k),
\]
pero para cualquier $q \in \naturals$ es fácil de calcular el número de aristas del grafo de Turán $T_k (q k)$:
\[
    t_k (q k) = \left ( 1 - \frac 1 k \right ) \frac{(q k)^2}{2},
\]
con lo cual $t_k (q k) , t_k ((q+1)k) \sim \left ( 1 - \frac 1 k \right)  \frac {n^2}{2}$ y por lo tanto $t_k (n)$ también.
\end{proof}

\begin{lemma}\label{lema:erdos-stone lema 1}
Sea $c \in (0,1)$ y sea $\varepsilon > 0$. Si $G$ es un grafo con $n$ vértices, con $n$ lo suficientemente grande tal que
\[
    e(G) \geq c \frac{n^2}{2},
\]
entonces existe un subgrafo $G' \subset G$ con
\[
    \abs{G'} \geq \varepsilon n \quad \text y \quad \delta (G') \geq (c- \varepsilon) \abs{G'}.
\]
\end{lemma}
\begin{proof}
Sea $G_n, G_{n-1}, G_{n-2}, \ldots, G_t$ la secuencia de subgrafos de $G$ obtenida de la siguiente manera: $G_n := G$ y el grafo $G_{n - (i+1)}$ se obtiene a partir de $G_{n-i}$ borrando un vértice $v \in V(G_{n-i})$ con $d_{G_{n-i}} (v) < (c - \varepsilon) \cdot \abs{G_{n-i}}$; además, $G_t$ es el último grafo de la secuencia. Notar que $\abs{G_{n-i}} = n - i$.

Afirmamos que $t \geq \varepsilon n$ para $n$ lo suficientemente grande, y por ende, $G_t$ será el subgrafo que buscabamos: por construcción $\delta (G_t) \geq (c - \varepsilon) \abs{G_t}$. Para eso, calculamos la cantidad total de aristas borradas para la obtención de $G_t$:
\[
    \sum_{i = 0}^{n-(t+1)} d_{G_{n-i}} (v_i) < (c-\varepsilon) \sum_{i = 0}^{n-(t+1)} n-i = (c-\varepsilon) (n-t) (n+t+1)/2,
\]
y como $G_t$ tiene a lo más $\binom t 2$ aristas, tenemos que
\[
    e(G) \leq (c- \varepsilon) (n-t) (n+ t + 1)/2 + \binom t 2 .
\]

Supongamos por el absurdo que $t \leq \varepsilon n$. Nuestro objetivo es acotar el lado derecho:
\begin{align*}
e(G) \leq (c- \varepsilon) (n-t) (n+ t + 1)/2 + \binom t 2  &= (c- \varepsilon) \frac{(n^2 + n  - (t^2 + t))}{2} + \frac{t(t-1)}{2} \\
&\leq (c-\varepsilon) \frac{n^2 + n}{2 } + \frac{\varepsilon n (\varepsilon n - 1)}{2} \\
&= (c- \varepsilon + \varepsilon^2)\frac{n^2}{2} + (c - 2\varepsilon) \frac{n}{2}.
\end{align*}


Notar que el lado derecho es un polinomio cuadrático en la variable $n$ con coeficiente principal $\frac{c-\varepsilon + \varepsilon^2}{2} < \frac c 2$
y por lo tanto para $n$ lo suficientemente grande, se contradice la desigualdad $c\frac{n^2}{2} \leq e(G)$. Así, $t \geq \varepsilon n$.
\end{proof}

\begin{lemma}\label{lema:erdos-stone lema 2}
Para todo $r, t \in \naturals$ y $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $G$ es un grafo con $n \geq n_0$ vértices y
\[
    \delta (G) \geq \left ( 1 - \frac 1 r + \varepsilon \right ) n
\]
luego $K_{r+1} (t) \subset G$.
\end{lemma}
\begin{proof}
Procedemos por inducción en $r$. Para $r = 1$, tenemos que $K_2 (t) = K_{t,t}$ y sabemos que en este caso $\ex n {K_{t,t}} = o (n^2)$. Como $n$ es lo suficientemente grande, $K_{t,t} \subset G$. En efecto, se tendrá que
\[
    e(G) = \frac 1 2 \sum_{v \in G} d_G (v ) \geq \frac{\delta (G) n}{2} \geq \left (1 - \frac 1 r + \varepsilon \right ) \frac{n^2}{2}.
\]


Ahora, supongamos que $r \geq 2$. Primero, encontraremos por hipótesis inductiva, una copia de $K_{r} (q)$ con $q \geq t/\varepsilon$; escribamos $A := \bigcup_{i = 1}^r A_i$ a la partición de los vértices de $K_r (q)$.

Luego, definimos $X \subset B := V(G) \setminus A$, el conjunto de todos los vértices que tienen al menos $t$ vecinos en cada $A_i$. Mostramos que $\abs X \to \infty$ cuando $n \to \infty$. Para esto, acotamos $e(A,B)$ por abajo:
\begin{align*}
    e(A,B) &= \sum_{v \in A}  d_G (v) - 2 e(A) \\
        &\geq q r  \left (1 - \frac 1 r + \varepsilon \right )n - 2 \frac{(q r)^2}{2}.
\end{align*}
Y acotamos por arriba:
\[
    e(A,B) \leq \abs X  q r + ( \abs B - \abs X) ( q (r-1) + t - 1).
\]
Juntando ambas desigualdades, tenemos:
\[
    n\underbrace{(q r \varepsilon - t  + 1)}_{>0} + q^2 (- r^2 +r - 1) - q (t- 1) \leq \abs X \underbrace{( q - t +1)}_{> 0}
\]
Por lo tanto, se sigue lo que queremos cuando $n \to \infty$.

Finalmente, demostramos que existen conjuntos
\[
    B_i \subset A_i \text{ con } \abs {B_i} = t \text{ y $t$ vértices $x \in X$ que satisfacen } N_G (x) \supset B_i,
\]
de donde concluiremos que $K_{r+1} (t) \subset G$.
Sea $x \in X$, existen a lo más $\binom q t$ formas de elegir $B_i^x$ en $A_i$, donde $B_i^x$ satisface $\abs{B_i^x} = t$ y $N_G (x) \subset B_i^x$. Si $\abs X > \binom q t ^r \cdot (t-1)$, entonces por el principio del palomar tenemos lo que queremos.
\end{proof}

\begin{proof}[Demostración del Teorema]
Observemos que $H$ está contenido en el grafo $\chi (H)$-partito, completo y con partes de tamaño $\abs H$, es decir, en $K_{\chi (H)} (\abs H)$. Con lo cual, basta probar el teorema para $H' := K_{r} (t)$ con $r := \chi (H)$ y $t := \abs H$. De hecho, probaremos que para cualquier $r \geq 2$, $t \in \naturals$, $ \varepsilon > 0$, existe $n_0 \in \naturals$ tal que:
\[
    \ex n { K_{r} (t)} \leq \left (1 - \frac 1 {r-1} + \varepsilon \right ) \frac{n^2}{2} \quad (n \geq n_0).
\]

Sea $\varepsilon > 0$ arbitrariamente pequeño. Sea $n$ lo suficientemente grande, y $G$ con $n$ vértices tal que
\[
    e(G) \geq \left ( 1 - \frac 1 {r-1} + \varepsilon \right ) \frac{n^2}{2}.
\]
Aplicamos el primer lema \ref{lema:erdos-stone lema 1} con $c = 1 - \frac 1 {r-1} + \varepsilon$ y $\frac{\varepsilon}{2}$. Así, obtenemos un subgrafo $G' \subset G$ con
\[
    \abs{G'} \geq \frac{\varepsilon}{2} n \quad \text y \quad \delta (G') \geq \left ( 1 - \frac 1 {r-1} + \frac{\varepsilon}{2} \right ) \abs{G'}.
\]
Como $n$ es lo suficientemente grande: $\frac{\varepsilon}{2} n \geq n_0$, y por el segundo lema \ref{lema:erdos-stone lema 2}, $G'$ contiene a $K_{r} (t)$, y por lo tanto $G$ también. El resultado se sigue.
\end{proof}


\begin{definition}
$G$ está \textbf{$t$-cerca} de ser $r$-partito si existe un subgrafo $r$-partito de $G$ con al menos $e(G) - t$ aristas.
\end{definition}





\begin{theorem}[Teorema de Estabilidad de Erdös-simonovits]\label{Teorema de Estabilidad de Erdos-simonovits version H general}
Para todo grafo $H$ con $e(H) \geq 1$, para todo $\varepsilon > 0$ existe $\delta > 0$ tal que: si $G$ es $H$-libre en $n$-vertices y
\[
    e(G) \geq \left ( 1 - \frac {1}{\chi (H) - 1} - \delta \right) \binom n 2.
\]
Entonces $G$ está $(\varepsilon n^2)$-cerca de ser $(\chi (H) - 1)$-partito.
\end{theorem}

Haremos la demostración con $H = K_{r+1}$ y para $H$ general lo haremos con el Lema de Regularidad \ref{theorem:lema de regularidad de szemeredi}.

\begin{quote}\label{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}
Para todo $\varepsilon > 0$ lo suficientemente chico, existe $\delta > 0$ tal que: si $G$ es $K_{r+1}$-libre en $n$-vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta\right) \overbrace{\binom n 2}^{\sim \frac {n^2}2},
\]
entonces $G$ está $(\varepsilon n^2)$-cerca de ser $r$-partito.
\end{quote}

Requerimos probar dos lemas previos:

\begin{lemma}\label{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 1}
Sea $r \in \naturals$ y $\delta > 0$ y $n$ suficientemente grande. Si $G$ es $K_{r+1}$-libre con $n$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta^2\right) \frac{n^2}2,
\]
entonces existe $G' \subset G$ con $\abs{G'} \geq (1 - \delta)n $ y
\[
    \delta (G') \geq \left ( 1 - \frac 1 r - \delta \right) \abs { G'}.
\]
\end{lemma}
\begin{proof}
De la demostración del Lema \ref{lema:erdos-stone lema 1} se deduce un enunciado más fuerte:
\begin{quote}
Dados $r \in \naturals$ y $c\in (0,1)$. Para todo $\varepsilon > 0$ existe $n_0 \in \naturals$ tal que para todo grafo $G$ con $n \geq n_0$ vértices y
\[
    e(G) \geq c \frac{n^2}{2},
\]
existe un subgrafo $G_{t} \subset G$ con $\abs {G_t} = t \geq \varepsilon n$ y $\delta (G_t) \geq (c- \varepsilon) \abs{G_t}$; más aún,
\[
    e(G) \leq e(G_t) + (c- \varepsilon) (n-t) (n+t+1)/2.
\]
\end{quote}

Ahora, dado $\delta > 0$, el cual sin pérdida de generalidad lo podemos asumir $\delta < \frac 1 2$, tomamos $c := \left ( 1 - \frac 1 r - \delta^2 \right ) > 0$ y $\varepsilon = \delta - \delta^2>0$. Supongamos que $G$ es un grafo con $n$ vértices $K_{r+1}$-libre, y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta^2 \right ) \frac{n^2}{2} = c \frac {n^2}{2},
\]
luego existe un subgrafo $G_t \subset G$ con $t \geq (\delta - \delta^2) n$ vértices. Como en la demostración de la Observación \ref{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2} se ve que $t_r (t) \sim  \left ( 1 - \frac 1 r \right) \frac{t^2}{2} \:\: (t \to \infty)$, podemos suponer que existe $n_0 \in \naturals$ tal que si $n \geq n_0$, entonces $t_r (t) \leq \left ( 1 - \frac 1 r + \gamma \right ) \frac{t^2}{2}$, para $\gamma := \frac{\delta^2}{2}$.

Ahora, como $G$ es $K_{r+1}$-libre, entonces $G_t$ también y se tiene que
\[
    e(G_t) \leq \ex t {K_{r+1}} \leq t_r (t) \leq \left (1 - \frac 1 r + \frac{\delta^2}{2} \right) \frac{t^2}{2},
\]
por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}. Juntando esto con lo mencionado al principio, tenemos que
\begin{align*}
    c \frac{n^2}{2} \leq e(G) &\leq e (G_t) + (c- \varepsilon) (n-t) (n+t+1)/2 \\
    &\leq \left (1 - \frac 1 r + \frac{ \delta^2}2 \right) \frac{t^2}{2} + (c- \varepsilon) (n-t) (n+t+1)/2 \\
    &= \left (1 - \frac 1 r + \frac{ \delta^2}2 \right) \frac{t^2}{2} + (c- \varepsilon) \frac{(n^2 + n - t^2 - t)}{2},
\end{align*}
esto implica que para $n$ lo suficientemente grande de tal suerte que $\frac{(c - \varepsilon)}{2} n \leq \frac{\varepsilon }{2} \frac{n^2}{2}$,
\[
    \varepsilon \frac{n^2}{4}  \leq (\delta + \frac{\delta^2}{2}) \frac{t^2}{2}.
\]
Reemplazando $\varepsilon = \delta - \delta^2$ en la última desigualdad, y despejando $t$:
\[
    \sqrt{\frac{\delta - \delta^2}{2 \delta + \delta^2}} n \leq t.
\]
Como la expresión de la izquierda es más grande que $(1 - \delta)$ cuando $\delta < \frac 1 2$, se sigue que para todo $n$ lo suficientemente grande,
\[
    \abs {G_t}  = t \geq (1 - \delta) n.
\]
Es decir, $G_t$ es el subgrafo $G'$ de $G$ que cumple las propiedades deseadas del enunciado.
\end{proof}

\begin{lemma}\label{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2}
Para todo $r \in \naturals$, para todo $\varepsilon > 0$, existe $\delta > 0$ tal que si $G$ es $K_{r+1}$-libre con $n$ vértices y
\[
    \delta (G) \geq \left ( 1 - \frac 1 r - \delta \right) n,
\]
entonces existe una partición $V(G) = A_0 \coprod A_1 \coprod \cdots \coprod A_r$ tal que $\abs {A_0} \leq \varepsilon n$ y $A_i$ son conjuntos independientes para todo $i \geq 1$.
\end{lemma}
\begin{proof}
Si tomamos $\delta >0$ lo suficientemente pequeño, entonces $G$ contiene una copia de $K_r$ por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)} (esto ocurre si $e(G) \geq \left ( 1 - \frac 1 {r-1} \right)\frac{n^2}{2}$; tomar $\delta < \frac 1 {r-1} - \frac 1 r$ y notar que en la demostración de la Observación \ref{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2} se ve que $t_r (t) \sim  \left ( 1 - \frac 1 r \right) \frac{t^2}{2} \:\: (t \to \infty)$).

Sea $A$ un conjunto de vértices que induce un $K_r$ en $G$. Sean $B := V(G) \setminus A$ y $X := \set{v \in V(G) | \abs{N_G (v) \cap A} \leq r -2}$, vamos a mostrar que $X$ es pequeño.
\begin{align*}
\left ( 1 - \frac 1 r - \delta \right ) n r - r (r-1) &\leq e(A, B) \quad \quad \left ( 2 e(A) + e(A,B) = \sum_{v \in A} d_G (v) \geq r \left (1 - \frac 1 r - \delta \right )n \right )\\
                &\leq (r-1) \big ((n-r) -\abs X \big) + (r-2) \abs X  = (r-1) (n-r) - \abs X,
\end{align*}
manipulando la desigualdad, obtenemos:
\[
    \abs X \leq \delta n r.
\]
Tomando $\delta < \min \{\frac{\varepsilon}{r}, \frac 1{r-1} - \frac 1 r\}$, el $A_0$ será $X$ y los consjuntos independientes son:
\[
    A_u = \{u\} \cup \{v \in B \setminus X | vu \not \in E(G)\}
\]
para cada $u \in A$.
\end{proof}

Ahora estamos en condiciones de demostrar el Teorema de Estabilidad de Erdos-Simonovits para $H = K_{r+1}$ \ref{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}:

\begin{proof}[Demostración del Teorema de Estabilidad de Erdos-Simonovits para $H =K_{r+1}$ \ref{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}]

Sea $\varepsilon > 0$ chico, tomemos $\delta = (\delta ')^2$ donde $\delta'$ se obtiene del Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2} con $\varepsilon ' < \frac \varepsilon 2$. Notar que de la demostración podemos suponer que si $\varepsilon > 0$ es chico, luego $\delta ' < \frac {\varepsilon ' }2$ también. Por hipótesis
\[
    e(G) \geq \left ( 1 - \frac 1 r - (\delta ')^2 \right ) \frac{n^2}{2},
\]
entonces por el Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 1}: existe $G' \subset G$ con $n' := \abs{G'} \geq ( 1 - \delta ')n$ y $\delta (G') \geq \left ( 1 - \frac 1 r - \delta' \right) \abs {G'} = n'$. Por el Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2}: para $\varepsilon ' < \frac \varepsilon 2$ se tiene que existe $A_0, A_1, \ldots, A_r$ partición de $G'$ con $\abs {A_0} < \varepsilon ' n ' \leq \varepsilon ' n$ y $A_i$ conjuntos independientes para todo $i \geq 1$. Así el subgrafo generado por los $A_i$ con $i \geq 1$ es $r$-partito. Además, para obtener este subgrafo, hay que quitar a lo más
\[
    \varepsilon ' n ^2 + \varepsilon ' n^2 < \varepsilon n^2 \quad \quad ( \delta , \delta ' \ll 1)
\]
aristas de $G$, es decir, $G$ está $\varepsilon n^2$-cerca de ser $r$-partito. En efecto, las aristas de $G[V(G) \setminus V(G')]$ junto con $E_G(V(G'), V(G) \setminus V(G'))$ aportan $\leq \binom { \delta ' n} 2 + n' \cdot (n - n') \leq \delta ' n^2 + \delta ' n^2 \leq \varepsilon ' n^2$, y las de $G[V(A_0)]$ junto con $E_G(V(A_0), V(G) \setminus V(A_0))$ aportan
\[
    \leq \binom{\varepsilon' n}2 + (\varepsilon ' n) \cdot (\delta ') n \leq \varepsilon ' n^2.
\]
\end{proof}







\section{Ejercicios}

\begin{exercise}
Puebe el teorema de Mantel de manera alternativa. Considere un conjunto independiente $B$ de tamaño máximo en un grafo $K_3$-libre  y la suma de los grados de los vértices que no están en $B$.
\end{exercise}

\begin{solution}
Sea $G$ un grafo $K_3$-libre con orden $n$ y $B$ un conjunto independiente de $G$ de tamaño máximo; consideremos $A := V(G) \setminus B$. Inspeccionemos la sumatoria
\[
    \sum_{v \in A} d_G (v);
\]
notar que $d_G (v) = \abs{N_G (v)}$ y que $N_G (v)$ es un conjunto de vértices aislados en $G$: si $x,y$ son dos vecinos de $v$ entonces $xy \not \in E(G)$ porque de lo contrario $G$ tendría un triángulo $xyv$. Así, como $\abs B$ es máximo, se sigue que $\abs{N_G (v)} \leq \abs B$. Esto implica que
\[
    \sum_{v \in A} d_G (v) \leq \abs A \abs B   .
\]
Más aún, como $A,B$ particionan $V(G)$: $\abs A + \abs B = n$. Luego $\abs{A} \cdot \abs B$ se maximiza cuando $\abs A \abs B = \floor{\frac n 2} \ceil{\frac n 2} = t_2 (n)$. Así,
\[
    e(G) = e(A,B) + e(A) \leq e(A,B) + 2 e(A) = \sum_{v \in A} d_G (v) \leq t_2 (n),
\]
como queríamos probar.
\end{solution}

\begin{remark}
Que $\abs A \cdot \abs B$ con $\abs A + \abs B = n$ se maximiza cuando $\abs A \cdot \abs B = \floor {\frac n 2} \ceil {\frac n 2}$ se deduce de que reemplazando $\abs B = n - \abs A$, el problema equivale a maximizar $\abs A \cdot (n - \abs A)$. Más formalmente, el problema equivale a maximizar $f (x) = x (n - x)$ con $x$ número natural en el intervalo $[0, n]$. Simplemente notemos que $f'(x) = n - 2 x$, luego $f$ es creciente en $[0, \frac n 2]$ y decreciente en $[ \frac n 2 , n]$, pero como $\floor{\frac n 2}$ es el mayor número entero $\leq \frac n 2$, $f$ alcanza máximo en $[0, \frac n 2]$ cuando $x = \floor {\frac n 2}$, similarmente, $f$ alcanza máximo en $[\frac n 2, n]$ cuando $x = \ceil{\frac n 2}$. Como $f(\floor{\frac n 2}) = f (\ceil {\frac n 2})$, se sigue que $f$ se maximiza en $x = \floor {\frac n 2}$ y $x = \ceil {\frac n 2}$, es decir, el valor máximo de $f$ es $f (\floor{\frac n 2}) = \floor{\frac n 2} \ceil{\frac n 2}$.
\end{remark}


\begin{exercise}
Demuestre que si $G$ es un grafo con $n = 2k+1$ vértices, entonces $G$ contiene un camino de largo $k$, digamos $P_k$, o el complemento de $G$ tiene un triángulo.
\end{exercise}
\begin{solution}
Supongamos por el absurdo que ninguna de las dos situaciones pasa. Por un lado, si el complemento $\bar G$ de $G$ no contiene triángulos, el Teorema de Mantel nos dice que
\[
    e(\bar G) \leq \ex n {K_3} \leq k (k+1).
\]
Como $(2k + 1) k = \binom n 2 = e(G) + e(\bar G)$, deducimos que
\[
    k^2 \leq e(G).
\]

Por otro lado, si $G$ no contiene $P_k$-caminos, el Teorema de Erdös \& Gallai dice que
\[
    e(G) \leq \ex n {P_k} \leq \frac{(k-1)n}{2} = \frac{(k-1)(2k+1)}{2}.
\]

Juntando ambas desigualdades, llegamos al absurdo:
\[
    k^2 \overset{!!!}{\leq} \frac{(k-1)(2k+1)}{2}.
\]
Por lo tanto, $G$ contiene un $P_k$-camino o $\bar G$ un triángulo.
\end{solution}

\begin{exercise}
Demuestre que si $T$ es un árbol con $k$ vértices, entonces $T\subseteq G$ o el complemento de $G$ contiene un triángulo si $n := \abs G = 2k -1$.
\end{exercise}

\begin{solution}
Supongamos por el absurdo que $G$ es un grafo con $n = 2k-1$ vértices que no contiene a un árbol $T$ con $k$ vértices, y que $\bar G$, su complemento, no contiene triángulos. En particular, la primera suposición implica que $\delta (G) \leq k-2$ por el siguiente lema, cuya demostración vimos en clase:
\textit{
\begin{quote}
Sean $t \in \naturals$ y $T$ un árbol con $t+1$ vértices. Entonces si $G$ es un grafo con $\delta (G) \geq t$, luego contiene a $T$ como subgrafo.
\end{quote}
}
Mientras que la segunda suposición ($\bar G$ no tiene triángulos), implica que dado un vértice $w \in V(G)$, entonces para cada par de vértices $w', w''$ no adyacentes a $w$ se tiene que $w' w'' \in E(G)$. En otras palabras, para todo $w \in V(G)$, el subgrafo $G[A_w]$ inducido por el conjunto $A_w := V(G) \setminus \left\{N_G (w) \cup \{w\} \right\}$ es completo; notar que como $\abs {A_w} = n - (d_G (w) +1)$, este grafo es isomorfo a $K_{n - d_G (w) - 1}$.

Finalmente, para llegar al absurdo, consideremos $v \in V(G)$ un vértice con grado $d_G (v) = \delta (G) \leq k-2$, entonces $G[A_v]$ es un subgrafo de $G$ isomorfo a $K_{n - \delta(G) - 1}$, i.e. un completo con al menos
\[
    n - \delta (G) - 1 = (2k -1) - \delta (G) - 1 \geq (2k-1) - (k-2) - 1 = k
\]
vértices, luego contiene una copia de $T$, con lo cual $G$ también: absurdo. Consecuentemente, $G$ contiene una copia de $T$ o $\bar G$ tiene triángulo(s).
\end{solution}

\begin{solution}[Segunda solución]
Otra manera de resolver el ejercicio es haciendo inducción $k \geq 1$: supongamos que $G$ es un grafo de orden $2k-1$ con $\bar G$ libre de triángulos, probaremos que $T \subset G$ para cualquier árbol $T$ de orden $k$. El caso $k=1$ es trivial.

En general, supongamos que $k \geq 2$ y tomemos una hoja $h$ de $T$, consideremos $T' := T \setminus \{h\}$ y escribamos $p \in T'$ para el padre de $h$ en $T$. Ahora, si $G$ es completo ya ganamos, pues $K_{2k-1} \supset T$, con lo cual podemos suponer que existen $v,w \in V(G)$ tales que $vw \not \in G$, y consideremos $G' := G \setminus \{v,w\}$. Notar que $\bar{G}'$ es $K_3$-libre y $G'$ tiene orden $2(k-1) -1$, luego por hipótesis inductiva $G'$ contiene a $T'$. Por otro lado, $p \in T'$ tiene que ser vecino de $w$ o de $v$ en $G$, de lo contrario $\bar G$ tendría un triángulo! Esto prueba que $T \subset G$.
\end{solution}

\begin{exercise}
Pruebe que si $e(G)> n^2/4$, entonces $G$ contiene al menos $\lfloor n/2 \rfloor$ triángulos.
\end{exercise}
\begin{solution}
El Teorema de Füredi (2015) dice:
\textit{
\begin{quote}
Sean $n,t \in \naturals$, y $G$ con $n$ vértices. Si $G$ está $t$-lejos de ser bipartito, entonces hay al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos en $G$.
\end{quote}
}

Sea $H \subset G$ el subgrafo bipartito con cantidad de aristas $e(H)$ máxima de $G$. Como $e(H) \leq \frac {n^2}{2} < e(G)$, tenemos que $H \subsetneq G$; y podemos escribir $t := e(G) - e(H) \geq 1$. En particular, como $e(H)$ es máximo, tenemos que $G$ está $t$-lejos de ser bipartito. Con lo cual, el Teorema de Füredi implica que $G$ contiene al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos; en particular, si $e(G) - \frac{n^2}{4} + t \geq 3$ ganamos, pues en este caso habrían al menos $\frac{n}{2} \geq \floor{\frac n 2}$ triángulos. Por otro lado, esta cantidad es menor que $3$ si y solo si $t =1$ y $H = T_2 (n)$. En este caso, $H = K_{\floor{\frac n 2}, \ceil{\frac n 2}}$. Tomemos una aristas $f \in E(G) \setminus E(H)$, con lo cual $f$ tiene sus extremos en una de las dos particiones de $H$; en el peor de los casos está en la partición más grande, es decir, para todo vértice $v$ de la partición de $H$ con menor cantidad de vértices: $\floor{\frac n 2}$, se forma un triángulo distinto con vértices $v$ y los extremos de $f$. En particular, $G$ contiene en este caso al menos $\floor{\frac n 2}$ triángulos.
\end{solution}

\begin{exercise}
Sean $G$ y $H$ grafos. Demuestre que si $G$ tiene $n$ vértices y al menos $2 \cdot \ex n H$ aristas, entonces $G$ contiene al menos $\ex n H$ copias de $H$.
\end{exercise}
\begin{solution}
Supongamos que $G$ no contiene $e := \ex n H $ copias de $H$, luego quitando una arista por cada copia de $H$ en $G$ obtenemos un grafo $H$-libre con al menos $e(G) - (e-1) \geq 2 e - (e-1) = e + 1$ aristas. Sin embargo, por definición de $e$, se sigue que este grafo tiene a lo más $e$ aristas, absurdo. Esto prueba que $G$ tiene al menos $e$ copias de $H$.
\end{solution}

\begin{exercise}
Sea $k \in \mathbb{N}$ y $n\in \mathbb{N}$ suficientemente grande.
Demuestre que todo grafo $G$ con $n$ vértices y al menos $n^2/4$ aristas contiene un grafo $H$ con al menos $k$ vértices y $\delta(H)\geq \frac{\abs H}{2}$.
\end{exercise}
\begin{solution}
Probaremos un enunciado más fuerte:
\textit{
\begin{quote}
Sea $k \in \naturals$ y $n \in \naturals$ suficientemente grande. Entonces todo grafo $G$ con $n$ vértices y al menos $\frac{n^2}{4}$ aristas contiene a $H:= K_{k,k}$.
\end{quote}
}

Esto prueba el ejercicio pues el grafo $H := K_{k,k}$ tiene $2k \geq k$ vértices y $\delta (H) = k = \frac {v(H)}{2}$.

Ahora probemos este enunciado más fuerte. Para eso utilizaremos el Teorema de Kövani, Sós, y Turán (abreviado ``KST''):
\textit{
\begin{quote}
Sean $s, t \in \naturals$, $s \leq t$. Entonces existe una constante $c = c(s,t) > 0$ tal que
\[
    \ex n {K_{s,t}} \leq c \cdot n^{2 - \frac 1 s}, \quad \forall n \in \naturals;
\]
\end{quote}
}
lo aplicamos al caso $s = t = k$.

\bigskip

Así, el Teorema de KST dice que
\[
    \ex n H \leq c \cdot n^{2 - \frac 1 k}, \quad \forall n \in \naturals
\]
con $c > 0$ una constante que depende solo de $k$.
Tomando $n_0 \in \naturals$ para que $\frac{n^2}{4} > c n^{2 - \frac 1 k}$ valga para todo $n\geq n_0$, se sigue que $G$ siempre debe tener a $H$ como subgrafo: de lo contrarío se llegaría al absurdo:
\[
    \frac{n^2}{4} \leq e(G) \leq \ex n H \leq c n^{2 - \frac 1 k}.
\]
\end{solution}

\begin{solution}[Segunda solución]
Por el Lema \ref{lema:lema 2 - teorema de extremalidad de arboles}, $G$ contiene un subgrafo $H'$ tal que
\[
    \delta (H') > \varepsilon (H') \geq \varepsilon (G).
\]
Como $\varepsilon (G) = \frac{e(G)}{\abs G} \geq \frac{n}{4}$, se tiene que para $n$ lo suficientemente grande, $H'$ contiene a $K_{1, k}$, y por lo tanto $H := K_{1,k}$ sirve. En efecto,
\[
    \delta (H) = k \geq \frac{k+1}{2} = \frac{\abs H}{2}.
\]
\end{solution}







\section{Regularidad}

\begin{definition}
Dada una partición de los vértices de un grafo $G$, digamos $ V(G) = X \coprod Y$, definimos la \textbf{densidad} del par $(X,Y)$ como la cantidad
\[
    d(X,Y) := \frac{e(X,Y)}{\abs X \abs Y}.
\]
\end{definition}

\begin{definition}
Dado $\varepsilon > 0$. Sean $A,B \subset V(G)$ con $G$ un grafo. Diremos que el par $(A,B)$ es \textbf{$\varepsilon$-regular} si para todo $X  \subset A$, $Y \subset B$ con
\[
    \abs X \geq \varepsilon \abs A \quad \text e \quad \abs{Y} \geq \varepsilon \abs B
\]
tenemos
\[
    \abs{d (X,Y) - d(A,B)} \leq \varepsilon.
\]
\end{definition}

\begin{definition}
Sea $G$ un grafo. Una partición $V(G ) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$, se dice \textbf{equipartición}, si
\[
    \abs {V_0} \leq \abs{V_1} = \abs{V_2} = \cdots = \abs{V_k}.
\]
Al conjunto $V_0$ lo llamamos \textbf{conjunto excepcional}.
\end{definition}

\begin{definition}
Sea $G$ un grafo con $n$ vértices y $\varepsilon > 0$. Diremos que una partición $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ es \textbf{$\varepsilon$-regular}, si $\abs{V_0} \leq \varepsilon n$ y a lo más $\varepsilon k^2$ pares $(V_i,V_j)$ con $1 \leq i , j \leq k$ no son $\varepsilon$-regulares.
\end{definition}

\begin{theorem}[Lema de Regularidad de Szemerédi]\label{theorem:lema de regularidad de szemeredi}
Para todo $\varepsilon > 0$, $m \in \naturals$, existe $M = M (\varepsilon, m) \in \naturals$ tal que para cualquier grafo $G$ con $\abs G \geq M$, existe una \underline{equipartición} $\varepsilon$-regular
\[
    V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k
\]
con $m \leq k \leq M$.
\end{theorem}
\begin{proof}
\begin{definition}
Dado un grafo $G$ con $n$ vértices y partición de sus vértices $\mathcal P = \{ V_1, \ldots, V_k \}$, definimos la \textbf{media cuadrática} del par $(V_i,V_j)$ para cada $i\neq j$ como
\[
    d_2 (V_i , V_j) := \frac{e(V_i,V_j)^2}{\abs{V_i} \abs {V_j} n^2},
\]
y la \textbf{media cuadrática} de la partición $\mathcal P$ como
\[
    d_2 (\mathcal P) = \sum_{1 \leq i < j \leq k} d_2 (V_i, V_j) = \sum_{1 \leq i < j \leq k} \frac {\abs {V_i} \abs{ V_j}}{n^2} d(V_i, V_j)^2 \leq 1.
\]
\end{definition}

\begin{definition}
Una partición $\mathcal P'$ de $G$ se dice que \textbf{refina} a una partición $\mathcal P$ (o que es un \textbf{refinamiento} de $\mathcal P$) si cada parte de $\mathcal P$ es una unión de algunas partes de $\mathcal P'$.
\end{definition}

\begin{lemma}
Si $\mathcal P'$ es un refinamiento de $\mathcal P$, entonces
\[
d_2 (\mathcal P') \geq d_2 (\mathcal P).
\]
\end{lemma}

\begin{lemma}
Sea $G$ un grafo y $\mathcal P$ una partición de $V(G)$. Si $(X,Y)$ es un par no $\varepsilon$-regular en $\mathcal P$. Entonces, existen particiones $\{X_1, X_2\}$ de $X$ y particiones $\{Y_1, Y_2\}$ de $Y$ tales que
\[
\sum_{1 \leq r, s \leq 2} \frac{\abs{X_r} \abs{Y_s}}{n^2} \cdot d(X_r, Y_s)^2 \geq d(X,Y)^2 + \varepsilon^4.
\]
\end{lemma}

\begin{lemma}
Sea $G$ un grafo con $n$ vértices y $\mathcal P$ partición de $G$ que no es $\varepsilon$-regular. Entonces existe un refinamiento $\mathcal P'$ de $\mathcal P$ tal que:
\begin{enumerate}[(i)]
\item $d_2 (\mathcal P') \geq d_2 (\mathcal P) + \varepsilon^5$.
\item $\# \mathcal P ' \leq k \cdot 2^{k-1}$.
\end{enumerate}
\end{lemma}

Ahora, veamos la demostración del teorema. Sea $\mathcal P_0 = \{V_0, V_1, \ldots, V_m\}$ una partición de $G$ con $\underbrace{\abs {V_0}}_{1 \leq \abs{V_0} \leq m-1} = n - n \floor{\frac n m}$ y $\abs{V_i} = \floor{\frac{n}{m}}$ para todo $i = 1 , \ldots, m$. Si $\mathcal P_0$ no es $\varepsilon$-regular, existe $\mathcal P_1$ refinamiento de $\mathcal P_0$ tal que $d_2 (\mathcal P_1) \geq d_2 (\mathcal P_0) + \varepsilon^5$ y
\[
\abs{\mathcal P_1} \leq m \cdot 2^m.
\]

Ahora, obtenemos una equipartición de $\mathcal P_1'$ a partir de $\mathcal P_1$: particionando cada parte de $\mathcal P_1$ en conjuntos de tamaño
\[
\frac{\frac{\varepsilon^6}{2}n}{\# \mathcal P _1},
\]
y un conjunto despreciable de tamaño $< \frac{\frac{\varepsilon^6}{2}n}{\# \mathcal P _1}$. En total, el conjunto de los vértices despreciados lo agregamos al \textit{conjunto excepcional} $V_0$, es decir, agregamos $< \frac{\varepsilon^6}{2}n$ vértices. Afirmamos que $\mathcal P_1'$ está acotado por arriba por algo que depende de $\varepsilon$ y $m$:
\[
\# \mathcal P _ 1 ' \leq \frac{n}{\frac{\varepsilon^6 n}{2}}\big / \# \mathcal P_1 = \frac{2 \# \mathcal P _1}{\varepsilon^6} \leq \frac{m2^{m+1}}{\varepsilon^6}.
\]
Por el primer lema, $d_2 (\mathcal P_1 ') \geq d_2 (\mathcal P_1) \geq d_2 (\mathcal P_0) + \varepsilon^5$.

Si no obtenemos una partición $\varepsilon$-regular, entonces continuamos refinando, para así obtener una secuencia de equiparticiones:
\[
\mathcal P_0, \mathcal P _1 ' , \mathcal P_2 ' , \ldots, \mathcal P _k'.
\]
Como $d_(\mathcal Q) \leq 1$ para cualquier partición $\mathcal Q$ de $G$, y $d_2 (\mathcal P_{i+1}) \geq d_2 (\mathcal P_i') + \varepsilon^5$, tenemos que $k \leq \varepsilon^{-5}$.
Entonces, luego de a lo más $\varepsilon^{-5}$ iteraciones, habremos encontrado una partición $\varepsilon$-regular con una cantidad de partes acotada por $M$ que solamente depende de $m $ y $\varepsilon$. Por último, el conjunto excepcional de dicha partición es
\[
\leq (m-1) + \frac{\varepsilon^6 n}{2} \varepsilon^{-5} < \varepsilon n.
\]


\end{proof}

\begin{corollary}
Se puede probar el Teorema de Erdös-Stone \ref{th:teorema de Erdos-stone}:
\begin{quote}
Dado un grafo $H$, para todo $\delta >0$ existe $n_0 \in \naturals$ tal que si $G$ es un grafo con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r + \delta \right ) \frac{n^2}{2},
\]
entonces $H \subset G$, donde $r = \chi (H) - 1$.
\end{quote}
\end{corollary}

La idea de la demostración del corolario será la siguiente:

\bigskip

Tomemos $\delta > 0$ arbitrariamente pequeño, aplicamos el Lema de Regularidad de Szemeredi con $\varepsilon $ lo suficientemente pequeño y $m > \frac 1 \varepsilon$. Así existe $M \in \naturals$, y obtenemos una equipartición $\varepsilon$-regular
\[
 V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k,
\]
con $M \geq k \geq m > \frac 1 \varepsilon$, de cualquier grafo $G$ con $\abs G \geq M$.

Borramos de $G$ todas las aristas sobre las que ``no hay control'':
\begin{enumerate}[(a)]
\item Las que ven a $V_0$.
\item Aristas dentro de las partes $V_i$ con $i \geq 1$.
\item Las aristas entre pares no $\varepsilon$-regulares.
\item Aristas entre pares no densos, i.e., ``tenemos menos que $\delta / 2$ densidad''.
\end{enumerate}

Después, obtenemos el gafo reducido $R$: dado por contraer cada $V_i$ a un vértice $w_i$ con $i \geq 1$, y borrar aristas múltiples. Así, $R$ tiene conjunto de vértices $w_1, \ldots, w_r$ donde $w_{i}w_j \in E(R)$ sii $(V_i, V_j)$ es $\varepsilon$-regular y denso.

Aplicamos lemas de inmersión en ``aristas'' de grafo - grafo reducido:
\[
    \text{Si $H \subset R$} \quad \Rightarrow \quad H \subset G.
\]

\begin{lemma}\label{lema:regularidad de szemeredi - lema 1}
Sea $V_0 \coprod V_1 \coprod \cdots \coprod V_k$ una partición $\varepsilon$-regular de un grafo $G$ de $n$ vértices, con $k \geq \frac 1 \varepsilon$. Entonces, hay un máximo de:
\begin{enumerate}[(a)]
\item $\varepsilon n^2$ aristas con un extremo en $V_0$.
\item $\varepsilon n^2$ aristas dentro de una parte $V_i$ con $i\geq 1$.
\item $\varepsilon n^2$ aristas entre pares (con $i,j \neq 0$) que no son $\varepsilon$-regulares.
\item $\delta n^2$ aristas entre pares (con $i,j \neq 0$) de densidad $< \delta$.
\end{enumerate}
Más aún, hay un máximo de
\begin{enumerate}[(b')]
\item $\varepsilon n^2$ aristas dentro de $V_0$.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[(a)]
\item Como $\abs{V_0} \leq \varepsilon n$ entonces hay a lo más
\[
    \varepsilon n (1-\varepsilon) n + \binom{\varepsilon n}{2} < \varepsilon n^2 \text{ aristas en (a)}.
\]
\item Cada $V_i$ tiene $\leq \frac n k$ vértices (pues estamos en una equipartición), y entonces hay a lo más $k \cdot \binom{\frac n k}{2} \leq \frac \varepsilon 2 n^2$ aristas para (b).
\item Hay a lo más $\varepsilon k^2$ pares que no son $\varepsilon$-regulares y cada par tiene a lo más $\left ( \frac n k \right)  ^2$ aristas entre sí. Consecuentemente, aportan a lo más $\varepsilon k^2 \cdot \left ( \frac n k \right )^2 = \varepsilon n^2$ aristas en (c).
\item En el peor caso, los $\binom k 2$ pares son poco densos. En este caso, por definiciónde densidad:
\[
    e(V_i, V_j) \leq \delta \left ( \frac n k \right )^2, \quad \forall 1 \leq i, j \leq k,
\]
y entonces, hay a lo más $\delta \left ( \frac n k \right )^2 \binom k 2 \leq \delta n^2$ aristas en pares ``poco densos'', i.e., en (d).
\end{enumerate}
Por último,
\begin{enumerate}[(b')]
\item Como $\abs {V_0} \leq \varepsilon n$, hay a lo más $\abs{V_0}^2 \leq \varepsilon n^2$ aristas en $V_0$.
\end{enumerate}
\end{proof}

\begin{lemma}\label{lema:regularidad de szemeredi - lema 2}
Sea $\varepsilon > 0$, y sea $(A,B)$ un par $\varepsilon$-regular de un grafo $G$. Entonces,
\[
    \big ( d(A,B) - \varepsilon \big ) \abs B \leq \abs{N_G (v) \cap B} \leq \big ( d(A,B)
    + \varepsilon \big ) \abs B
\]
para todo $v \in A$, salvo a lo más $2 \varepsilon \abs A$.
\end{lemma}
\begin{proof}
Consideremos el conjunto $X \subset A$ de los vértices que no cumplen alguna de las dos desigualdades. Probaremos que $\abs X < 2 \varepsilon \abs A$ por el absurdo. Si este no fuera el caso, tendríamos que $\abs X \geq 2 \varepsilon \abs A$ y por lo tanto hay al menos $\varepsilon \abs A$ vértices que no cumplen la primera desigualdad o la segunda. Supongamos que estamos en el perimer caso, el segundo caso es análogo. Es decir, supongamos que existe un conjunto $X' \subset A$ con $\abs{X'} \geq \varepsilon \abs A$ tal que para todo $v \in X'$,
\[
    \big ( d(A,B) - \varepsilon \big) \abs B > \abs{N_G (v) \cap \abs B}.
\]
Sumando en la desigualdad anterior sobre todos los $v \in X'$, tenemos que
\[
    \big ( d(A,B) - \varepsilon \big ) \abs B \abs A > e(X', B),
\]
por lo tanto $\big ( d (A,B) - \varepsilon \big ) >d(X', B)$, i.e.,
\[
    \abs {d(A,B) - d(X', B)} > \varepsilon.
\]

Consideremos ahora $Y' = B$, en particular $\abs {Y'} \geq \varepsilon \abs B$ si $\varepsilon > 0$ es chico. Luego por $\varepsilon$-regularidad del par $(A,B)$, tenemos que
\[
    \abs{d(A,B) - d(X', B)} \leq \varepsilon,
\]
absurdo.
\end{proof}



\begin{lemma}[Slicing]\label{lema:regularidad de szemeredi - lema slicing}
Sea $\alpha \geq \varepsilon > 0$, y sea $(A,B)$ un par $\varepsilon$-regular en un grafo $G$. Para cualquier $X \subset A, Y \subset B$ con
\[
    \abs X \geq \alpha \abs A \quad \text y \quad \abs Y \geq \alpha \abs B
\]
se tiene que el par $(X,Y)$ es $\max\{\frac{\varepsilon}{\alpha}, 2 \epsilon\}$-regular. Además, por $\varepsilon$-regularidad del par $(A,B)$, se tiene que
\[
    \abs {d(X,Y) - d (A,B)} \leq \varepsilon.
\]

\end{lemma}
\begin{proof}
La última afirmación es clara. Veamos la primera, para eso consideremos $\varepsilon ' = \max \{ \frac{\varepsilon}{\alpha} , 2 \varepsilon \}$. Sean $Z \subset X$ y $W \subset Y$ tales que $\abs Z \geq \varepsilon ' \abs X$ y $\abs W \geq \varepsilon ' \abs Y$, entonces $\abs Z \geq \varepsilon \abs A$ y $\abs W \geq \varepsilon \abs B$. Luego por $\varepsilon$-regularidad del par (A,B), se tiene que
\[
    \abs{d(Z,W) - d(A,B)} \leq \varepsilon.
\]
Además, por $\varepsilon$-regularidad del par $(A,B)$, se tiene que
\[
    \abs{d(X,Y) - d(A,B)} \leq \varepsilon.
\]
Juntando ambas desigualdades tenemos que:
\begin{align*}
\abs{d(Z,W) - d(X,Y)} &\leq \abs{ d(Z, W) - d(A,B)} + \abs{d(X,Y) - d(A,B)} \\
    &\leq \varepsilon + \varepsilon \leq 2 \varepsilon \leq \varepsilon '.
\end{align*}
\end{proof}

\begin{definition}[Reducido]
Dado un grafo $H$, $n \in \naturals$, $\varepsilon, \delta > 0$, definimos
\[
    \mathcal G (H,n, \varepsilon, \delta)
\]
como la familia de grafos $G$, tales que existe una equipartición $V(G)  = A_1 \coprod \cdots \coprod A_l$ con $A_i$ de cardinal $n$ e independiente, y un etiquetamiento de los vértices $V(H) = \{w_1, \ldots, w_l\}$ tal que para cada $w_i w_j \in E(G)$, el par $(A_i, A_j)$ es un par $\varepsilon$-regular y además $d(A_i, A_j)\geq\delta$.
\end{definition}

\begin{lemma}[Lema de inmersión general]\label{lema:regularidad de szemeredi - lema inmersion general}
Para todo grafo $H$ y todo $\delta > 0$, existen $\varepsilon > 0$ y $n_0 \in \naturals$ tales que
\[
    G \in \mathcal G (H, n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{lemma}
\begin{proof}
Haremos inducción en $\abs H$. Cuando $\abs H = 1$ es trivial. Supongamos entonces que $\abs H \geq 2$. Escribamos $V(H) = \{w_1, \ldots, w_l\}$ y sea $V(G) = A_1 \coprod \cdots \coprod A_l$ una partición de acuerdo a la definición de $\mathcal G (H, n , \varepsilon , \delta)$: $(A_i, A_j)$ $\varepsilon$-regular y $d(A_i, A_j) \geq \delta$ para cada $i \leq l-1$ tal que $w_i w_l \in E(H)$.

Elijamos $\varepsilon $ lo suficientemente pequeño y apliquemos el Lema \ref{lema:regularidad de szemeredi - lema 2} a cada $(A_i, A_l)$ con $w_i w_l \in E(H)$: todos, excepto a lo más $2 \varepsilon \abs {A_l}$ vértices $v \in A_l$ satisfaciendo:
\[
    \abs{N_G (v) \cap A_i} \geq (\delta - \varepsilon) \cdot \abs{A_i}
\]
\Inkscape[1.5]{}{"./Figuras/Regularidad/Dibujo 1.pdf_tex"}
Como $2 \varepsilon \abs{A_l} (l-1) < n$, existe $v \in A_l$ tal que
\[
    \abs{N_G (v) \cap A_i} \geq (\delta - \varepsilon) \abs{A_i}, \quad \forall i \leq l-1
\]
con $w_i w_l \in E(H)$. Definimos
\[
    \tilde X_i = \begin{cases}
    A_i \cap N_G (v) & \text{ si $w_i \in N_H (w_l)$} \\
    A_i & \text{ si no},
    \end{cases}
\]
y por cada $\tilde X_i$ construimos un subgrafo $X_i$, de manera que todos los $X_i$ tengan el mismo cardinal.

Ahora, tomando $\alpha = \delta - \varepsilon \geq \varepsilon >0 $, podemos aplicar el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing} en $X_i, X_j$ cuando $w_i w_j \in E(H)$ para asegurar que son pares $\max\{\frac{\varepsilon}{\delta - \varepsilon}, 2 \varepsilon\}$-regulares y densidad al menos $\delta - \varepsilon$. Luego queremos usar la hipótesis inductiva: sea $H' := H \setminus \{w_l\}$ y $G':= G[\bigcup_{i = 1}^{l-1} X_i]$. Así, existen $\varepsilon ' > 0$ y $n'_0 \in \naturals$ tales que
\[
    G' \in \mathcal G (H', n', \varepsilon ', \delta - \varepsilon), n' \geq n_0 ' \quad \Rightarrow \quad H' \subset G'
\]
Con lo cual, si escogemos $\varepsilon$ tal que $\max \{\frac{2 \varepsilon}{\delta - \varepsilon}, 2 \varepsilon\} < \varepsilon '$ y $n_0$ lo suficientemente grande, de tal suerte que $(\delta - \varepsilon) n_0 \geq n'_0$, tenemos por hipótesis inductiva que $H' \subset G'$. Por lo tanto, $H \subset G$.
\end{proof}

\begin{lemma}[Lema de inmersión aplicable]\label{lema:regularidad de szemeredi - lema inmersion aplicable}
Sea $H$ un grafo y $\delta >0$. Defina $r = \chi (H)$. Entonces, existen $\varepsilon > 0$ y $n_0 \in \naturals$ tales que
\[
    G \in \mathcal G (K_r , n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{lemma}
\begin{proof}
El Lema \ref{lema:regularidad de szemeredi - lema inmersion general} garantiza que para todo $\delta ' > 0$ existen $\varepsilon ', n'_0$ tales que
\[
    G \in \mathcal G (K_r (t), n' , \varepsilon ' , \delta '), n' \geq n'_0 \quad \Rightarrow \quad K_r (t) \subset G,
\]
donde $t := \abs H$. Como $H \subset K_r (t)$, se tiene que en este caso $H \subset G$.

Concluimos gracias al siguiente ejercicio:
\begin{exercise}
\begin{enumerate}[(1)]
\item[]
\item Demostrar que para todo $\delta > 0$, $n' \in \naturals$ y $\varepsilon ' > 0$, existen $\varepsilon$ y $\delta'$ tales que
\[
    \mathcal G (K_r, n' t , \varepsilon, \delta) \subset \mathcal G (K_r (t), n', \varepsilon ', \delta ').
\]
\item Demostrar que para todo $\delta > 0$, $\varepsilon > 0$ y $n' \in \naturals$ es lo suficientemente grande, se tiene que si
\[
    G \in \mathcal G (K_r, n , \varepsilon, \delta) \quad \text{con } n't \leq n < (n'+1)t,
\]
entonces existe un subgrafo $G' \subset G$ tal que $G' \in \mathcal G (K_r, n't, 2\varepsilon, \delta - \varepsilon)$.
\end{enumerate}
\end{exercise}
\begin{solution}
\begin{enumerate}[(1)]
\item[]
\item Tomemos $n = n' t$. Fijemos un etiquetamiento $K_r = \{w_1, \ldots, w_r\}$ tal que $K_r (t) = \{w_i^j\}_{1 \leq i \leq r}^{1 \leq j \leq t}$ con $w_i^j w_{i'}^{j'} \in E(K_r (t))$ si y solo si $w_i w_{i'} \in E(K_r)$. Entonces si $G \in \mathcal G (K_r , n, \varepsilon, \delta)$, con equipartición $V(G) = \coprod_{i = 1}^r V_i$. Se sigue que podemos subdividir la partición: cada $V_i = \coprod_{j = 1}^t V_i^j$ en otra equipartición con partes de cardinal $n'$.

Ahora busquemos $\varepsilon$ y $\delta'$ tales que $G \in \mathcal G (K_r (t), n', \varepsilon ', \delta')$. Pero si $w_i^j w_{i'}^{j'} \in E(K_r (t))$, entonces $w_i w_{i'} \in E(K_r)$, y por lo tanto el par $(V_i, V_{i'})$ es $\varepsilon$ regular y como $\abs {V_i^j} = \frac{1}{t} \abs{V_i}$ para todo $1 \leq j \leq t$, el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing} garantiza que los pares $(V_i^j, V_{i'}^{j'})$ para $1 \leq j,j' \leq t$ son $\max \{t \varepsilon, 2 \varepsilon\}$-regularaes si $\varepsilon$ es lo suficientemente pequeño, i.e. $\frac 1 t > \varepsilon$. En cuanto a la densidad, nuevamente el Lema de Slicing garantiza que
\[
    d(A_i^j, A_{i'}^{j'}) \geq d(A_i, A_{i'}) - \varepsilon  \geq \delta - \varepsilon.
\]

Por lo tanto, tomamos $\varepsilon < \min \{\varepsilon '/2, \frac 1 t \varepsilon ', \frac 1 t, \delta / 2\}$ y $\delta' =  \delta /2$ y funciona.
\item Sea $G \in \mathcal G (K_r, n , \varepsilon, \delta)$. Luego $V(G) = V_1 \coprod \cdots \coprod V_k$ es una equipartición de $G$ con $\abs{V_i} = n$. Consiederemos cualquier subgrafo $G'$ de $G$ dado por quitar a cada conjunto $V_i$ los suficientes elementos tales que los vértices de $G'$ se equiparticionan en partes de tamaño $n't \geq \frac{n'}{n' + 1} n = (1 - \frac{1}{n'+1}) n = \left (1 - \frac{1}{\ceil {\frac{n}{t}}}\right ) n = \alpha n$, con $\alpha \geq \frac{1}{2}$ para $n'$ lo suficientemente grande ($t$ está fijo). Luego por el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing},
\[
    G' \in \mathcal G (K_r, n' t, 2 \varepsilon, \delta - \varepsilon).
\]
\end{enumerate}
\end{solution}

En efecto, para todo $\delta > 0$, el primer ítem dice que
\[
    \mathcal G (K_r, n' t, \varepsilon , \delta '),
\]
para algún $\varepsilon$ y todo $n' \geq n_0'$. Luego, por el segundo ítem, existe $n_0 \in \naturals$ lo sufientemente grande tal que si
\[
    G \in \mathcal G (K_r, n, \varepsilon, \delta),
\]
entonces existe un subgrafo $G' \subset G$ tal que $G' \in \mathcal G (K_r, n' t, 2 \varepsilon , \delta - \varepsilon)$. Juntando ambas cosas obtenemos que
\[
    G \in \mathcal G (K_r, n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{proof}

\begin{theorem}[Regularidad de Erdös-Stone]
Para todo grafo $H$ con $e(H) \geq 1$ y cada $\delta > 0$, existe $n_0 \in \naturals$ tales que para todo grafo $G$ con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac{1}{\chi (H)- 1} + 4 \delta\right ) \frac{n^2}{2},
\]
entonces $H \subset G$.
\end{theorem}

\begin{remark}
Como $\delta > 0$ es arbitrario, podríamos reemplazar $4\delta$ por $\delta ' > 0$ arbitrario en el enunciado.
\end{remark}

\begin{proof}
Tomamos $\varepsilon > 0$ lo suficientemente pequeño dado por el Lema de inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable}, y aplicamos Regularidad \ref{theorem:lema de regularidad de szemeredi} para el caso $m \geq \frac 1 \varepsilon$ al grafo $G$ con $r = \chi (H) -1$ satisfaciendo la hipótesis del enunciado. Obtenemos una partición $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ con $m \leq k \leq M$ una equipartición $\varepsilon$-regular. Sea $G'$ el grafo obtenido a partir de $G$ borrando todas ``las aristas sobre las que no hay control'' con parámetro $\varepsilon$ (regularidad) y $\delta$ (densidad). Así, tenemos que $G'$ tiene al menos $e(G) - (3 \varepsilon + \delta) n^2$ aristas por el Lema \ref{lema:regularidad de szemeredi - lema 1}. Sea $R$ el ``grafo reducido'', se tiene
\[
    G' \in \mathcal G (R, n', \varepsilon , \delta)
\]
con $n' := \frac{n - \abs{V_0}}{k}$. Por lo tanto, si $K_{r+1} \subset R$, entonces por el lema de inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable} tendríamos que $H \subset G'$. En efecto, quitando algunas particiones de $V(G')$, obtenemos un subgrafo $G'' \subset G'$ tal que $G'' \in \mathcal G (K_{r+1}, n', \varepsilon, \delta)$.

Supongamos ahora que $K_{r+1} \not \subset R$. Luego por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}:
\[
    e(R) \leq t_r (k) \sim  \left (1 - \frac 1 r \right ) \frac{k^2}{2} \quad (k \to \infty),
\]
es decir, achicando $\varepsilon$ de ser necesario para que $k$ sea grande y $t_r (k) \leq \left ( 1 - \frac 1 r + \delta \right ) \frac{k^2}{2}$. Se tiene que
\[
    e(G') \leq \left ( 1 - \frac 1 r + \delta \right ) \frac{k^2}{2} \cdot \frac{n^2}{k^2} = \left (1 - \frac 1 r + \delta \right ) \frac{n^2}{2}.
\]
Consecuentemente,
\begin{align*}
e(G) &\leq \left ( 1 - \frac 1 r + \delta \right )\frac{n^2}{2} + 2(3 \varepsilon +\delta)\frac{n^2}{2} \\
    &= \left ( 1 - \frac 1 r + 6 \varepsilon + 3\delta \right ) \frac{n^2}{2} \\
    &< \left ( 1 - \frac 1 r + 4 \delta \right ) \frac{n^2}{2},
\end{align*}
absurdo.
\end{proof}

Segunda aplicación del Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi}:

\begin{theorem}[Erdös-Simonovits]\label{Teorema de Estabilidad de Erdos-simonovits version H general - formulacion 2}

Para todo grafo $H$, y para todo $\delta > 0$, existe $n_0 \in \naturals$ tal que $G$ es un grafo $H$-libre con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 {\chi (H) - 1} - \delta \right) \frac{n^2}{2},
\]
entonces $G$ está $(5 \delta n^2)$-cerca de ser $(\chi (H)-1)$-partito.
\end{theorem}

\begin{remark}
Notar que este enunciado es equivalente al enunciado que vimos antes: \ref{Teorema de Estabilidad de Erdos-simonovits version H general}.
\end{remark}

\begin{proof}
Sea $\varepsilon > 0$ lo suficientemente pequeño (que depende de $H$ y $\delta$). Aplicamos el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} para $\varepsilon$ y $m \geq \frac 1 \varepsilon$; obtenemos la equipartición $\varepsilon$-regular $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ con $m \leq k \leq M$ para todo grafo con $\abs G \geq M$.

Luego consideramos el ``grafo reducido'' $R$ con parámetros $\varepsilon$ y $\delta$, y vértices $w_1, \ldots, w_k$. Sea $r = \chi (H) - 1$. Si $K_{r+1} \subset R$, entonces $H \subset G$ por el Lema de Inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable}, lo cual nos lleva a una contradicción. Es decir, $R$ es $K_{r+1}$-libre.

Elijamos $t = 3 \delta k^2$. Si $e(R) < t_r (k)-t$, entonces por el Lema \ref{lema:regularidad de szemeredi - lema 1}, tenemos:
\begin{align*}
e(G) &\leq (\delta + 3 \varepsilon)n^2 + e(R) \cdot \left (\frac n k\right)^2 \\
    &< (\delta + 3 \varepsilon)n^2 + \left ( (1 - \frac 1 r) \frac{k^2}{2} - 3 \delta k^2 \right ) \frac{n^2}{k^2} \\
    &= (1 - \frac 1 r) \frac{n^ 2}{2} + \underbrace{(3 \varepsilon - 2 \delta)}_{< - \frac \delta 2} n^2 \\
    &<(1-\frac 1 r) \frac{n^2}{2} - \frac{\delta}{2} n^2,
\end{align*}
contradicción.

Con lo cual, el Teorema de Estabilidad de Füredi \ref{theorem:teorema de estabilidad de furedi} nos permite suponer que $R$ está $t$-cerca de ser $r$-partito. Es decir, hay una $r$-partición
\[
    V(R) = A_1 \coprod \cdots \coprod A_r
\]
con a lo más $t$ aristas dentro de las partes. Utilizando nuevamente el Lema \ref{lema:regularidad de szemeredi - lema 1} para acotar las aristas despecriables de la partición de $G$, y acotando las aristas dentro de las partes de la partición de $R$, concluimos que es posible borrar a lo más
\[
    \underbrace{t \cdot \left ( \frac n k \right )^2}_{\leq 3 \delta n^2} + \underbrace{(\delta + 3 \varepsilon)n^2}_{\leq 2 \delta n^2} \leq 5 \delta n^2
\]
aristas para obtener una $r$-partición de $G$.
\end{proof}


\bigskip

\begin{lemma}[Lema de conteo general]\label{lema:lema de conteo general - corolario del lema de regularidad de szemeredi}

Para todo grafo $H$, y todo $\delta > 0$, existen $\varepsilon > 0$ y $M \in \naturals$ tales que si
\[
    G \in \mathcal G (H, n, \varepsilon, \delta)
\]
para algún $n \geq M$, entonces $G$ contiene al menos
\[
    \frac{\delta^{e(H)} \cdot n^{\abs H}}{2}
\]
copias de $H$.
\end{lemma}
\begin{proof}
Haremos inducción en $\abs H$, y de hecho nuestra hipótesis inductiva será más fuerte:
\begin{quote}
Para todo grafo $H$, y todo $\delta > 0$, existen $\varepsilon > 0$ y $M \in \naturals$, tales que si
\[
    G \in \mathcal G (H, n , \varepsilon , \delta)
\]
para algún $n \geq M$, y más aún, dada una equipartición $G = V_1 \coprod \cdots \coprod V_l$ indexada según $H = \{w_1, \ldots, w_l\}$ con $(V_i, V_j)$ $\varepsilon$-regular y $d(v_i, V_j) \geq \delta$ siempre y cuando que $w_i w_j \in E(H)$, se tiene que hay al menos
\[
    \frac{\delta^{e(H)} \cdot n^{\abs H}}{2}
\]
copias de $H$, de tal forma que los vértices $x_j$ correspondientes a un $w_j$ vía un isomorfismo con $H$ pertenezcan a $V_j$ para todo $j = 1, \ldots, l$.
\end{quote}
Si $\abs H = 1$, la afirmación es inmediata. Si $\abs H = 2$ y no tiene aristas también es fácil. Si $\abs H = 2$ y $e(H) = 1$, luego basta probar que existen al menos $\delta \frac{n^2}{2}$ aristas en $E(V_0, V_1)$. Pero tomando $\varepsilon < \min \{\delta / 4, 1/8\}$, la $\varepsilon$-regularidad del par $(V_0,V_1)$ junto con $d(V_0,V_1)$ implican que existen vértices $v \in V_1$ tales que
\[
    (\delta - \varepsilon)n \leq \abs{N_G (v) \cap V_0}
\]
salvo $2 \varepsilon n$ vértices por el Lema \ref{lema:regularidad de szemeredi - lema 2}. Es decir, $E(V_0, V_1)$ tiene al menos
\[
    (\delta - \varepsilon)(1-2\varepsilon)n^2 \geq (\frac 3 4 \cdot \frac 3 4) \delta n^2 \geq \frac 1 2 \delta n^2
\]
aristas, como queríamos.

En general, supongamos que $\abs H \geq 3$. Si $G \in \mathcal G (H, n , \varepsilon , \delta)$ para $n \geq M$, entonces $G = V_1 \coprod \cdots \coprod V_l$ con $V_i$ todos de cardinal $n$ y para la escritura $H = \{w_1, \ldots, w_l\}$, $w_i w_j \in E(H)$ si y solo si $(V_i, V_j)$ es $\varepsilon$-regular y $d(V_i, V_j) \geq \delta$.

Consideremos $H' = H \setminus \{w_l\}$ y $G' := G \setminus V_l$, entonces $G' \in \mathcal G (H' , n , \varepsilon, \delta)$ y por hipótesis inductiva existe $M'$ tal que si $n \geq M'$, entonces $G'$ contiene al menos
\[
    \frac{\delta^{e(H')} \cdot n^{\abs {H'}}}{2}
\]
copias de $H'$, donde cada copia tiene su vértice correspondiente a $w_j$ en la parte $V_j$ para cada $j < l$. Ahora, por el Lema \ref{lema:regularidad de szemeredi - lema 2}, para todo $v \in V_l$, salvo $2 \varepsilon n$ vértices, se tiene que
\[
    (\delta - \varepsilon)n \leq \abs {N_G (v) \cap V_j}, \quad \forall j < l.
\]
Por lo tanto, tenemos al menos $(1-2 \varepsilon (l-1))n$ vértices en $V_l$, cada uno con al menos $(\delta - \varepsilon)n$ vecinos en cada $V_j$ con $j <l$, y por lo tanto, $(\delta - \varepsilon)n(l-1)$ vecinos en $G$.

En el peor de los casos, todos los vértices que no son vecinos de $v$ en $V_j$ pertenecen a una de estas copias de $H'$ para cada $j < l$, luego este $v$ forma al menos $\frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1)$ copias de $H$ en $G$. Es decir, $G$ tiene al menos
\[
\left ( \frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1) \right )(1 - 2 \varepsilon(l-1))n
\]
copias de $H$, donde cada copia tiene su vértice correspondiente a $w_j$ en la parte $V_j$ para cada $1 \leq j \leq l$. Así, basta probar que tomando $M \gg M'$ y $\varepsilon > 0$ lo suficientemente chico, esta cantidad es $\geq \frac{\delta^{e(H)} \cdot n^{l}}{2}$.

En efecto, esto equivale a que
\[
    \left ( \frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1) \right )(1 - 2 \varepsilon(l-1)) \geq \frac{\delta^{e(H)} \cdot n^{l-1}}{2}
\]
si y solo si,
\[
\frac{\delta^{e(H')} \cdot n^{l-1}(1 - 2 \varepsilon (l-1))}{2} - \frac{\delta^{e(H)}\cdot n^{l-1}}{2} \geq (1- (\delta - \varepsilon))(l-1)(1-2\varepsilon (l-1))n.
\]
Es decir, hay que probar
\[
    \left ( \delta^{e(H')}(1- 2 \varepsilon (l-1)) - \delta^{e(H)} \right )\frac{n^{l-2}}{2} \geq (1- (\delta - \varepsilon))(l-1)(1-2\varepsilon (l-1)).
\]
Pero como $l \geq 3$, se sigue que si $\varepsilon>0$ es lo suficientemente chico (por ejemplo $\varepsilon < \frac{1 - \delta^{e(H)- e(H')}}{2(l-1)}$), existe $M$ con $M \geq M'$ lo suficientemente grande, tal que si $n \geq M$, el lado izquierdo ess más grande que el lado derecho (que no depende de $n$) pues
\[
    \left ( \delta^{e(H')}(1- 2 \varepsilon (l-1)) - \delta^{e(H)} \right ) > 0.
\]
\end{proof}

Apliación $3$ del Lema de Regularidad de Szemeredi \ref{theorem:lema de regularidad de szemeredi}:

\begin{theorem}[Teorema de Roth]\label{th:teorema de Roth}
Para todo $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $n \geq n_0$ y $A \subset \{1 , \ldots, n\}$ con $\abs A > \varepsilon n$, entonces $A$ contiene una \textit{$3$-progresión aritmética}\footnote{En general, una \textbf{$k$-progresión aritmética} es una secuencia de enteros $a, a+d, a + 2d , \ldots, a + (k-1)d$.}.
\end{theorem}

\begin{lemma}[Lema de remoción de triángulos]\label{lema:lema de remocion de triangulos}

Para todo $\alpha > 0$, existe $\beta > 0$ tal que todo grafo $G$ con $n$ vértices y a lo más $\beta n^3$ triángulos, puede ser $K_3$-libre borrando a lo más $\alpha n^2$ aristas
\end{lemma}
\begin{proof}
Tomemos $0 < \delta < \frac{ \alpha}{3}$ y $\varepsilon < \frac{\delta}{9}$ lo suficientemente chico. Aplicamos el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} con parámetros $\varepsilon$ y $m \geq \frac 1 \varepsilon$, obteniendo una partición de un grafo $G$ con $\abs G \geq M \geq k \geq m$,
\[
    V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k.
\]
Consideremos el grafo reducido $R$ con parámetros $\varepsilon$ y $\delta$. Notar que el subgrafo $G' := G \setminus V_0 \subset G$ cumple que $G' \in \mathcal G (R, n', \varepsilon, \delta)$ con $n' \geq \frac{(1- \varepsilon)n}{k} \geq \frac{1-\varepsilon}{M}n$.

Supongamos que $R$ tiene al menos un triángulo $K_3$. Entonces $G'$ tiene un subgrafo $G''$ dado por quedarnos solamente con las partes $V_i, V_j, V_k$ correspondientes a vértices $w_i,w_j,w_k$ que forman un triángulo en $R$; en particular, $G'' \in \mathcal G (K_3, n', \varepsilon, \delta)$. Aplicando el Lema de conteo general \ref{lema:lema de conteo general - corolario del lema de regularidad de szemeredi} para $H = K_3$ y el subgrafo $G'' \in \mathcal G (H, n' , \varepsilon, \delta)$, tenemos que $G''$, y por lo tanto $G$, tiene al menos:
\[
    \delta^3 \cdot \left ( \frac{(1 - \varepsilon)n}{k} \right )^3 > \frac{\delta^3}{2} \frac{(1- \varepsilon)^3}{M^3} \cdot n^3 > \beta n^3
\]
triángulos para $n$ lo suficientemente grande, donde $\beta < \frac{\delta^3}{2} \frac{(1- \varepsilon)^3}{M^3}$. Achicando $\beta$ de ser necesario, podemos asumir que $n$ es arbitrario.

Con lo cual, si $G$ tiene a lo más $\beta n^3$ triángulos, el párrafo anterior nos dice que $R$ no tiene triángulos. Así, al remover $\leq (\delta + 3 \varepsilon)n^2 < \alpha n^2$ aristas de $G$ (ver Lema \ref{lema:regularidad de szemeredi - lema 1}), nos quedamos sin triángulos.
\end{proof}

\begin{theorem}[Teorema de Roth]\label{theorem:teorema de Roth}
Para todo $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $n \geq n_0$ y $A \subset \{1, \ldots, n\}$ con $\abs A > \varepsilon n$, entonces $A$ contiene una $3$-progresión aritmética.
\end{theorem}
\begin{proof}
Vamos a probar que si $A$ no contiene una $3$-progresión aritmética, entonces $\abs A = o (n)$.

Sea $\varepsilon > 0$, y $n$ lo suficientemente grande, supongamos que $\abs A \geq \varepsilon n$ y que no contiene $3$-progresiones aritméticas. Definimos un grafo $G$ con $V(G) = X \coprod Y \coprod Z$, disjuntos y $\abs X = \abs Y = \abs Z = 3n$ cada conjunto $X,Y,Z$ es una copia de $\{1, \ldots, 3n\}$.
\begin{align*}
E(X,Y) &= \set{xy | x\in X, y \in Y, y = x + a \text{ para algún $a \in A$}}. \\
E(Y,Z) &= \set{yz | y\in Y, z \in Z, z = y + a \text{ para algún $a \in A$}}. \\
E(X,Z) &= \set{xz | x\in X, z \in Z, z = x + 2a \text{ para algún $a \in A$}}.
\end{align*}

Si $xyz$ es un triángulo en $G$, entonces existen $a,a',a'' \in A$ tales que
\[
\left \{
  \begin{array}{ll}
  y = x+ a, &a \in A \\
  z = y + a', &a' \in A \\
  z = x + 2a'', &a'' \in A,
  \end{array}
  \right .
\]
y esto es una $3$-progresión aritmética $a, a'' = a +(a'-a''), a' = a + 2 (a'-a'')$ si $a,a', a''$ son distintos. Como $A$ no tiene $3$-progresiones aritméticas, entonces cada triángulo en $G$ es de la forma $xyz$ con $y = x+a$, $z = x + 2 a$. Lo cual implica que cada triángulo queda completamente determinado por $x$ y $a$. Consecuentemente $G$ tiene a lo más
\[
    3n \abs A \leq 3n^2 = o (n^3)
\]
triángulos.

Por el Lema de Remoción de Triángulos \ref{lema:lema de remocion de triangulos}, es posible borrar $o(n^2)$ aristas de $G$ para obtener un grafo libre de triángulos. Ahora, vamos a obtener una cota por abajo de la cantidad de triángulos arista disjunto que tiene $G$: consideremos el conjunto de tripletas de la forma $(x,x+a,x+2a)$, con $x\in X, a \in A$. Observar que cada tripleta corresponde con un triángulo de $G$ y todos son arista-disjuntos entre sí, por lo tanto $G$ contiene al menos $3n \abs A> 3 \varepsilon n^2$ triángulos disjuntos y por lo tanto si o si deben ser quitados para que $G$ sea libre de triángulos. Contradiciendo el Lema de Remoción de Triángulos.
\end{proof}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Teoría de Ramsey}

\begin{notation}
Cuando nos refiramos a una \textbf{$r$-coloración} de un grafo $G$, será una función $c : E(G) \to \{1, \ldots, r\}$ que a cada arista $e \in E(G)$, le asigna un \textbf{color} $c(e)$ (No necesariamente la coloración es \textit{propia}, es decir, pueden existir aristas adyacentes con el mismo color).
\end{notation}

\begin{notation}
Sea $G$ un grafo con una coloración $c$. Entonces dado un vértice $v \in V(G)$, podemos considerar los vecinos $w$ de $v$ tales que $c(vw) = i$. Notaremos a este subconjunto de vecinos de $v$ como $N^{i}_G (v)$, o simplemente $N^i (v)$ cuando el contexto sea claro.
\end{notation}


La teoría de Ramsey se motiva mediante el siguiente ejemplo:
\begin{example}\label{ejemplo:2-coloracion de K_6}
Toda $2$-coloración de $K_6$ genera un triángulo monocromático.
\end{example}
\begin{proof}
Sea $v \in V(K_6)$. Hay al menos $3$ aristas incidentes a $v$ que tienen el mismo color, digamos rojo, por el principio del palomar. Si en $N^{\text{rojo}} (v)$ hay aristas rojas, entonces hay un triángulo rojo. Si no, todas las aristas entre vértices de $N^{\text{rojo}} (v)$ son azules. Como, $\abs{N^{\text{rojo}}(v)} \geq 3$, entonces hay un triángulo azul en $K_6[N^{\text{rojo}}(v)]$, y por lo tanto había un triángulo azul en $K_6$.
\end{proof}

\begin{theorem}[Teorema de Ramsey (1930)]
Para todo $k, r \in \naturals$, existe un $n \in \naturals$ tal que toda $r$-coloración de $K_n$ genera un $K_k$ monocromático.
\end{theorem}
\begin{proof}
Sea $v_1 \in V(K_n)$. Existe algún color $c_1 \in \{1, \ldots, r\}$ tal que las aristas incidentes a $v_1$ de color $c_1$ son al menos
\[
    \frac{n-1}{r},
\]
escribamos $A_1 := N^{c_1}_{K_n} (v_1)$. Similarmente, sea $v_2 \in K_n [A_1]$, existe un color $c_2 \in \{1, \ldots,r \}$ tal que las aristas incidentes a $v_2$ en $K_n [A_1]$ son de color $c_2$ y por lo menos hay
\[
    \frac{\abs{A_1}-1}{r},
\]
escribamos $A_2 := N^{c_2}_{K_n[A_1]} (v_2)$.
Continuando este procedimiento, para $n$ lo suficientemente grande, obtenemos una secuencia
\[
    v_1, c_1, v_2, c_2, v_3, c_3, \ldots, v_t,c_t,
\]
en donde si $t \geq r k$, se sigue que existe un color que se repite al menos $k$ veces en esta secuencia, y por lo tanto, sus vértices $v_{i_1}, \ldots, v_{i_k}$ correspondientes forman un $K_k$ monocromático de se color.
\end{proof}

\begin{exercise}
Calcular una cota inferior para $n$.
\end{exercise}
\begin{solution}
Escribamo $a_1, a_2, \ldots$ para la secuencia de cardinales de los conjuntos $A_1, A_2, \ldots$. Inspeccionando la demostración anterior, vemos que $a_1 \geq \frac{n-1}{r}$ y que recursivamente $a_{t+1} \geq \frac{a_t - 1}{r}$, $t \geq 1$. Por lo tanto, tenemos que inductivamente:
\[
    a_{t+1} \geq \frac{n}{r^{t+1}} - \sum_{i = 1}^{t+1} \frac{1}{r^i} = \frac{n}{r^{t+1}}  - \frac{1}{r} \frac{1 - r^{t+1}}{1 - r}, \quad t \geq 0.
\]
Con lo cual, si $t \geq r k$ como en la demostración de arriba, se sigue que
\[
    a_{rk} \geq  \frac{n}{r^{rk}} - \frac{1}{r} \frac{1 - r^{rk}}{1 -r}.
\]
Como queremos que $\alpha_{rk-1} \geq 1$ para que se repitan $k$ colores en la secuencia de la demosstración, basata tomar
\[
    \boxed{n \geq \frac{r^{2(rk-1)}}{r-1}.}
\]
\end{solution}

\section{Números de Ramsey}

\begin{definition}
El número de Ramsey $R(k)$, es el mínimo $n$ tal que cualquier $2$-coloración de $K_n$ contiene una copia monocromática de $K_k$.
\end{definition}


\begin{example}
En el Ejemplo \ref{ejemplo:2-coloracion de K_6} vimos que $R(3) \leq 6$. Pero de hecho, es fácil encontrar una $2$-coloración de $K_5$ que no contiene triángulos monocromáticos, y por lo tanto, $R(3) = 6$:

\Inkscape{$2$-coloración de $K_5$ libre de triángulos monocromáticos.}{"./Figuras/Teoria de Ramsey/Figura 1.pdf_tex"}
\end{example}


\begin{definition}
Sean $G$, $H_1$ y $H_2$ grafos, escribimos $G \to (H_1, H_2)$ si toda $2$-coloración de $G$ con rojo-azul de E(G) contiene una copia de $H_1$ rojo o una copia de $H_2$ azul.

Para $s,t \in \naturals$ definimos
\[
    R(s,t) := \min \{n \in \naturals | K_n \to (K_s,K_t)\}.
\]
(En particular, $R(k) = R(k,k)$).
\end{definition}


\begin{theorem}[Erdös-Szekeres (1935)]
Para todo $k \geq 1$, se tiene que
\[
    R(k) \leq \binom{2k-2}{k-1} \leq \frac{4^{k-1}}{\sqrt {\pi (k-1)}}.
\]
\end{theorem}
\begin{proof}
La segunda desigualdad se deduce de una aplicación inmediata de las desigualdades probadas en \cite{herbertRobbins1955}. Concentrémonos en la primera desigualdad, y de hecho, probaremos una versión un poco más general:

\[
    R(s,t) \leq \binom{s + t - 2}{s-1}.
\]
Notar que tomando $s = t = k$ se prueba la primera desigualdad del teorema.

Para eso, necesitamos un lema previo:
\begin{lemma}
Para todo $s,t \geq 2$, se tiene
\[
    R(s,t) \leq R(s-1, t) + R(s,t-1).
\]
\end{lemma}
\begin{proof}
En efecto, sea $c$ una coloración de $E(K_n)$ con $n = R(s-1,t) + R(s,t-1)$. Queremos probar que hay una copia roja de $K_s$ o una copia azul de $K_t$. Sea $v \in K_n$, entones hay dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] Existen al menos $R(s-1,t)$ aristas rojas incidentes a $v$, o
\item[\textbf{Caso 2:}] Existen al menos $R(s,t-1)$ aristas azules incidentes a $v$.
\end{enumerate}
En cualquier caso extendemos completos monocromáticos en el vecindario de $v$ a un $K_s$ rojo o un $K_t$ azul, respectivamente.
\end{proof}

Ahora, probemos la desigualdad por inducción en $s+t$, el caso base es $R (1,t) = R(s,1) = 1$. En general, si $\min \{s,t\} \geq 2$, tenemos que por el lema de arriba
\begin{align*}
    R(s,t) &\leq R(s-1,t) + R(s,t-1) \\
        &\leq  \binom{s + t -3}{s-2} + \binom{s+t-3}{s-1} = \binom { s+ t -2 }{s-1}.
\end{align*}

\end{proof}

\begin{obs}\label{obs:cota inferior trivial del numero de ramsey (orden lineal)}
Existe una cota inferior muy mala, para valores de $k$ grandes, del número de Ramsey:
\[
    R(k) \geq 2 (k-1), \quad k \geq 2.
\]
\end{obs}
\begin{proof}
Supongamos $k > 3$, pues el caso $k = 2$ es trivial.

En efecto, sea $n = 2 (k-1)$, entonces particionando los vértices de $K_n$ en dos conjuntos $A_1, A_2$ de tamaño $k-1$, y pintando las aristas de $K_n[A_1]$ y $K_n[A_2]$ de azul, pero las aristas entre $A_1$ y $A_2$ de rojo, obtenemos una coloración libre de $K_k$ monocromáticos. En efecto, si existiera un $K_k$ monocromático, entonces no puede ser azul porque cada $A_i$ tiene $k-1$ vértices; por otro lado no puede ser rojo porque en una partición hay almenos un vértice y en otra almenos $2$ (estamos en el caso $k > 3$), digamos en $A_1$ y $A_2$ respectivamente, entonces en $K_n [A_2]$ debería haber una arista color rojo, absurdo.
\end{proof}
El siguiente teorema confirma que la cota anterior es \textit{muy poco óptima}.

\begin{theorem}[Erdös (1947)]
\[
    R(k)  \geq 2^{k/2}, \quad \forall k \geq 2.
\]
\end{theorem}
\begin{proof}
Consideremos $K_n$ con $n = \ceil{2^{k/2}}$ y supongamos que $k \geq 6$, notar que los casos $k = 2 , \ldots, 5$ valen por la cota de la Observación anterior \ref{obs:cota inferior trivial del numero de ramsey (orden lineal)} (que es mejor para $k$ chico).

Tenemos exactamente
\[
    2^{\binom n 2}
\]
2-coloraciónes de $E(K_n)$. Vamos a mostrar que la cantidad de $2$-coloraciones de $E(K_n)$ que contienen a $K_k$ monocromático es $< 2^{\binom n 2}$. Para eso, notar que en este caso tenemos $\binom n k$ formas de elegir una copia de $K_k$ y luego $2^{\binom n 2 - \binom k 2}$ formas de colorear el resto de las aristas. Por lo tanto, la cantidad de $2$-coloraciones que contienen un $K_k$ monocromático es menor o igual que
\begin{align*}
\binom n k 2^{\binom n 2 - \binom k 2} &\leq \left (\frac{en}{k} \right )^{k} 2^{\binom n 2 - \binom k 2} \\
&\leq \left ( \frac{e (2^{k/2} + 1)}{k} \right )^k 2^{-\frac{k(k-1)}{2}} \cdot 2^ {\binom n 2},
\end{align*}
pero notar que si $k \geq 6$, entonces
\[
    \left ( \frac{e (2^{k/2} + 1)}{k} \right )^k 2^{\frac{k(k-1)}{2}}  \leq \left ( \frac{2^{k/2} + 1}{2} \right )^k 2^{- \frac{k(k-1)}{2}} < 1,
\]
de donde se sigue lo que queríamos. En efecto, se puede realizar un estudio cualitativo de la función para $k \in \reals_{\geq 6}$ utilizando cálculo elemental.
\end{proof}





\begin{definition}
En general, el \textbf{número de Ramsey con $r$ colores} $R_r (k)$ es el mínimo $n$ tal que todo $r$-coloreo de $K_n$ tiene un $K_k$ monocromático.
\end{definition}

\begin{theorem}
Para todo $r \geq 2$, se tiene que
\[
    2^r \leq R_r (3) \leq 3 \cdot r!.
\]
\end{theorem}
\begin{proof}
Primero veamos la cota inferior, para eso consideremos $n:= 2^r$ y encontraremos una $r$-coloración de $K_n$ sin triángulos monocromáticos. Haremos inducción en $r$, si $r = 2$ vale, pues podemos considerar la siguiente coloración:
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 6.pdf_tex"}
Para el paso inductivo, consideremos una partición en dos partes de $2^{r-1}$ vértices, donde el conjunto $A$ y el $B$ tienen $(r-1)$-coloraciones sin triángulos monocromáticos, por hipótesis inductiva, y luego pintamos las aristas entre $A$ y $B$ de color $r$ que nunca fue utilizado.
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 7.pdf_tex"}

Ahora veamos la cota superior. En el Ejemplo \ref{ejemplo:2-coloracion de K_6} vimos que $R_2(3) \leq 6 = 3 \cdot 2 !$, así vale el caso $r = 2$. Supongamos ahora que $r \geq 3$, y que $n = 3 \cdot r!$, sea $v_0 \in K_n$ fijo, y $c$ una $r$-coloración de $K_n$. Entonces existe un color $i \in  \{1, \ldots, r\}$ tal que
\[
    E_i^0 = \abs{\set{uv_0 \in E(K_n) | c (uv) = i}} \geq \frac{3 \cdot r !}{r} = 3 \cdot (r-1)!
\]
y sea $A := N_{K_n}^i (v_0)$. Pueden ocurrir dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] El color $i$ aparece en una arista de $K_n [A]$, luego tenemos un triángulo de color $i$.
\item[\textbf{Caso 2:}] En $K_n [A]$ no aparece el color $i$, entonces la coloración $c$ inducida en $K_n [A]$ es una $(r-1)$-coloración, con lo cual por hipótesis inductiva existe un triángulo monocromático en $K_n [A]$, en particular en $K_n$.
\end{enumerate}

\Inkscape{Ilustración del Caso 1.}{"./Figuras/Teoria de Ramsey/Figura 2.pdf_tex"}
\end{proof}


\begin{definition}
El \textbf{número de Ramsey de $H_1$ versus $H_2$} está definido por:
\[
    r(H_1, H_2) = \min \{ n | K_n \to (H_1, H_2)\}.
\]

En particular, escribimos $r (H):= r (H,H)$.
\end{definition}


\begin{theorem}
\[
    r(K_3, P_k) = 2k +1.
\]
\end{theorem}
\begin{proof}
Primero acotaremos por abajo: sea $n = 2k$, consideramos la siguiente coloración de $K_n$:
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 3.pdf_tex"}
Particionamos $K_n$ en dos partes de $k$ vértices cada uno y pintamos las aristas de color azúl, y las aristas entre ambas particiones las pintamos de rojo. Claramente no hay caminos de longitud $k$ de color azul porque las particiones tienen $k$ vértices y no hay triángulos rojos porque las aristas rojas inducen un grafo bipartito.

Para la cota superior, consideremos $K_n$ con $n = 2k + 1$. Sea $P$ un camino maximal de color azul; supongamos que $\abs{V (P)} \leq k$ y entonces $B := V(K_n) \setminus V(P)$ tiene al menos $k+1$ vértices. Sea $v_0$ un extremo de $P$, por maximalidad $v_0$ está conectado a cada vértice de $B$ por aristas rojas. Tenemos dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] Si en $K_n [B]$ hay aristas rojas entonces hay un triángulo de color rojo (con un vértice $v_0$).
\item[\textbf{Caso 2:}] Si en $K_n [B]$ no hay aristas rojas, entonces todas las aristas son azules y por lo tanto hay una copia de $K_{k+1}$ azul, y por lo tanto contiene a $P_k$ de color azul.
\end{enumerate}
\end{proof}

\begin{theorem}
Sea $T_k$ un árbol con $k$ aristas (i.e., $k+1$ vértices). Entonces
\[
    r(K_3, T_k) = 2k +1.
\]
\end{theorem}
\begin{proof}
Para la primera desigualdad se puede aplicar un razonamieneto similar a la demostración del teorema anterior. Veamos entonces solo la cota superior.

Sea $n = 2k + 1$ y consideremos $K_n$ con una coloración. Supongamos entonces que existe un vértice $v$ de grado rojo al menos $k+1$. Entonces la vecindad $N^{\text{rojo}} (v)$ induce un $K_{k+1}$ que si tiene alguna arista roja entonces existe un triángulo rojo en $K_n$, y si no, $K_n$ contiene un $K_{k+1}$ con aristas azules y en particular contiene un $T_k$ azul.

\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 4.pdf_tex"}

Ahora, supongamos que todo vértice tiene grado rojo $\leq k$. Esto implica que el grado mínimo del subgrafo azul inducido es $\geq k$, y por lo tanto el Lema \ref{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices} nos permite encontrar una copia de $T_k$ en el subgrafo azul inducido, en particular $K_n$ tiene una copia azul de $T_k$.
\end{proof}

\begin{theorem}[Chvátal (1977)]
Sea $T_k$ un árbol con $k$ aristas, y sea $s \geq 2$. Entonces
\[
    r(K_{s+1}, T_k) = s \cdot k  + 1.
\]
\end{theorem}
\begin{proof}
Primero veamos la cota inferior: sea $n = s\cdot k$, consideremos la siguiente coloración de $K_n$: el grafo azul consiste de $s$ copias de $K_k$ y las aristas rojas son las aristas entre los vértices de las copias de $K_k$.

\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 5.pdf_tex"}

Para la cota superior, haremos inducción en $s \geq 2$. Si $s = 2$, tenemos que $r (K_3, T_k) \leq 2 k + 1$ por el teorema anterior. Supongamos ahora que $s \geq 3$. Sea $n = s\cdot k + 1$. Sea $v$ un vértice con grado rojo $\geq (s-1)k + 1$, y sea $A$ la vecindad roja de $v$. Por hipótesis inductiba en $K_n[A]$, hay una copia de $K_s$ rojo, o una copia de $T_k$ azul y ganamos. Así, podemos asumir que el grado rojo de cada vértice es $\leq (s-1)k$. Esto implica que el grafo azul tendrá grado mínimo $\geq (s \cdot k +1 ) - 1 - (s - 1) k = k$. Con lo cual contiene una copia de $T_k$ por el Lema \ref{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices}.
\end{proof}

\begin{theorem}
Para todo $k \in \naturals$ se tiene que
\[
    \boxed{r (P_k) = \ceil{\frac{3k}{2}}}.
\]
\end{theorem}
\begin{proof}
Veamos primero la cota inferior. Sea $n := \ceil{\frac{3k}{2}}-1$. Consideremos un $K_k$ azul en $K_n$ y escribamos $A$ al conjunto de sus vértices; el resto de las aristas las pintamos de rojo. Notar que $B:= V(K_n) \setminus V(K_k)$ cumple
\[
    \abs B < \frac{k}{2}.
\]
Así, $K_n$ no tiene un $P_k$ azul. Veamos que tampoco tiene un rojo:

Tomemos un camino rojo $P$, luego no puede tener dos vértices adyacentes de $A$ (pues $K_n [A]$ es un completo azul). Por lo tanto en el peor de los casos $P$ tiene $\abs B$ vértices de $B$ tales que entre cada par consecutivos de estos hay un vértice de $A$. O sea,
\[
    \abs{P} \leq 2\abs{B} + 1 < k + 1.
\]
Es decir, tampoco tiene un $P_k$ rojo.

\Inkscape{Ilustración de esta situación.}{"./Figuras/Teoria de Ramsey/Figura 8.pdf_tex"}

\bigskip

Veamos ahora la cota superior. Vamos a probar un resultado un poco más general haciendo inducción en $k$:
\begin{quote}
Sea $k \geq l \geq 1$ y sea $n = k + \ceil{\frac{l}{2}}$, entonces
\[
    K_n \longrightarrow (P_k , P_l)
\]
\end{quote}
Notar que el caso $k = l$ implica la cota superior.

Consideremos una coloración de $K_n$. Sea $P$ un camino rojo maximal y supongamos que $\abs P \leq k$. Por maximalidad, cada extremo forma aristas azules con cada vértice de $V(G) \setminus V(P)$.

Nuestro caso base es $1 \leq l \leq k \leq 3$, donde vale la afirmación:

\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 9.pdf_tex"}

Ahora veamos el paso inductivo. Supongamos que $4 \leq l < k$. Por hipótesis inductiva, tenemos que $K_n \longrightarrow (P_{k-1}, P_l)$ y por lo tanto sin pérdida de generalidad podemos suponer que existe un $(k-1)$-camino rojo en $K_n$, digamos $P = v_1 v_2 \cdots v_k$. Escribamos $U := V(K_n) \setminus V(P)$; sabemos que $\abs U = \ceil{\frac l 2 }$. Notemos lo siguiente:
\begin{enumerate}[(i)]
\item Las aristas entre $v_1,v_k$ y $U$ son azules.
\item Para cada par de vértices consecutivos $v_i v_{i+1}$ en $P$ y cada $u \in U$, existe una arista azul en $\{v_i u, v_{i+1} u\}$, pues de lo contrario habríamos encontrado un $P_k$ rojo.
\end{enumerate}

Sean $Q_1$ y $Q_2$ caminos azules vértice-disjuntos de longitud impar (i.e., cantidad par de vértices) que alternan vértices de $v_2, \ldots, v_k$ y $U$. Tomemos $Q_1$ maximal, y sujeto a esto, tomemos $Q_2$ maximal. Por paridad de la longitud de $Q_1$ y $Q_2$, ambos tienen exactamente un extremo en $U$, digamos $x$ e $y$, respectivamente. Tenemos dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] $Q_1$ y $Q_2$ cubren $U$, es decir, $U \subset Q_1 \cup Q_2$. Con lo cual, podemos construir un $l$-camino azul considerando $Q_1 x v_1 y Q_2$. Luego supongamos que estamos en:
\item[\textbf{Caso 2:}] Existe $z \in U \setminus ( Q_1 \cup Q_2)$.
\end{enumerate}

Observemos que $v_k \in Q_1$, de lo contrario podríamos extender $Q_1$ con las aristas azules $v_k z$ y $v_k x$. Notemos que $Q_1 \cup Q_2$ contiene a lo más $\abs{U} -1$ vértices de $P$, y
\[
    \abs U  - 1 < \frac{k-1}{2}.
\]
Con lo cual, en $\{v_2, \ldots, v_{k-1}\}$ hay $\frac{k-1}{2} - 2 < \floor{\frac{k-2}{2}}$ vértices de $Q_1 \cup Q_2$. Así, existe un par de vértices consecutivos $v_{i}, v_{i+1}$ con $2 \leq i \leq k-2$ tales que $v_i , v_{i+1} \not \in Q_1 \cup Q_2$. Sin embargo, por el ítem (ii), existen existen dos aristas azules entre $v_i$ o $v_{i+1}$ y alguno de los siguientes conjuntos: $\{x,y\}$; $\{y,z\}$; o $\{x,z\}$. Esto contradice la maximalidad de $Q_1$ y $Q_2$, ya que podríamos extender algunos de estos caminos, y por ende el caso 2 no puede ocurrir.

\bigskip


Finalmente veamos el caso $k = l \geq 4$. Por hipótesis inductiva, tenemos que $K_n \longrightarrow (P_k, P_{k-1})$ y y por simetría se tiene $K_n \longrightarrow (P_{k-1}, P_k)$. Con lo cual, existe un $(k-1)$-camino rojo, digamos $P_r = v_1 \cdots v_k$, y un $(k-1)$-camino azul, digamos $P_a = w_1 \cdots w_k$. Si alguno de estos caminos se pudiera extender monocromáticamente habríamos terminado, con lo cual supongamos que son maximales monocromáticos. Notar que por maximalidad, debe ser que $\{v_1 , v_k\} = \{w_1, w_k\}$, de lo contrario podríamos extender monocromáticamente alguno de los dos caminos; digamos que $v_1 = w_1$ y $v_k = w_k$.

Ahora bien, tenemos que
\[
    n  = k + \ceil{\frac k 2} \geq \abs{V(P_r) \cup V(P_a)} = \abs{V(P_r)} + \abs{V (P_a)} - \abs{V(P_r) \cap V(P_a)} = 2k - \abs{V(P_r) \cap V(P_a)}.
\]
Consecuentemente, $\abs{V(P_r) \cap V(P_a)} \geq \floor{\frac{k}{2}}$. Hay dos opciones:
\begin{enumerate}
\item[\textbf{Opción 1:}] $\abs{V(P_r) \cap V(P_a)} > \floor{\frac{k}{2}}$. En este caso existe $z \in V(K_n) \setminus (V(P_r) \cup V(P_a))$, y por lo tanto $z v_1 = z w_1$ es una arista de color rojo o azul, y en cualquier caso podemos extender $P_r$ o $P_a$ monocromáticamente, contradiciendo la maximalidad de los caminos.
\item[\textbf{Opción 2:}] $\abs{V(P_r) \cap V(P_a)} = \floor{\frac{k}{2}}$. En este caso $P_r \cup P_a = K_n$ y de hecho, deben existir dos vértices interiores consecutivos de $P_r$, digamos $v_i v_{i+1}$ con $1 < i < k$, tales que no son vértices de $P_a$; similarmente, existen dos vértices interiores consecutivos de $P_a$, digamos $w_j w_{j+1}$ con $1 < j < k$, tales que no son vértices de $P_r$.
\end{enumerate}

Más aún, la arista $v_1 v_k = w_1 w_k$ es de color rojo o azul, digamos rojo (el otro caso es análogo). Con lo cual, tenemos un ciclo rojo $C_r := v_1 P_r v_{k} v_1$ de longitud $k$, y por lo tanto, podemos suponer que todas las aristas incidentes a $C_r$ tienen que ser azules, si no habríamos encontrado un $k$-camino rojo. Pero luego las aristas $w_j v_i$ y $w_{j+1} v_i$ son azules, y podemos alargar $P_a$ a un $k$-camino azul:
\[
    w_1 \cdots w_j v_i w_{j+1} \cdots w_k,
\]
contradiciendo la maximalidad de $P_a$. Como hemos agotado todos los casos, se concluye la demostración.
\end{proof}

\section{El problema con un final feliz}

\begin{proposition}[El problema de E. Klein (1930)]
Para todo $k \in \naturals$, existe $n = n(k) \in \naturals$ tal que dados $n$ puntos en posición general del plano (i.e. no hay $3$ puntos colineales), entonces el conjunto de puntos contiene $k$ puntos en posición convexa.
\end{proposition}
\begin{proof}[Demostración del caso $k = 4$ y $n = 5$]
Ella probó este caso\footnote{El cual fue bautizado como ``El problema con un final feliz'' por Paul Erdős, debido a que llevó al casamiento de George Szekeres y Esther Klein.}. Consideramos la cápsula convexa de los $5$ puntos, si los vértices son $4$ o $5$ de estos puntos ya ganamos, si no, existen dos puntos que están contenidos en el interior del triángulo convexo (formado por $3$ de estos puntos como vértices). Luego simplemente consideramos la recta que une a estos dos puntos interiores, la cual interseca a dos lados distintos del triángulo, y por lo tanto hay $4$ puntos en posición convexa:



\subfile{Figuras/Final feliz/final-feliz}
\end{proof}

El caso general se resolvió utilizando el \textit{Teorema de Ramsey Generalizado}, que enunciamos luego de algunas definiciones:

\begin{notation}
Dado $n \in \naturals$, notamos al conjunto $[n] := \{1, \ldots, n\}$.
\end{notation}

\begin{notation}
Sea $A$ un conjunto arbitrario, y $s \in \naturals$, notamos al conjunto:
\[
    \binom{A}{s} := \Set{S \subset A | \abs S = s}.
\]
\end{notation}

\begin{definition}
Una \textbf{$r$-coloración de subconjuntos} de $[n]$ de tamaño $s$, es una función
\[
    c : \binom{[n]}{s} \longrightarrow \{1, \ldots, r\}.
\]
Diremos que $A \subset [n]$ es \textbf{monocromático} (respecto de $c$), si $c(S) = c(S')$ para todo $S \in \binom{A}s$.
\end{definition}

\begin{theorem}[Teorema de Ramsey Generalizado]\label{th:teorema de Ramsey Generalizado}
Para todo $k,r,s \in \naturals$, existe $n \in \naturals$ tal que toda $r$-coloración de $\binom{[n]}{s}$ contiene un conjunto monocromático de tamaño $k$.
\end{theorem}

\begin{remark}
Nosotros probamos el caso $K_n$ en lugar de $\binom{[n]}{s}$ con $s = 2$ y $K_k$ monocromático.
\end{remark}

\begin{proof}[Continuación de la demostración del problema de E. Klein]
Falta probar el caso $k \geq 5$. Tomemos una coloración rojo-azul $c$ del conjunto $\binom{[n]}{4}$. Y coloreemos $c(S)$ de rojo si y solo si los puntos de $S$ están en posición convexa. Por el Teorema de Ramsey Generalizado \ref{th:teorema de Ramsey Generalizado}, existe $n$ tal que $B \subset [n]$ es monocromático y $\abs B = k$. Hay dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] $B$ es rojo, y por lo tanto todos los subconjuntos de tamaño $4$ de $B$ tienen color rojo, i.e., están en posición convexa. Ahora, los puntos de $B$ están en posición convexa, de lo contrario, podríamos encontrar un punto de $B$ en el interior de un triángulo con vértices de $B$ (notar que esto vale por no-colinealidad: trazamos las diagonales entre vértices del polígono convexo; el punto no puede estar en ninguna de estas rectas, i.e., está dentro de un triángulo), absurdo.
\item[\textbf{Caso 2:}] $B$ es azul, como $k \geq 5$, por el resultado preliminar de Klein, existen $4$ puntos en posición convexa, absurdo.
\end{enumerate}
\end{proof}


\begin{theorem}[Seidenberg]
Toda secuencia de $k^2 + 1$ números reales contiene una subsecuencia monótona de largo $k+1$.
\end{theorem}
\begin{proof}
Sea $a_1, \ldots, a_n$ una secuencia de números reales con $n = k^2 + 1$. Para cada $i \in [n]$, definimos un par:
\[
    (x_i, y_i),
\]
donde $x_i$ es el largo de la subsecuencia no decreciente más larga que termina en $a_i$; $y_i$ es el largo de la subsecuencia no creciente más larga que termina en $a_i$.

Para $i \neq j$, veamos que $(x_i, y_i) \neq (x_j, y_j)$. Para eso, sin pérdida de generalidad, supongamos que $i < j$. Tenemos dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] $a_i \leq a_j$. Acá se tiene que $x_i < x_j$.
\item[\textbf{Caso 2:}] $a_j \leq a_i$. Acá se tiene que $y_i < y_j$.
\end{enumerate}

Ahora por contradicción, si $x_i, y_i \leq k$ para todo $i \in [n]$, entonces hay a lo más $k^2$ pares distintos, sin embargo $n = k^2 + 1$, por lo que hay almenos un par repetido, absurdo.
\end{proof}


El siguiente ejercicio dice que el teorema anterior es preciso:
\begin{exercise}
Encontrar secuencia de números reales de largo $k^2$ sin subsecuencias monótonas de largo $k+1$.
\end{exercise}




\begin{theorem}[Chrátal, Rödl, Szemeredi \& Trotter (1983)]
Para todo $\Delta \in \naturals$, existe una constante $c = c(\Delta)>0$ tal que todo grafo $H$ con $\Delta (H) \leq \Delta$, satisface
\[
    r(H) \leq c(\Delta) \cdot \abs H.
\]
En particular, para $n \geq c(\Delta) \cdot \abs H$, toda $2$-coloración de $K_n$ contiene un $H$ monocromático.
\end{theorem}

\begin{proof}
La idea será aplicar el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} y el siguiente lema de inmersión:


\begin{lemma}[Un lema de inmersión]\label{lema:un lema de inmersion para numeros de ramsey}
Dados $d \in \naturals$ y $\delta >0$, existe $\varepsilon > 0$ y $\gamma > 0$ tales que si $n \in \naturals$ y $H$ es un grafo con $\Delta (H) \leq d$ y $\abs H \leq \gamma n$, entonces
\[
    G \in \mathcal G (K_{d+1}, n , \varepsilon , \delta) \quad \Longrightarrow \quad H \subset G    .
\]
\end{lemma}

Sea $\Delta > 0$ y $H$ con $\Delta (H) \leq \Delta$. Aplicamos este lema de inmersión con $d = \Delta$ y $\delta = \frac{1 }{2}$, y obtenemos parámetros $\varepsilon$ y $\gamma$, tales que se cumple la conclusión del enunciado. Consideremos $K_n$ con $n \geq c(\Delta) \cdot \abs H$ donde $c(\delta) $ es lo suficientemente grande.

Tomemos una coloración con rojo y azul de $K_n$, y sean $G_r$ y $G_a$ los subgrafos inducidos de color rojo y azul, respectivamente. Sea $m := r(K_{d+1})$. Aplicamos el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} en $G_r$ con parámetro $m$ y $\varepsilon$. Obtenemos una partición $\varepsilon$-regular
\[
    V(G_r) = V_0 \coprod V_1 \coprod \cdots \coprod V_k,
\]
con $m \leq k \leq M$. Notar que esta partición también es $\varepsilon$-regular para $G_a$ \red{\textbf{TAREA}}.

Sea $R$ el grafo reducido con parámetros $\varepsilon$ y densidad $0$ (no nos interesa la densidad). Entonces,
\[
    e(R) \geq \binom k 2     - \varepsilon k^2 > t_{m-1} (k) = \left ( 1 - \frac{1}{m-1} + o(1) \right) \frac{k^2}{2}  \quad (k \longrightarrow 1),
\]
y por lo tanto el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}, $R \supset K_m$. Sean ahora $A_1, \ldots, A_m$ las partes que corresponden a los vértices de $K_m$ en $R$. Vamos a definir una $2$-coloración $f$ de las aristas de $K_m$:
\[
    f(ij) = \text{rojo} \quad \Leftrightarrow \quad d_{G_r} (V_i, V_j) \geq \frac{1}{2}.
\]
Como $m = r (K_{d + 1})$, existe un $K_{d + 1}$ rojo o azul, sin pérdida de generalidad supongamos que es rojo en $K_m$. Reindexando los $A_i$, podemos suponer que $A_1, \ldots, A_{d+1}$ corresponden a las partes de $K_{d+1}$ de $K_m$. El grafo inducido
\[
    G' = G_r [A_1 \cup \cdots \cup A_{d+1}]
\]
satisface que $G' \in \mathcal G (K_{d+1}, n', \varepsilon, \delta)$, con
\[
    n' = \abs{V_1} = \cdots, \abs{V_k} \geq \frac{n}{M}.
\]

Así, elegimos $c = c(\Delta)$ suficientemente grande (en particular, $c \geq M/\gamma$), entonces
\[
    \abs H \leq \frac{n}{c(\Delta)} \leq \frac{\gamma n}{M} \leq \gamma n',
\]
con lo cual se tiene la conclusión del teorema por el lema de inmersión de arriba.
\end{proof}







\chapter{El método probabilístico}

En 1959, Erdös probó que \textit{para todo entero $k$ existe un grafo $G$ con $g(G)>k$ y $\chi (G) > k$}. El enfoque que tomó fue definir un espacio de probabilidad en el conjunto de grafos con $n$ vértices, y probar que para una medida de probabilidad adecuada, la probabilidad de que un grafo con $n$ vértices cumpla ambas condiciones es positiva para $n$ lo suficientemente grande. A esta técnica se le llama el \textbf{método probabilístico}, y será el eje central de este capítulo.


\section{Fundamentos}

\begin{definition}
Un \textbf{espacio probabilístico} es un par $(\Omega, P)$, donde $\Omega$ se denomina \textbf{espacio muestral} y $P$ la \textbf{función probabilística}, la cual cumple
\[
    \sum_{\omega \in \Omega} P(\omega) = 1,
\]
y $P(\omega) \in [0,1] \subset \reals$. A los subconjuntos $A \subset \Omega$, los llamamos \textbf{eventos}, y definimos la cantidad
\[
    P(A) := \sum_{\omega \in A} P (w),
\]
i.e., la \textbf{probabilidad de que suceda el evento $A$}.
\end{definition}

Daremos ahora las propiedades básicas de un espacio probabilístico, cuyas demostraciones se ven en cualquier curso introductorio de probabilidad:
\begin{proposition}
Sea $(\Omega, P)$ un espacio de probabilidad. Entonces:
\begin{enumerate}[(1)]
\item Para todo evento $A \subset \Omega$
\[
    P(A) = 1 - P (\Omega \setminus A).
\]
\item Si $A \subset B \subset \Omega$, luego $P(A) \leq P(B)$.
\item Sean $A,B \subset \Omega$, luego tenemos
\[
    P(A \cup B) = P(A) + P(B) - P(A \cap B).
\]
\item Para una familia $A_1, \ldots, A_r \subset \Omega$, tenemos que
\[
    P(\bigcup_{i = 1}^n A_i) \leq \sum_{i = 1}^n P(A_i).
\]
\end{enumerate}
\end{proposition}

\begin{definition}
Una \textbf{distribución uniforme} (discreta), es un espacio probabilístico $(\Omega, P)$ tal que $P (\omega) = \frac{1}{\abs \Omega}$. Si $A \subset \Omega$, entonces $P(A) = \frac{\abs A}{\abs \Omega}$.
\end{definition}

\begin{definition}
Sean $A,B \subset \Omega$, decimos que $A$ y $B$ son \textbf{eventos independientes} o simplemente \textbf{independientes} si
\[
    P(A \cap B) = P(A) \cdot P(B).
\]
Más generalemnte, sean $A_1, \ldots, A_n \subset \Omega$, decimos que son \textbf{independientes dos a dos}, si $A_i $ y $A_j$ son independientes para cada $i \neq j$. Por otro lado, decimos que $A_1, \ldots, A_n$ son \textbf{mutuamente independientes} si
\[
    P(\bigcap_{i = 1}^n A_i) = \prod_{i = 1}^n P(A_i).
\]
\end{definition}

Dado $n \in \naturals$, podemos construir un espacio probabilístico $\mathcal G:= \mathcal G (n, p) := (\Omega , P)$, donde $\Omega$ es el conjunto de grafos con conjunto de vértices $V:= [n]$, y para cada posible arista $e$, la probabilidad de que $e$ pertenezca a $E(G)$ para $G \in \Omega$ es $p$, y estos eventos son independientes para distintas aristas $e \neq e'$. Más precisamente, los eventos $A_e := \{G \in \Omega | e \text{ es arista de $G$}\}$ con distintos $e$, son mutuamente independientes. Llamaremos a $G$ un \textbf{grafo aleatorio}. (Se puede encontrar una construcción formal en el Capítulo 11 de \cite{diestel2000graphTheory}).

\begin{example}
Dado un grafo fijo $H$ con $k$ vértices y $m$ aristas, consideremos el evento: $G$ contiene a $H$ como subgrafo. La probabilidad de que este evento suceda, es
\[
    \prod_{e \in H} P (A_e) = p^m.
\]
Similarmente, la probabilidad de que $H$ sea un subgrafo inducido de $G$ es $p^m (1-p)^{\binom k 2 - m}$, pues ahora hay que considerar que las aristas que no están en $H$ tampoco pueden estar en $G$ (evento independiente).
\end{example}

\begin{theorem}[Erdös 1947]
Para todo $k \geq 3$, se tiene que $R(k) > 2^{k/2}$.
\end{theorem}
\begin{proof}
Sea $n = 2^{k/2}$. A cada arista $uv$ de $K_n$, asignémosle la probabilidad $P(uv) = \frac 1 2$ de que sea color rojo, y lo mismo color azul. El objetivo es probar de que el evento de que haya una coloreo sin $K_k$ monocromático en $K_n$ tiene medida positiva, de aquí se seguirá la demostración. (Notar que estamos trabajando en el espacio probabilístico $(\Omega, P)$, con espacio muestral $\prod_{uv \in E(K_n)} \{\text{rojo}, \text{azul}\}$ y los eventos con aristas distintas son independientes.)

Para cada $A \subset V(K_n)$ de tamaño $k$, tenemos que
\[
    P(A \text{ monocromático}) = 2^{-\binom k 2} + 2^{- \binom k 2} = 2^{1 - \binom k 2}.
\]
Por lo tanto,
\begin{align*}
P(\bigcup_{i = 1}^{\binom n k} A_i) &\leq \sum_{i = 1}^{\binom n k} P(A_i) \\
&= \binom n k    2^{1 - \binom k 2} \\
&\leq \frac{n^k}{k!} 2^{1 - k^2/2 + k/2} \\
&= \frac{2^{1 + k/2}}{k!} < 1.
\end{align*}
\end{proof}

\begin{definition}
Un \textbf{hipergrafo $k$-uniforme} $H$, es una estructura compuesta por vértices y aristas, donde las aristas son conjuntos de $k$-vértices.
\end{definition}



\begin{definition}
Decimos que un hipergrafo $H$ es \textbf{bicolor}, si es posible colorear los vértices con dos colores, de tal manera que no hay aristas con vértices monocromáticos.
\end{definition}

\Inkscape{Bicoloración de un $3$-hipergrafo $H$ con vértices $v_1,v_2,v_3,v_4$ y aristas $e_1 = \{v_1,v_2,v_3\}$, $e_2 = \{v_2,v_3,v_4\}$, $e_3 = \{v_1,v_2,v_4\}$.}{"./Figuras/Metodo-probabilistico-1/Dibujo 1.pdf_tex"}

\begin{theorem}[Erdös 1963]
Sea $H$ un hipergrafo $k$-uniforme con $m$ aristas. Si $m < 2^{k-1}$, entonces $H$ es bicolor.
\end{theorem}
\begin{proof}
Sea $H$ un hipergrafo $k$-uniforme. Consideramos un coloreo de cada vértice vértice con color rojo o azul, de forma independiente con probabilidad $\frac 1 2$.
Consideremos $A \in E(H)$, luego
\[
    P(A \text{ monocromático}) = 2^{1-k}.
\]
Escribamos $A_i$ con $i \in [m]$ para los vértices de cada una de las $m$ aristas de $H$. Luego
\[
    P(\bigcup_{i = 1}^m A_i) \leq \sum_{i = 1}^m P(A_i) = m \cdot 2^{1-k} < 1.
\]
\end{proof}


\begin{definition}
Un \textbf{torneo} $T$ es un grafo dirigido tal que su grafo subyacente no tiene aristas paralelas.

Dado un conjunto $S \subset V(T)$ y un vértice $u \in V(T)$, escribimos $u \to S$ si $(u,v) \in E(T)$ para todo $v \in S$.

Decimos que $T$ tiene \textbf{la propiedad $\mathcal T_k$}, si para todo $S \subset V(T)$ de tamaño $k$, existe un $u \in V(T) \setminus \{S\}$ tal que $u \to S$.
\end{definition}

\Inkscape{Ejemplo de un torneo $T$ con conjunto $S \subset V(T)$ y $u \in V(T)$ tal que $u \to S$.}{"./Figuras/Metodo-probabilistico-1/Dibujo 2.pdf_tex"}

\begin{theorem}[Erdös 1963]
Si $n \geq k^2 2^{k+1}$, entonces existe un torneo $T$ con $n$ vértices con la propiedad $\mathcal T_k$.

\end{theorem}
\begin{proof}
Consideremos un torneo aleatorio $T$ con $n$ vértices y para cada par $u,v$ escogemos $uv \in E(T)$ o $vu \in E(T)$ de forma independiente con probabilidad $\frac 1 2$. Consideremos un conjunto $S \subset V(T)$ con tamaño $k$. Para todo $u \in V(T) \setminus S$
\[
    P(u \to S) = 2^{-k}.
\]
Consideremos $A_S$ como el evento de que todo $u \in V(T) \setminus S$ no se cumpla que $u \to S$. Luego
\[
    P(A_S) = P(\bigcap_{i = 1}^{n-k} \{u_i \not \to S\}) = \prod_{i = 1}^{n-k} P(\{ u_i \not \to S \}) = (1 - 2^{-k})^{n-k}
\]
por independencia de eventos. Ahora
\begin{align*}
P(\bigcup_{i = 1}^{\binom n k} A_{S_i}) \leq \binom n k \cdot P(A_{S}) = \binom n k (1 - 2^{-k})^{n-k} \leq \frac{n^k}{k!} e^{-(n-k)/2^k} \leq n^k e^{-n /2^k}.
\end{align*}
donde usamos que $1 + x \leq e^x$ y que $e^{k/2^k}/k! < 1$. Finalmente, notar que se puede escribir el lado derecho como $n^{k}e^{-n/2^k}= e^{k \log n - n/ 2^k}$. Por lo tanto, basta ver que $k \log n < n / 2^k$, equivalentemente
\[
    k 2^k < n / \log n,
\]
para probar que la probabilidad del lado izquierdo de la desigualdad de arriba es menor que $1$. Este es el caso, pues el lado derecho es creciente en $n$ y se cumple la desigualdad para $n = k^2 2^{k+1}$.
\end{proof}







\section{Esperanza}

\begin{definition}
Dado un espacio probabilístico $\mathcal G = (\Omega, P)$, una \textbf{variable aleatoria} (en $\mathcal G$) es una función
\[
    X: \Omega \longrightarrow \reals.
\]

La \textbf{esperanza} o \textbf{promedio} de $X$ es la cantidad
\[
    \mathbb{E} (X) = \sum_{G \in \Omega} P (\{G\}) \cdot X (G).
\]
\end{definition}

\begin{notation}
Si $X : \mathcal G \to [0, + \infty)$ es una variable aleatoria en un espacio probabilístico, dada una proposición lógica $A$, notamos
\[
    P (X \text{ cumple la propiedad $A$}) = P (\{G \in \Omega | X(G) \text{ cumple la propiedad $A$}\}).
\]
En particular, $P(X \geq a) := P \left(X^{-1} ([a, + \infty ) )\right)$, $P(X < b) := P \left(X^{-1} ([0, b ) )\right)$, $P(X = c) := P \left(X^{-1} (\{c\})\right)$, etc.

También diremos que $X$ cumple la propiedad $A$ \textbf{salvo probabilidad cero}, si
\[
    P(G \in \Omega | X(G) \text{ no cumple $A$}) = 0.
\]
Por ejemplo, $X \geq a$, $X < b$, $X = c$, salvo probabilidad cero, si respectivamente
\[
  P(X \geq a) = P ( X < b) = P (X = c) = 0.
\]
\end{notation}

\begin{obs}
\begin{enumerate}
\item Notar que cuando $X$ toma valores enteros, podemos calcular la esperanza de manera alternativa:
\[
    \mathbb{E} (X) = \sum_{k \geq 1} P(X \geq k) = \sum_{k \geq 1} k \cdot P(X = k).
\]
\item Sea $\mathcal H$ un conjunto fijo de grafos en $V$. Y sea $X$ la variable aleatoria tal que $X(G)$ es la cantidad de grafos $H \in \mathcal H$ que son subgrafos de $G$. Entonces la esperanza de $X$ tiene dos maneras distintas de calcular (observación útil para utilizar argumentos de ``conte doble''):
\[
    \mathbb{E} (X) = \sum_{G \in \mathcal G}\# \{H \in \mathcal H | H \subset G\} \cdot P(\{G\}) = \sum_{H \in \mathcal H} P (G \in \Omega | G \supset H).
\]
\end{enumerate}
\end{obs}

Las siguientes propiedades son fáciles de demostrar:
\begin{proposition}\label{proposition:propiedades de la esperanza}
Dadas variables aleatorias $X,Y \geq 0$ de un espacio probabilítico $G = (\Omega, P)$, y sea $a \geq 0$. La esperanza cumple las siguientes propiedades:
\begin{enumerate}[(i)]
\item \textbf{Positividad:} $\mathbb{E}(X)\geq 0$.
\item \textbf{Linealidad:} $\mathbb{E} (X + Y) = \mathbb{E} (X) + \mathbb{E} (Y)$, y $\mathbb{E}(a \cdot X) = a \mathbb{E} (X)$.
\item \textbf{Monotonicidad:} Si $X \leq Y$, salvo probabilidad cero, entonces $\mathbb{E} (X) \leq \mathbb{E} (Y)$.
\item Si $\mathbb{E} (X) = 0$, entonces el conjunto $B := \{G \in \Omega | X(G) \neq 0\}$ tiene probabilidad $0$.
\item Si $X = Y$, salvo probabilidad cero, entonces $\mathbb{E} (X) = \mathbb{E}(Y)$.
\end{enumerate}
\end{proposition}

Estas propiedades nos permiten calcular la esperanza de una variable aleatoria como ilustra el siguiente ejemplo:
\begin{example}
El promedio de $k$-ciclos en $G \in \mathcal G (n,p)$ es
\[
    \mathbb{E} (X) = \frac {p^k}{2k} \prod_{r = 0}^{k-1} n - r.
\]
\end{example}
\begin{proof}
Consideremos la familia de $k$-ciclos $\mathcal C_k$ en $\mathcal G$. Entonces dado $C \in \mathcal C_k$ podemos considerar la variable aleatoria \textbf{función indicadora}:
\begin{align*}
X_C : \mathcal G (n,p) &\longrightarrow \{0,1\} \\
G &\longmapsto \begin{cases}
1 &\text{ si $C \subset G$,} \\
0 &\text{ si no.}
\end{cases}
\end{align*}
Notar que
\[
    \mathbb{E} (X_C) = P(X_C = 1) = P(G \in \mathcal G (n,p) | G \supset C) = p^k.
\]

Por otro lado, sea $X$ la variable aleatoria tal que $X (G)$ es la cantidad de ciclos $C \in \mathcal C _k$ contenidos en $G$. Entonces
\[
    X = \sum_{C \in \mathcal C_k} X_C.
\]
Por linealidad (\ref{proposition:propiedades de la esperanza}),
\[
    \mathbb{E}(X) = \sum_{C \in \mathcal C_k} \mathbb{E}(X_C) = \sum_{C \in \mathcal C_k} P (G \supset C) = \abs{\mathcal C_k} p^k.
\]

Finalmente, como por cada elección de $k$ distintos vértices en $V$ hay $2k$ maneras distintas de formar un $k$-ciclo en $\mathcal G$, tenemos que
\[
    \abs{C_k} = \frac{1}{2k} \prod_{r = 0}^{k-1} n - r,
\]
de donde concluimos.
\end{proof}


\bigskip

Una desigualdad útil que nos dice que la probabiliad de que $X$ valga ``mucho más respecto del promedio'' es baja:

\begin{lemma}[Desigualdad de Markov]\label{lema:desigualdad de markov}
Sea $X : \mathcal G \to [0, +\infty)$ una variable aleatoria y $a > 0$. Entonces
\[
    P(X \geq a) \leq \frac{\mathbb{E} (X)}{a}.
\]
\end{lemma}
\begin{proof}
\[
    E(X) = \sum_{G \in \mathcal G} P(\{G\}) \cdot X(G) \geq \sum_{\substack{G \in \mathcal G \\ X(G) \geq a}} P(\{G\}) \cdot a = P(X \geq a) \cdot a.
\]
\end{proof}





\section{Método del primer momento}



\begin{definition}
Decimos que una variable aleatoria $X$ \textbf{sigue una distribución de Bernoulli con parámetro $p\in [0,1]$}, si $P(X = 1) = p$ y $P (X = 0) = 1-p$. (Notar que $\mathbb{E} (X) = p$).
\end{definition}

\begin{definition}
Dadas variables aleatorias $X_1, \ldots, X_n : \Omega \to \reals$, decimos que son \textbf{independientes}, si para cualquier $x_1, \ldots, x_n \in \reals$, los eventos $\{X_i = x_i\}$ con $i = 1, \ldots, n$ son mutuamente independientes.
\end{definition}

\begin{proposition}
Sean $X_1, X_2$ variables aleatorias independientes, entonces
\[
    \mathbb{E} (X_1 \cdot X_2) = \mathbb{E} (X_1) \cdot \mathbb{E}(X_2)
\]
\end{proposition}

\begin{definition}
Una variable aleatoria binomial $X$ con parámetros $n$ y $p$ es la suma de $n$ variables aleatorias mutuamente independientes de Bernulli con parámetro $p$. (Notar que en este caso se tiene $\mathbb{E} (X) = np$).
\end{definition}

\begin{proposition}\label{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva}
Sea $X$ una variable aleatoria. Si $\mathbb{E} (X) \geq t$, entonces
$$P(X \geq t) > 0.$$
\end{proposition}

\begin{theorem}
Todo grafo $G$ tiene un subgrafo bipartito $H \subset G$ tal que
\[
    e(H) \geq \frac{e(G)}{2}.
\]
\end{theorem}
\begin{proof}
Consideremos un conjunto aleatorio $A \subset V(G)$, obtenido escogiendo a cada vértice $v \in V(G)$ de forma aleatoria e independiente con probabilidad $\frac 1 2$. Sea $B = V \setminus A$ y consideremos el subgrafo $H$ con conjunto de vértices $A$ y $B$, y aristas $E(H) = \{uv \in E(G) | u \in A, v \in B\}$. Para $uv \in E(G)$, definamos la variable aleatoria $X_{uv}$ tal que $X_{uv} (H) = 1$ si $uv \in E(H)$ o $X_{uv} (H) = 0$ si no. Se tiene que
\[
    \mathbb{E} (X_{uv}) = P (\{uv \in E(H)\}) = \frac 1 4 + \frac 1 4 = \frac 1 2.
\]
Consideremos la variable aleatoria $e$ tal que $e(H)$ que devuelve la cantidad de aristas de $H$. Como $e = \sum_{uv \in E(G)} X_{uv}$, se sigue que
\begin{align*}
\mathbb{E} (e) = \mathbb{E} \left ( \sum_{uv \in E(G)} X_{uv} \right ) = \sum_{uv \in E(G)} \mathbb{E}(X_{uv}) = \frac{e(G)}{2}.
\end{align*}
Finalmente, por la Proposición \ref{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva}, $P(e \geq \frac{e(G)}{2}) > 0$, i.e., tiene que existir un subgrafo $H$ de $G$ bipartito tal que $e(H) \geq \frac {e(G)}{2}$.
\end{proof}

\begin{theorem}[Szele]
Para todo $n \in \naturals$, existe un torneo $T$ con $n$ vértices y almenos $\frac{n!}{2^{n-1}}$ caminos dirigidos Hamiltonianos (caminos que pasan por todas los vértices).
\end{theorem}
\begin{proof}
Consideremos el espacio probabilítico de torneos $T$ con vértices en $[n]$, es decir, el espacio de grafos aleatorios con vértices $[n]$ tales que si $uv$ es una arista la orientamos de manera aleatoria en cada dirección con probabilidad $\frac 1 2$, de manera independiente del resto de las aristas. Tenemos la variable aleatoria $X$ tal que $X(T)$ es el número de caminos hamiltonianos en $T$. Para cada permutación $\sigma : [n] \to [n]$, definimos $X_\sigma$ como la variable aleatoria indicadora del evento
\[
    \{\sigma (1), \ldots,  \sigma (n) \text{ es un camino Hamiltoneano en $T$}\}.
\]
Ahora,
\[
    \mathbb{E} (X_\sigma) = P (\sigma (1), \ldots, \sigma (n) \text{ es un camino Hamiltoneano en $T$}) = \frac 1 {2^{n-1}}.
\]
Así,
\[
\mathbb{E} (X) = \mathbb{E} \left(\sum_{\sigma} X_\sigma \right) = \frac{n!}{2^{n-1}}.
\]
Con lo cual la Proposición \ref{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva} concluye el teorema.
\end{proof}

\bigskip

Dado un grupo abeliano $\mathcal A$. Diremos que $A \subset \mathcal A$ es \textit{libre de suma}, si no existen tres elementos $x,y,z \in A$ tales que $x + y = z$. Por ejemplo, podemos considerar $\mathcal A = \integers$ o $\integers / p \integers$, para un primo $p$.

\begin{theorem}[Erdös]
Sea $A$ un conjunto de $n$ números enteros positivos, entonces existe $B \subset A$ libre de suma tal que $\abs B > \frac n 3$.
\end{theorem}
\begin{proof}
Tomemos un número primo $p = 3k +1$ suficientemente grande, por ejemplo $p > 2 \max {A}$. Sea $\integers_p := \integers / p \integers$, y consideremos $C := \{ i \in \naturals | k < i \leq 2k +1\}$. Luego $\abs C = k + 1 > \frac{p-1}3$. Luego $C$ es libre de suma en $\integers _p$.

Tomemos $t \in \integers_{p}^\times$ de manera aleatoria y uniforme (probabilidad $\frac 1 {p-1}$). Sea $Y = t \cdot A \mod p$, notemos que para $a \in \integers_p^\times$ tenemos la variable aleatoria $Z$ tal que $Z(t)$ indica si $a \in Y$ o no con $1$ o $0$ respectivamente. Notar que
\[
    P(Z) = P(a \in Y) = \frac{\# A}{p-1},
\]
pues $a \in Y$ si y solo si $a t^{-1} \in A \mod p$, si y solo si, $t^{-1} \in a^{-1} A \mod p$, además, $A \mod p$ es un conjunto de $\#A$ elementos y multiplicar por un elemento de $\integers_p^\times$ e invertir son biyecciones.
Consecuentemente,
\[
    \mathbb{E}(\# Y \cap C) = \sum_{a \in C} P (x \in Y) = \frac{\#A \cdot \#C}{p-1} > \frac{\#A}{3} = \frac n 3.
\]
Luego por la Proposición \ref{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva} existe $t_0 \in \integers_p^\times$, tal que $\# Y \cap C \geq \frac n 3$.

Así, el conjunto $B := \{a \in A  | t_0 a \mod p \in C\}$ funciona. En efecto, por cómo lo tomamos, $\abs B > \frac n 3$, y es libre de suma: si $a,b,c \in B$ son tales que
\[
    a + b = c,
\]
luego
\[
    t_0 a +t_0 b = t_0 c \mod p,
\]
pero esto es imposible pues $C$ es libre de suma.
\end{proof}

\begin{theorem}
Para cada grafo $G$ se tiene que
\[
    \alpha (G) \geq \sum_{v \in V} \frac{1}{1 + d_G (v)}.
\]
\end{theorem}
\begin{proof}
Sea $n = \abs{G}$, identifiquemos los vértices de $G$ con $[n]$, y consideremos el espacio probabilístico de funciones biyectivas $\sigma : [n] \to [n]$ escogidas de manera aleatoria y uniforme. Sea
\[
    A = \{v \in V(G) | \sigma (v) < \min_{w \in N_G (v)} \sigma (w)\},
\]
notemos que $A$ es un conjunto independiente. Afirmamos que $P (v \in A) = \frac{1}{1 + d(v)}$ para cualquier $v \in G$. En efecto, dado $v \in G$, consideremos el conjunto $X := \{x_0, \ldots, x_d\}$, donde $x_0 = v$ y $x_1, \ldots, x_d$ son los $d := d_G(v)$ vecinos de $v$ en $G$, entonces tenemos la variable aleatoria $Y$, tal que $Y ( \sigma) = \min_{0 \leq i \leq d} \{\sigma (x_i)\}$, luego notar que
\[
    1 = \sum_{i = 0}^d P ( \sigma | Y(\sigma) = \sigma (x_i) ) = (d+1) P (\sigma | Y (\sigma) = \sigma (x_0)),
\]
pues todas las probabilidades que aparecen son iguales: la probabilidad es uniforme y por simetría los eventos tienen todos la misma cardinalidad. Como la probabilidad del extremo derecho es justamente $P (v \in A)$, concluimos la afirmación.

Por lo tanto,
\[
    \mathbb{E}(\#A) = \sum_{v \in V(G)} P ( v \in A) = \sum_{v \in V(G)} \frac{1 }{1 + d_G(v)},
\]
con lo cual la Proposición \ref{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva} prueba el teorema.
\end{proof}


\section{Erdös-Rényi}

\begin{definition}
Sea $p_n \in [0,1]$. Diremos que un evento $E_n$ en $\mathcal G (n,p_n)$ tiene \textbf{probabilidad alta}, si
\[
    P(E_n) \longrightarrow 1 \quad (n \to \infty).
\]
\end{definition}

\begin{theorem}[Erdös-Rényi]
Sea $p_n \in (0,1)$. Entonces el evento
\[
    \alpha (G) \leq \frac{2 \log n}{p_n}, \quad G \in \mathcal G(n,p),
\]
tiene probabilidad alta.
\end{theorem}
\begin{proof}
Sea $G \in \mathcal G (n,p_n)$. Dado $S \subset V(G)$ de tamaño $k$. Entonces
\[
    P(e(G[S]) = 0) = (1-p_n)^{\binom k 2}.
\]
Luego, por la desigualdad de la unión,
\begin{align*}
P(\alpha \geq k) &\leq \binom n k (1-p_n)^{\binom k 2} \\
&\leq \left ( \frac {en}{k} \cdot (1-p_n)^{\frac{k-1}2} \right )^k \\
&\leq \left ( \frac {en}k \cdot e^{\frac{-p_n(k-1)}{2}} \right )^k.
\end{align*}
Si $p_nk \geq 2 \log (n)$, i.e., $k \geq \frac{2 \log n }{p_n}$, luego
\begin{align*}
\frac{e \cdot e^{\log (n)}}{k} \cdot e^{\frac{-p_n (k-1)}{2}} &\leq \frac{e^{1 + \log n - \log n + \frac {p_n} 2}}{k} \\
&\leq \frac{e^{1 + p_n/2}}{k} \\
&\leq \frac {e^{\frac 3 2}}{k} \leq \frac 5 k.
\end{align*}
Por lo tanto, podemos tomar $k=k(n)$ de tal forma que
\[
    P(\alpha \geq k) \leq \left ( \frac 5 k \right )^k \longrightarrow 0, \quad (n \to \infty).
\]
En consecuencia,
\[
    P \left (\alpha < \frac{2 \log n}{p_n} \right ) \leq P(\alpha < k) \longrightarrow 1, \quad (n \to \infty).
\]
\end{proof}


\begin{corollary}
Sea $p_n \in (0,1)$. Entonces
\[
    \chi (G) \geq \frac{n p_n}{2 \log n} , \quad G \in \mathcal G (n,p_n)
\]
con probabilidad alta.
\end{corollary}
\begin{proof}
Sea $c$ una $(\chi (G) = k)$-coloración de los vértices, y sean las partes $A_1, \ldots, A_k$ de cada color. Entonces
\[
    n = \sum_{i = 1}^k \abs{A_i} \leq \sum_{i = 1}^k \alpha (G) = \chi (G) \cdot \alpha (G).
\]
Consecuentemente,
\[
    \chi (G) \geq \frac{n}{\alpha (G)} \geq \frac{n p_n}{2 \log n}
\]
con probabilidad alta por el teorema anterior.
\end{proof}


\subsection{Método de alteración}

\begin{theorem}
Si $G$ es un grafo con $n \in \naturals$ vértices y $d(G) := d := 2 \frac{v(G)}{e(G)}$, entonces
\[
    \alpha (G) \geq \frac{n}{2 d}.
\]
\end{theorem}
\begin{proof}
Sea $p \in (0,1)$ (que no depende de $n$). Sea $A$ un conjunto aleatorio escogiendo vértice de $V(G)$ con probabilidad $p$ de forma independiente. Luego $\#A \sim \operatorname{Bin} (n,p)$, y
\[
    \mathbb{E}(\#A) = np.
\]
Además, para cada $uv \in E (G)$,
\[
    P (uv \in E(G[A])) = P(\{u \in A\} \cap \{v \in A\}) = P (u \in A) \cdot P (v \in A) = p^2.
\]
Con lo cual, la aditividad de la esperanza implica:
\[
    \mathbb{E} (e (G[A])) = e(G) p^2.
\]

Ahora, notemos que
\[
    \mathbb{E}(\abs A - e(G[A])) = pn \big(1 - \frac {pd}2 \big).
\]
Por la Proposición \ref{proposition:si la esperanza es mayor que t luego la probabilidad de que X sea mayor que t es positiva},
\[
    P \left (\Set {A | \abs{A} - e(G[A]  ) \geq p n \big ( 1 - \frac {pd}{2} \big ) } \right ) > 0,
\]
en particular existe un conjunto $A$ de vértices de $G$ tal que,
\[
    \abs A - e(G[A]) \geq pn \Big (1 - \frac{pd}2 \Big),
\]
y el lado de la derecha se maximiza cuando $p = \frac 1 d$; nos queda:
\[
    \abs A - e(G[A]) \geq \frac{n}{2d}.
\]
Tomemos ahora el subconjunto $A'$ de $A$, donde por cada arista $e \in E(G[A])$, quito un extremo en $e$ de $A$. Por construcción $A'$ es un conjunto independiente de $G$, y además
\[
    \abs{A'} \geq \frac{n}{2d}.
\]
De aquí deducimos la desigualdad del teorema.
\end{proof}

Como bién ilustra la demostración anterior, el \textit{método de alteración} es la técnica de obtener un conjunto $A$ que no cumple exactamente la propiedad que buscábamos, pero ``alterándolo'' a un conjunto $A'$, se obtiene lo que queríamos.

\begin{theorem}[Erdös]
Para todo $k \in \naturals$, existe $n_0 \in \naturals$, tal que para todo $n \geq n_0$, existe un grafo $G$ con $n$ vértices y
\[
    \chi (G) \geq k \quad \text y \quad g(G) \geq k.
\]
\end{theorem}
\begin{proof}
Sea $k \in \naturals$ fijo. Consideremos $\mathcal G = \mathcal G (n, p_n)$ con $p_n := n^{-1 + \varepsilon}$, donde $\varepsilon := \frac 1 k$. Consideremos la variable aleatoria $X_i$ en $\mathcal G$ que cuenta el número de ciclos de longitud $3 \leq i \leq k-1$; luego la variable aleatoria $X := \sum_{i=3}^{k-1} X_i$ cuenta el número de ciclos de longitud a lo más $k -1$. Notar que existen a lo más $n^i$ ciclos distintos que se pueden formar con los vértices del espacio muestral $\mathcal G$, luego, como $X_i$ es la suma de las variables aleatorias indicadoras de los ciclos $C_r$ de longitud $i$,
\[
    \mathbb{E}(X_i) = \sum_r ( G \supset C_r) \leq \sum_{r=1 }^{n^i}p^i = n^i p^i.
\]
Así,
\[
    \mathbb{E} (X)  = \sum_{i = 3}^{k-1} \mathbb{E} (X_i) \leq \sum_{i = 3}^{k-1} n^i p^i = \sum_{i = 3}^{k-1} n^{\varepsilon i} < k n^{\varepsilon(k-1)}.
\]
Con lo cual, la desigualdad de Markov \ref{lema:desigualdad de markov} implica que
\[
    P(X \geq \frac n 2) \leq \frac 2 n \mathbb{E}(X) \longrightarrow 0 \quad (n \to \infty).
\]
Entonces $X < \frac n 2$ con probabilidad alta.

Ahora, por el teorema anterior,
\[
    \alpha (G) \leq \frac{2 \log n} {p_n} = 2 n^{1-\varepsilon} \log n , \quad G \in \mathcal G
\]
con probabilidad alta. Consecuentemente, existe $G$ en $n$ vértices y a lo más $\frac n 2$ ciclos de tamaño menor que $k$. Removiendo $\frac n 2$ vértices, uno por cada ciclo, obtenemos $G'$ tal que $v(G') \geq \frac n 2$ y $g (G') \geq k$. Por otro lado,
\[
    \alpha (G') \leq \alpha (G) \leq 2 n^{1-\varepsilon} \log n,
\]
con lo cual,
\[
    \chi (G') \geq \frac{v(G')}{\alpha (G')} \geq \frac{n^{\varepsilon}}{4 \log n} > k,
\]
para todo $n$ lo suficientemente grande.
\end{proof}


\bigskip


Antes, observemos que podemos interpretar el número de Ramsey $R(3, k)$ como el mínimo $n$ tal que todo grafo $G$ con $n$ vértices libre de triángulos satisface $\alpha (G) \geq k$. En efecto, si $n = R (3,k)$, podemos considerar el grafo completo $K_n$, e incrustar $G$ en $K_n$ pintando las aristas de $G$ de color rojo, y las aristas de su complemento $\bar G$ de azul. Si $G$ es libre de triángulos, $K_n$ es libre de $K_3$-rojo, pero entonces tiene un $K_k$-azul por definición de número de Ramsey, equivalentemente, $\bar G$ contiene un $K_k$, i.e., $G$ tiene con conjunto de $k$-vértices independientes.

\begin{theorem}
Existe $c > 0$ tal que
\[
    R(3,k) \geq \left ( \frac{ck}{\log k} \right )^{\frac 3 2},
\]
para todo $k \in \naturals$ lo suficientemente grande.
\end{theorem}
\begin{proof}
Tomemos $n_k := \left ( \frac{k}{4 \log k} \right )^{\frac 3 2}$. Consideremos $\mathcal G = \mathcal G (n_k, p_{n_k})$ con $p_{n_k} := {n_k}^{-\frac 2 3}$. Notar que $p_{n_k}k = 4 \log k$. El teorema anterior dice que
\[
    \alpha (G) \leq \frac{2 \log {n_k}}{p_{n_k}} < k , \quad G\in \mathcal G
\]
con probabilidad alta $(k \to \infty)$.

Sea $X$ la variable aleatoria en $\mathcal G$ tal que $X(G)$ es el número de triángulos de $G$. Tenemos que
\[
    \mathbb{E} (X) = \binom {n_k} 3 p_{n_k}^3 \leq \frac{{n_k}^3}{6}p_{n_k}^3 = \frac {n_k} 6.
\]
Luego por la desigualdad de Markov \ref{lema:desigualdad de markov},
\[
    P(X \geq \frac {n_k} 2) \leq \frac{2}{{n_k}} \mathbb{E} (X) \leq \frac 1 3.
\]
Por lo tanto, para $k$ lo suficientemente grande, existe un grafo $G$ con $n_k$ vértices y $\alpha (G) < k$, que contiene a lo más $\frac {n_k} 2$ triángulos. Y quitando a lo más $\frac {n_k} 2$ vértice de $G$ por cada triángulo, obtenemos un grafo $G'$ con $\alpha (G') < k$, libre de triángulos y $v(G') \geq \frac {n_k} 2$. Es decir, la constante $c = 1/2^{\frac 8 3}$ funciona.
\end{proof}


\section{Método del segundo momento}

\begin{definition}
La \textbf{varianza} de una variedad aleatoria $X$ está dada por
\[
    \operatorname{Var} (X) := \mathbb{E} ((X - \mathbb{E}(X))^2).
\]
Además, definimos la \textbf{desviación estándar}:
\[
    \sigma (X) := \sqrt{\operatorname{Var}(X)}.
\]
\end{definition}

Tenemos las siguientes propieades de la varianza:
\begin{proposition}
Dada una variable aleatoria $X$, se tiene que:
\begin{enumerate}
\item $\operatorname{Var}(X) = \mathbb{E}(X^2)- \mathbb{E}(X)^2$.
\item $\operatorname{Var}(cX) = c^2 \operatorname{Var}(X)$ para toda constante $c \in \reals$.
\item Si $X_1, \ldots, X_n$ son variables aleatorias independientes, entonces
\[
    \operatorname{Var}(X_1 + \cdots + X_n) = \operatorname{Var}(X_1) + \cdots + \operatorname{Var}(X_n).
\]
\end{enumerate}
\end{proposition}

\begin{proposition}[Desigualdad de Chebyshev]\label{proposition:desigualdad de Chebyshev}
Sea $X$ una variable aleatoria y $\lambda > 0$ una constante. Entoncces
\[
    P(\abs{X - \mathbb{E}(X)} \geq \lambda) \leq \frac{\operatorname{Var}(X)}{\lambda^2}.
\]

En particular, tomando $\lambda := t \sigma (X)$ para $t > 0$,
\[
    P(\abs{X - \mathbb{E}(X)} \geq t \sigma (X)) \leq \frac{1}{t^2}.
\]
\end{proposition}
\begin{proof}
\begin{align*}
P(\abs{X - \mathbb{E}(X)} \geq \lambda)  &= P (\abs{X - \mathbb{E}(X)}^2 \geq \lambda^2) \\
&\leq \frac{\mathbb{E} ((X- \mathbb{E}(X))^2)}{\lambda^2} \\
&= \frac{\operatorname{Var}(X)}{\lambda^2}.
\end{align*}
Donde la desigualdad sale de la Desigualdad de Markov \ref{lema:desigualdad de markov}.
\end{proof}


\bigskip



Dado $A \subset \naturals$, denotamos por $\Sigma (A)$ al conjunto de todas las sumas posibles de elemntos de $A$. Notemos que
\[
    \#\Sigma (A) \leq 2^{\# A}.
\]
Diremos que $A$ tiene \textit{sumas distintas}, si
\[
    \# \Sigma (A) = 2^{\# A}.
\]
Para cada $n \in \naturals$, $A \subset [n]$. ¿Cuál será la máxima cardinalidad f(n) tal que $A$ tiene sumas distintas?

Sea $A := \Set{2^i | 0 \leq i \leq \log _2 n} \subset [n]$. Entonces $\# A \geq 1 + \floor{\log_2 (n)}$ y todas las sumas son distintas, con lo cual
\[
    f(n) \geq 1 + \floor{\log _2 n}.
\]

\begin{theorem}
Para todo $n \in \naturals$, tenemos que
\[
    f(n) \leq \log _2 n + \frac 1 2 \log _2 \log _2 n + O(1).
\]
\end{theorem}
\begin{proof}
Consideremos $A = \{a_1, \ldots, a_m\} \subset [n]$ con sumas distintas. Tomemos $X_1, \ldots, X_m$ variables aleatorias independientes con $X_i \sim \operatorname{Ber} (\frac 1 2)$. Se sigue que $\operatorname{Var}(X_i) = \frac 1 4$. Sea $X := \sum_{i = 1}^m a_i X_i$; escribamos $\mu := \mathbb{E} (X) = \sum_{i = 1}^m a_i \mathbb{E}(X_i) = \frac 1 2 \sum_{i = 1}^m a_i$; similarmente, $\operatorname{Var}(X) = \frac{1}{4} \sum_{i = 1}^m a_i^2 \leq \frac{n^2 m}{4}$, por lo tanto $\sigma(X) \leq \frac{n \sqrt m}{2}$.

Tomemos $t > 1$, por la desigualdad de Chebyshev \ref{proposition:desigualdad de Chebyshev},
\[
    P(\abs {X - \mu} \geq \underbrace{\frac{t n \sqrt m}{2}}_{\geq t \sigma (X)}) \leq \frac{1}{t^2}.
\]
Con lo cual,
\[
    P(\abs{X - \mu} < \frac{t n \sqrt m}{2}) \geq 1 - t^{-2}.
\]

Notar que
\[
    P(X = x) = \begin{cases}
    0 & \text{ si $x \not \in \Sigma (A)$} \\
    2^{-m} & \text{ si $x \in \Sigma (A)$}.
    \end{cases}
\]
Luego
\[
    P(\abs{X- \mu} < \frac{t n \sqrt m}{2}) \leq \frac{t n \sqrt m + 1}{2^m},
\]
porque las sumas son distintas. Juntando esta desigualdad con la anterior, tenemos que
\[
    \Omega (\frac{2^m}{\sqrt m}) = \frac{(1 - t^2) 2^m - 1}{t \sqrt m} \leq n.
\]
Conluyamos ahora a partir de esto que
\[
    m \leq \log_2 n + \frac 1 2 \log_2 \log_2 n + O(1),
\]
y por lo tanto $f(n) \leq \log _2 n + \frac 1 2 \log_2 \log_2 n + O(1)$ como queríamos.

En efecto, la cantidad se maximiza cuando tomamos $t = \sqrt 3$ (de todas formas no es necesario tomar este $t$, cualquier $t$ sirve). Tomando logarítmo, nos queda
\begin{align*}
\log_2 n &\geq \log_2 (2^m \cdot \frac 2 3 - 1) - \frac 1 2 \left ( \log_2 m + \log_2 3 \right) \\
    &\geq \log_2 2^{m-2} - \frac 1 2 \left ( \log_2 m + \log_2 (3) \right) \\
    &= m-2 - \frac 1 2 \log_2 m - \frac 1 2 \log_2 (3).
\end{align*}
Como $\log_2 m \leq m$,
\[
    \log_2 n \geq \frac m 2 - 2 - \frac 1 2 \log_2 3 \geq \frac m 4
\]
para $m$ lo suficientemente grande. En particular,
\[
    \log_2 \log_2 n + 2 \geq \log m
\]
para $m$ grande. Así, usando esta cota para acotar el $\log m$ en la desigualdad de arriba, nos queda
\begin{align*}
        m &\leq \log_2 n + \frac 1 2 \log _ 2 m + \log_2 \sqrt 3 + 2 \\
    &\leq \log_2 n + \frac 1 2 \log_2 \log_2 n + 3 + \log_2 \sqrt 3 \\
    &= \log_2 n + \frac 1 2 \log_2 \log_2 n + O(1).
\end{align*}
\end{proof}


\begin{conjecture}
Erdös ofreció una pequeña recompensa para la persona que pruebe
\[
    f(n) \leq \log_2 n + O(1).
\]
\end{conjecture}



\bigskip

Sean $A_1, \ldots, A_t$ eventos en un espacio probabilítico $(\Omega, p)$, escribamos $X_i := \mathbb{1}_{A_i}$ para las variables aleatorias indicadoras respectivas. Vamos a utilizar el símbolo $i \sim j$ si solo si $A_i$ y $A_j$ no son independientes e $i \neq j$. Consideremos $X := X_1 + \cdots + X_t$. Luego
\begin{align*}
\operatorname{Var} (X) &= \mathbb{E} (X^2) - \mathbb{E} (X)^2 \\
&= \sum_{i = 1}^t \sum_{j = 1}^t \mathbb{E}(X_i X_j) - \mathbb{E}(X_i) \mathbb{E}(X_j) \\
&\leq \sum_{i \sim j} P(A_i \cap A_j) + \sum_{i = 1}^t \mathbb{E} (X_i) \\
&= \mathbb{E} (X) + \Delta.
\end{align*}

\begin{proposition}
Sean $A_1, \ldots, A_t$ eventos en $(\Omega, p)$, $X_i := \mathbb{1}_{A_i}$ y $X:= X_1 + \cdots + X_t$. Si $\mathbb{E} (X) \longrightarrow + \infty$ y $\Delta = o (\mathbb{E}(X)^2)$, entonces
\[
    X > 0
\]
con probabilidad alta.
\end{proposition}
\begin{proof}
Por Chebyshev \ref{proposition:desigualdad de Chebyshev},
\begin{align*}
P(X = 0) &\leq P \left (\abs{X - \mathbb{E} (X)} \geq \frac{\mathbb{E} (X)}{2} \right ) \\
&\leq \frac{4 \operatorname{Var}(X)}{\mathbb{E}(X)^2} .
\end{align*}
Entonces,
\[
    \frac{\operatorname{Var}(X)}{\mathbb{E}(X)^2} \leq \frac{1}{\mathbb{E}(X)} + \frac{\Delta}{\mathbb{E}(X)^2} = o(1).
\]
Por lo tanto $X > 0$ con probabilidad alta.
\end{proof}

\begin{theorem}
Sea $\mathcal G = \mathcal G (n, \frac 1 2)$. Entonces
\[
    \alpha (G) = (2 + o(1)) \log_2 n, \quad G \in \mathcal G
\]
con probabilidad alta.
\end{theorem}
\begin{proof}
Fijemos $k \in [n]$, el conjunto de vértices de $\mathcal G$, y tomemos $S$ un subconjunto de vértices con $k$ elementos. Consideremos la variable aleatoria indicadora $X_S$ para el evento $e(G[S]) = 0$; escribamos $X := \sum_{S \subset [n], \: \abs S = k} X_S$. Luego
\[
    \mathbb{E}  (X) = \sum_{\substack{S \subset [n] \\ \abs{S} = k}} \mathbb{E}(X_S)  = \binom n k 2^{- \binom k 2}.
\]
Notar que $X > 0$ implica $\alpha (G) \geq k$. Luego
\begin{enumerate}[(a)]
\item $X = 0$ con prorbabilidad alta, si $k > (2 + \varepsilon) \log_2 n$.
\item $X > 0$ con probabilidad alta, si $k < (2- \varepsilon) \log _2 n$.
\end{enumerate}
Por la desigualdad de Markov \ref{lema:desigualdad de markov},
\begin{enumerate}[(a)]
\item
\begin{align*}
P(X \geq 1) &\leq \mathbb{E} (X ) \\
&= \binom n k 2^{-k (k-1)/2} \\
&\leq \left ( n \cdot 2^{- (k-1)/2} \right)^k \\
&\leq \left ( n \cdot n^{-1 - \frac \varepsilon 2} \cdot \sqrt 2 \right )^k \\
&= n^{-\frac \varepsilon 2 \cdot k} (\sqrt 2 )^k \\
&= o(1).
\end{align*}
\item Ahora,
\begin{align*}
\mathbb{E}[X] &= \binom n k \cdot 2^{- \binom k 2} \\
&\geq \left ( \frac n k \right )^k \cdot 2^{- \binom k 2} \\
& \geq \left ( \frac n k \right )^k \cdot n^{-k ( 1 - \varepsilon /2)} \\
& \geq \left ( \frac n k \right )^k \cdot \frac{1}{n^{k ( 1 - \varepsilon /2)}}
\end{align*}
Que tiene a infinito cuando $n$ tiende a infinito.

Si $\Delta = \sum_{S \sim T} P (X_S X_T \geq 1)$ con $S,T$ subconjuntos de vértices de tamaño $k$; $2 \leq \abs{S \cap T} \leq k-1$. Así
\begin{align*}
\Delta &= \sum_{i = 2}^{k-1} \binom n k \binom k i \binom {n-k}{k-i} 2^{\binom i 2 - 2 \binom k 2} \\
&= \mathbb{E}(X)^2 \sum_{i = 2}^{k-1} g (i),
\end{align*}
donde $g(i) := \frac{\binom {n-k}{k-i} \binom k i 2^{\binom i 2}}{\binom n k} = o(n^{-1})$.
Consecuentemente,
\[
    \frac{\Delta}{\mathbb{E}(X)^2} = \sum_{i = 2}^{k-1} g(i) = o ((k-2) n^{-1} )= o(1),
\]
y por lo tanto la proposición anterior implica que $X > 0$ con probabilidad alta.
\end{enumerate}

Así, $\alpha (G) = (2 + o(1))  \log_2 n$ con probabilidad alta en $G \in \mathcal G$ cuando $n \to \infty$.


\end{proof}

\begin{corollary}\label{corolario:cota inferior para el numero cromatico del grafo aleatorio con p = 1/2 es la mitad de n /log2n}
Sea $\mathcal G = \mathcal G(n, \frac 1 2)$. Entonces
\[
\chi (G) \geq \left (\frac 1 {2} + o(1) \right ) \frac{n}{\log_2 n}
\]
con probabilidad alta.
\end{corollary}
\begin{proof}
Se deduce de lo anterior junto con la identidad general para grafos
\[
    \chi (G) \geq \frac{n}{\alpha(G)}.
\]
\end{proof}


\section{Método de concentración}



\begin{proposition}[Desigualdad de Chernoff]\label{proposition:desigualdad de chernoff}
Si $\varepsilon \in [0, 1]$ y $X$ una variable aleatoria binomial con media $\mu$. Entonces
\[
    P (\abs{X - \mu} \geq \varepsilon \mu) \leq 2 e^{\frac{-\varepsilon^2 \mu}{3}}.
\]
\end{proposition}

\begin{definition}
$\hat r (H_1,H_2) = \min \set{e(G) | G \longrightarrow (H_1,H_2)}$. En particular, escribimos $\hat r (H)$ para $\hat r (H,H)$.
\end{definition}

\begin{theorem}[Beck, 1983]\label{th:teorema de Beck}
Existe una constante $c > 0$ tal que
\[
    \hat r (P_k) \leq c \cdot k
\]
para todo $k \in \naturals$.
\end{theorem}


\begin{lemma}
Sea $c > 0$, y sea $\mathcal G = \mathcal G (n,p)$ con $p = \frac c n$ para $n$ lo suficientemente grande. Entonces
\[
    P\left (\{G \in \mathcal G | e(G) \geq p n^2\} \right ) \leq 2e^{- c \frac {n-1} 8}.
\]
\end{lemma}
\begin{proof}
Sabemos que la variable aleatoria que cuenta el número de aristas $e(\cdot) $ en $\mathcal G$ tiene distribución $\operatorname{Bin} (\binom n 2 , p)$. Notar que su $\mu = p \binom n2$. Como $\abs {e(G) - \mu} \geq \mu$ si y solo si $e(G) \geq 2 \mu$, tenemos que por la desigualdad de Chernoff \ref{proposition:desigualdad de chernoff} con $\varepsilon = 1$:
\begin{align*}
P(e(\cdot) \geq p n^2) &\leq P (e(\cdot ) \geq 2 \mu) \\
&= P(\abs{e(\cdot) - \mu} \geq \mu)  \\
&\leq 2 e^{- \frac \mu 3} \\
&\leq 2 e^{- p \frac{n (n-1)}{8}} \\
&= 2e^{- c \frac {n-1} 8}.
\end{align*}
\end{proof}


\begin{lemma}
Sea $c > 0$, y sea $\mathcal G = \mathcal G (n,p)$ con $p = \frac c n$ y $n$ lo suficientemente grande. Entonces con probabilidad alta,
\[
    e(X,Y) \geq 1
\]
para cada par de subconjuntos de vértices $X,Y$ de $\mathcal G$, disjuntos con $\abs X \geq \abs Y \geq 3 c^{-\frac 1 2} n$.
\end{lemma}
\begin{proof}
Dados $X,Y$ subconjuntos de vértices de $\mathcal G$, disjuntos. Notar que la variable aleatoria $e(X,Y)$ (que depende de $G \in \mathcal G$) tiene distribución $\operatorname{Bin}(\abs X \abs Y, p)$, en particular $\mu = p \abs X \abs Y$. Por la desigualdad de Chernoff \ref{proposition:desigualdad de chernoff} con $\varepsilon = 1$, si $\abs X \geq \abs Y \geq 3 c^{-\frac 1 2}n$, se tiene que
\begin{align*}
P(e(X,Y) = 0) &\leq P(\abs{e(X,Y) -  \mu} \geq \mu) \\
&\leq 2 e^{- \frac \mu 3} \\
&= 2 e^{-p \frac{\abs X \abs Y}{3}} \\
&\leq 2 e^{-p \frac{9 c^{-1} n^2}{3}} \\
&\leq 2 e^{- 3 n}  \longrightarrow 0 \quad (n \to \infty).
\end{align*}
Así, tenemos un total de a lo más $2^n \cdot 2^n = 4^n$ formas de escoger $X$ e $Y$, con lo cual la probabilidad de que haya un par $X,Y$ con $e(X,Y) = 0$ es a lo más
\[
    4^{n+1} e^{-3n} = 2e^{-n} \left (\frac 4 {e^2} \right)^n \longrightarrow 0 \quad (n \to \infty).
\]
De donde se sigue lo que queríamos.
\end{proof}


Ahora estamos en condiciones de probar el teorema principal de esta sección:

\begin{proof}[Demostración del teorema]
Sea $c > 0$ lo suficientemente grande, y luego en función de esta constante tomemos $a>0$ lo suficientemente grande. Consideremos $n = a \cdot k$ y $C = a \cdot c$. Aplicamos ambos lemas de arriba con $p = \frac c n$. Luego existe un grafo $G \in \mathcal G (n,p)$ con $n$ vértices y
\[
    e(G) \leq pn^2 = C \cdot k  .
\]
Además, por el segundo lema, para todo $X,Y \subset V(G)$ disjuntos con $\abs X \geq \abs Y \geq 3 c^{- \frac 1 2}n$, se tiene que $e(X,Y) \geq 1$.

Ahora veremos que $G \longrightarrow (P_k, P_k)$ para cualquier coloración de las aristas. Supongamos por el absurdo que $G$ no tiene una $2$-coloración de aristas con un $P_k$ monocromático. Consideremos el siguiente algorítmo, que nos permite encontrar una partición $V(G) = A \coprod X \coprod Y$ tal que no hay $(X,Y)$-aristas rojas:
\begin{enumerate}
\item empezamos con $A = X = \emptyset$ e $Y = V(G)$;
\item
\begin{enumerate}[(a)]
\item si $A = \emptyset$, escogemos cualquier vértice $u \in Y$ y lo muevo a $A$.
\item si $A \neq \emptyset$, tomamos $v \in A$, el último que hemos agregado a $A$. Si existe $u \in Y$ tal que $v u$ es una arista azul, agregamos $u$ a $A$. Si no, movemos $v$ a $X$.
\end{enumerate}
\item si $\abs X = \abs Y$ terminamos, si no volvemos al paso 2.
\end{enumerate}

Eventualmente este algortimo termina, pues en cada paso $\abs Y - \abs X$ disminuye en una unidad. Después, observemos que $A$ forma un camino azul, por lo tanto $\abs A \leq k$. Más aún,
\[
    \abs X + \abs Y = n - \abs A \geq n - k = k (a-1).
\]
Consecuentemente, $\abs X = \abs Y \geq \frac {k (a-1)}{2}$.

Análogamente, podemos repetir el mismo proceso para el caso de aristas rojas: partimos $V(G) = A' \coprod X' \coprod Y'$ con $A'$ conteniendo un camino rojo y por lo tanto $\abs {A'} \leq k$, $\abs{X'} = \abs{Y'} \geq \frac{k(a-1)}{2}$, y no hay $(X',Y')$-aristas azules.

Consideremos los conjuntos
\begin{align*}
\mathcal P_1 &= \{(X,X'), (Y,Y')\}, \\
\mathcal P_2 &= \{(X,Y'), (Y, X')\},
\end{align*}
de pares de partes de $V(G)$ obtenidas arriba. Afirmamos que existe $i = 1,2$ tal que
\[
    \abs{U \cap W} \geq \frac{k (a-3)}{4}
\]
para todo par $(U,V)$ en $\mathcal P_i$. En efecto, si esto no fuera cierto, podríamos encontrar un par en $\mathcal P_1$ y otro en $\mathcal P_2$, digamos $X \cap X'$ y $X \cap Y'$, tales que las intersecciones son menores que $\frac{k(a-3)}4$, con lo cual,
\begin{align*}
\frac{k(a-3)}{2} > \abs{X \cap X'} + ¸\abs{X \cap Y'} &\geq \abs X - \abs{A'} \\
&\geq \frac{k(a-1)}{2} - k \\
&= \frac{k(a-3)}{2},
\end{align*}
absurdo.

Finalmente, por la afirmación de recién, consideremos sin perdida de generalidad, que $X \cap X'$ e $Y \cap Y'$ son subconjuntos de $V(G)$ de tamaño almenos $\frac{k(a-3)}{4}$. Notar que son disjuntos entre sí, además,
\[
    \frac{k(a-3)}{4} \geq 3 c^{-\frac 1 2} n,
\]
llegando a una contradicción, porque el segundo lema implica que tiene que haber almenos una arista entre ambos conjuntos, la cual es roja o azul, pero las particiones obtenidas en el algorítmo no lo permiten.
\end{proof}



\begin{remark}
Dedek y Pralat en 2017 probaron
\[
    \hat r (P_k) \leq 74 k.
\]
Por otro lado, Bal y DeBiasio probaron
\[
    \left ( \frac {15} 4 + o(1) \right ) k \leq \hat r (P_k).
\]
\end{remark}


\section{Grafos aleatorios}

\begin{theorem}
Si $p_n = o(\frac 1 n)$, entonces
\[
    P(K_3 \subset \mathcal G (n,p_n)) \longrightarrow 0 \quad (n \to \infty).
\]
\end{theorem}
\begin{proof}
Consideremos la variable aleatoria $X$ en $\mathcal G = \mathcal G(n,p_n)$ tal que $X(G)$ es el número de triángulos en $G$. Notar que $P(K_3 \subset \mathcal G) = P(X \geq 1)$. Ahora, podemos formar $\binom n 3$ triángulos con los vértices $V$ de $\mathcal G$, y la probabilidad de que uno de estos triángulos esté en $G \in \mathcal G$ es $p^3_n$. Consecuentemente,
\[
    \mathbb{E} (X) = p^3_n \binom n 3 \leq (p_nn)^3 \longrightarrow 0 \quad (n \to \infty).
\]
Así, la desigualdad de Markov \ref{lema:desigualdad de markov} implica
\[
    P(X \geq 1) \leq \mathbb{E} (X) \longrightarrow 0 \quad (n \to \infty).
\]
\end{proof}

\begin{theorem}
Si $p_n \gg \frac 1 n$, entonces
\[
    P (K_3 \subset \mathcal G (n, p_n)) \longrightarrow 1 \quad (n \to \infty).
\]
\end{theorem}

\begin{proof}

Escribamos $p := p_n$. Como antes consideremos la variable aleatoria $X$ en $\mathcal G := \mathcal G (n,p)$ que cuenta la cantidad de triángulos en un grafo. Tenemos que $\mathbb{E}(X) = p^3 \binom n 3 \geq \left ( \frac{pn}{3} \right )^3 \rightarrow \infty$ cuando $n$ tiende a infinito.

Precisamos ahora estimar la varianza de $X$. Para eso escribimos $X = \sum_{\tau} X_\tau$ como la sumatoria de todas las variables aleatorias indicadoras de los $\binom n 3$ triángulos $\tau$. Se tiene que
\[
    \operatorname{Var} \left ( \sum_{\tau} X_\tau \right ) = \sum_{\tau_i , \tau_j} \operatorname{Cov} (X_{\tau_i}, X_{\tau_j}).
\]
Notar que la covarianza es cero si $\tau_i, \tau_j$ no comparten aristas (las variables son independientes); si comparten una sola arista, la covarianza es:
\[
    \mathbb{E} (X_{\tau_1} X_{\tau_2}) - \mathbb{E} (X_{\tau_1}) \mathbb{E} (X_{\tau_2}) = p^5 - p^6;
\]
y si comparten todas las aristas, la covarianza es $p^3-p^6$. Juntando esto, tenemos que
\begin{align*}
\operatorname{Var} (X) &= \sum_{\abs{\tau_i \cap \tau_j} = 1} p^5 - p^6 + \sum_{\abs{\tau_i \cap \tau_j} = 3} p^3 - p^6 \\
&= 2 \binom n 4 (p^5-p^6) + \binom n 3 (p^3 - p^6) \\
&\sim n^4 (p^5-p^6) + n^3 (p^3 - p^6).
\end{align*}

Finalmente, como
\[
    \left \{ \sum_{\tau} X_\tau = 0\right\} \subset \left \{ \abs {\sum_\tau X_\tau - \mathbb{E} (X)}  \geq \mathbb{E} (X) \right\},
\]
podemos deducir que
\begin{align*}
P\left ( \sum_{\tau} X_\tau = 0 \right ) &\leq P \left ( \abs{\sum_\tau X_\tau - \mathbb{E} (X)} \geq \mathbb{E} (X) \right) \\
&\leq \frac{\operatorname{Var} (X)}{\mathbb{E} (X)^2} \quad (\text{Desigualdad de Chebyshev \ref{proposition:desigualdad de Chebyshev}}) \\
&\sim \frac{n^4 (p^5 - p^6) + n^3 (p^3 - p^6)}{(pn)^6} \\
&= \frac{1}{n^2 p} - \frac{1}{n^2} + \frac{1}{n^3p^3} - \frac{1}{n^3} \longrightarrow 0 \quad (n \to \infty)
\end{align*}
\end{proof}






\section{Conexidad de grafos aleatorios}

\begin{theorem}
Sea $\mathcal G (n, p_n) =: \mathcal G$ con $p_n := \frac{c \log n}{n}$, entonces
\[
    P ( G \in \mathcal G | G \text{ es conexo}) = \begin{cases}
    0 & \text{ si $c < 1$} \\
    1 & \text{ si $c > 1$}
    \end{cases} \quad (n \to \infty).
\]
\end{theorem}
\begin{proof}
Sea $X_\mu$ la variable aleatoria indicadora de si $\mu$ es un vértice aislado. Definamos $N := \sum_{\mu \in V(G)} X_\mu$. Notar que si $N \geq 1$, entonces $G$ no es conexo. Tenemos que
\begin{align*}
\mathbb{E} (X_\mu) &= P ( \mu \text{ es aislado}) = (1- p_n)^{n-1} \\
\mathbb{E} (N) &= n (1-p_n)^{n-1}.
\end{align*}
Observar que
\begin{align*}
(1-p_n)^{n-1} &= e^{(n-1) \log (1- p_n)} \\
&\sim e^{-(n-1) p_n}  \quad (\log (1 + x) = x + O(x^2) \text{ cuando $x \to 0$})\\
&\sim e^{-n p_n}
\end{align*}
cuando $n \to \infty$. Por lo tanto,
\begin{align*}
\mathbb{E} (N) &= n (1-p_n)^{n-1} \\
&\sim n e^{- c \log n} \\
&= n e^{\log n^{-c}} \\
&= n^{1-c}
\end{align*}
cuando $n \to \infty$.

Ahora, calculamos la varianza de $N$. Antes, notar que
\[
    \mathbb{E} (X_\mu \cdot X_\nu) = P (\mu \text{ y } \nu \text{ son aislados}) = (1-p_n)^{2n-3},
\]
pues para que sean aislados, no pueden estar las $2n-3$ aristas incidentes a $\mu$ y $\nu$ (hay $n-2$ vértices distintos de $\mu, \nu$ y luego una arista entre ellos; ver la siguiente figura).

 \Inkscape{}{"./Figuras/Conexidad-de-grafos-aleatorios/Dibujo-1.pdf_tex"}


Si $\mu \neq \nu$:
\begin{align*}
\operatorname{Cov} (X_\mu, X_\nu) &= \mathbb{E} (X_\mu, X_\nu) - \mathbb{E} (X_\mu) \mathbb{E} (X_\nu) \\
&= (1-p_n)^{2n-3} - (1-p_n)^{2(n-1)} \\
&= p_n (1-p_n)^{2n-3}.
\end{align*}
Y si $\mu = \nu$:
\begin{align*}
\operatorname{Cov} (X_\mu , X_\nu) &= \operatorname{Var} (X_\mu) \\
&= \mathbb{E} (X_\mu^2) - \mathbb{E}(X_\mu)^2\\
&= \mathbb{E} (X_\mu) - \mathbb{E} (X_\mu)^2 \\
&= (1-p_n)^{n-1} - (1-p_n)^{2(n-1)}.
\end{align*}
Como $p_n = \frac{c \log n}{n}$, para $\mu \neq \nu$:
\begin{align*}
\operatorname{Cov} (X_\mu, X_\nu) &= \frac{c \log n}{n} (1 - \frac{c \log n}{n} )^{2n - 3 } \\
&\leq \frac{c \log n}{n} e^{-c \frac{\log n}{n} (2n-3)}  \quad (1 + x \leq e^x) \\
&\sim \frac{c \log n}{n} e^{- \log (n^{-2c})} \\
&= \frac{c\log n}{n} n^{-2 c} \\
&= c \log n n^{-1 - 2 c}.
\end{align*}
Por otro lado (de manera similar), para $\mu = \nu$:
\[
    \operatorname{Var} (X_\mu) = (1- \frac{c\log n}{n})^{n-1} - (1- \frac{c \log n }{n})^{2(n-1)} \sim n^{-c} - n^{-2c}.
\]
Juntando todo:
\begin{align*}
\operatorname{Var} (N) &= \sum_{\mu \neq \nu} \operatorname{Cov} (X_\mu, X_\nu) + \sum_{\mu} \operatorname{Var} (X_\mu) \\
&\lesssim \binom n 2 cn^{-1 -2 c} \log n + n n^{-c} (1- n^{-c}) \\
&\leq \frac c 2 n^{1-2c} \log n + n^{1-c} (1-n^{-c}).
\end{align*}

Gracias a esto, si $c < 1$,
\begin{align*}
P(N = 0) \leq P(\abs{N - \mathbb{E} (N)} \geq \mathbb{E} (N)) &\leq \frac{\operatorname{Var} (N)}{\mathbb{E} (N)^2} \quad (\text{desigualdad de Chebyshev \ref{proposition:desigualdad de Chebyshev}}) \\
&\lesssim \frac{\frac c 2 n^{1-2c} \log n + n^{1-c} (1- \frac 1 {n^c})}{n^{2-2c}} \\
&= \frac{c}{2} n^{-1} \log n + \frac {1 - n^{-c}}{n^{1-c}} \longrightarrow 0 \quad (n \to \infty).
\end{align*}
Es decir, cuando $c < 1$, la probabilidad de que haya un vértice aislado en $G$ tiende a $1$, i.e.,
\[
    P ( G \in \mathcal G | G \text{ es conexo}) \longrightarrow 0 \quad (n \to \infty).
\]

\bigskip


Finalmente para probar que la probabilidad de que $G$ sea conexo tiende a $1$ cuando $c >1$, probaremos la afirmación equivalente: la probabilidad de que exista un conjunto de $k$-vértices independientes, con $1 \leq k \leq \floor{\frac n 2}$, tiende a cero. Sea $S_k$ un conjunto de $k$-vértices; definimos la variable aleatoria indicadora $X_{S_k}$ que dice si $S_k$ está aislado, i.e., $E(S_k, \bar{S_k}) = \emptyset$. Tenemos que
\[
    \mathbb{E} (X_{S_k}) \leq (1 - p_n)^{k (n-k)} ,
\]
y por lo tanto,
\[
    P( G \text{ disconexo}) \leq \sum_{k = 1}^{\floor{\frac n 2}} \binom n k \mathbb{E}(X_{S_k}).
\]
Como el último término ya vimos que tiende a cero cuando $c > 1$, basta estimar la sumatoria. Ahora,
\begin{align*}
\sum_{k = 2}^{\floor{\frac n 2}} \binom n k \mathbb{E} (X_{S_k}) &\leq \sum_{k = 2}^{\floor{\frac n 2}} \left (\frac{ne}{k} (1-p_n)^{n-k} \right )^k \\
&\leq \sum_{k = 2}^{\floor{\frac n 2}} \left (\frac{ne}{k} e^{-p_n(n-k)} \right )^k \\
&= \sum_{k = 2}^{\floor{\frac n 2}} \left ( \frac{n e}{k} n^{- \frac c n (n-k)} \right )^k \\
&= \sum_{k = 2}^{\floor{\frac n 2}}  \frac{ e^k}{k^k} n^{(1- c)k +  \frac{c k^2}{n}}.
\end{align*}
Para estimar esta sumatoria, notemos que como la función cuadrática $f(x) := (1-c)x - \frac{c x^2}{n}$ alcanza el máximo en $x = \frac{(1-c)n}{2c}$, luego
\begin{align*}
\sum_{k = 2}^{\floor{\frac n 2}} \frac{ e^k}{k^k} n^{(1- c)k +  \frac{c k^2}{n}} &= \frac{e^2}{2^2} n^{(1-c) 2 + \frac{c 2^2}{n}} + \frac{e^3}{3^3} n^{(1-c) 2 + c\frac{3^3}{n}}  + \sum_{k = 4}^{\floor{\frac n 2}} \frac{ e^k}{k^k} n^{(1- c)k +  \frac{c k^2}{n}} \\
&\leq \frac{e^2}{2^2} n^{(1-c) 2 + \frac{c 2^2}{n}} + \frac{e^3}{3^3} n^{(1-c) 2 + c\frac{3^3}{n}}  + n^{\frac{3 (1-c)^2}{4 c}n} \sum_{k = 4}^{\floor{\frac n 2}} \frac{ e^k}{k^k}\\
&\leq \frac{e^2}{2^2} n^{(1-c) 2 + \frac{c 2^2}{n}} + \frac{e^3}{3^3} n^{(1-c) 2 + c\frac{3^3}{n}}  + n^{\frac{3 (1-c)^2}{4 c}n} \sum_{k = 0}^{\infty} \left ( \frac{ e}{4} \right)^k .
\end{align*}
Los primeros dos términos tienden a cero cuando $n$ tiende a infinito; el último término término también, pues la serie geométrica converge a una constante que no depende de $n$.

\end{proof}





\section{Grafos de dependencia}

\begin{definition}
Sea $(\Omega, P)$ un espacio probabilístico y $A \subset \mathcal P (\Omega)$ un subconjunto de finitos eventos $\mathcal A = \{A_1, \ldots, A_n\}$. Un \textbf{grafo de dependencia} es un grafo con conjunto de vértices $\mathcal A$ cuyas aristas cumplen que para todo $A\in \mathcal A$, el complemento del vecindario $N_G (A)$ consiste de eventos mutuamente independientes respecto de $P$.
\end{definition}

\begin{lemma}[Lovász]\label{lema:lovasz sobre grafo de dependencia}
Sea $G$ un grafo de dependencia para un subconjunto de eventos $\mathcal A$, tal que
\[
    P(A) \leq \frac{1}{e (\Delta (G) + 1)}
\]
para todo $A \in \mathcal A$, entonces
\[
    P(\bigcap_{A \in \mathcal A} A^c) > 0.
\]
\end{lemma}

Recordemos que todo hypergrafo $k$-uniforme es $2$-coloreable si tiene menos de $2^{k-1}$ aristas.

\begin{theorem}
Si $\mathcal H$ es un hypergrafo $k$-uniforme con $\Delta (\mathcal H) =d$. Entonces
\[
    d \leq \frac{2^{k-1}}{ek} - \frac 1 k \quad \Longrightarrow \quad \chi (\mathcal H) = 2.
\]
\end{theorem}
\begin{proof}
Consideremos $c$ una $2$-coloración aleatoria. Para $e \in E(\mathcal H)$, consideremos los eventos $A_e = $``$e$ es monocromático''. Consideremos el grafo de dependencia
\[
    G := \left ( \bigcup_{e \in E (\mathcal H)} A_e, \bigcup_{e,f \in E(\mathcal H)} \{ A_e A_f | e \cap f \neq \emptyset \}\right ).
\]
Observar que $\Delta (G) \leq kd$. Por hipótesis,
\[
    P(A_e) = 2^{1-k} \leq \frac{1}{e (kd + 1)},
\]
y luego el lema anterior implica que
\[
    P (\bigcap_{e \in E (\mathcal H)} A_e^c) >0.
\]
Así probamos el resultado.
\end{proof}


\begin{definition}
Denotaremos por $\omega (r,k)$ al menor $n \in \naturals$ tal que toda $r$-coloración de $[n]$ tiene una $k$-progresión aritmética monocromática.
\end{definition}

\begin{obs}
\[
    \left ( (k-1) r^{k-1} \right )^{\frac 1 2} \leq \omega (r,k) \leq \frac{r^2}{k-1}.
\]
\end{obs}

\begin{theorem}
Dados $r,k \in \naturals$, se tiene que
\[
    \omega (r,k) > \frac{(k-1)r^{k-1}}{e k^2} - \frac {k-1} {k^2}.
\]
\end{theorem}
\begin{proof}
Sea $c : [n] \to [n]$ una $r$-coloración aleatoria. Para una $k$-progresión aritmética $p$, definimos el evento $A_p = $``$p$ es monocromático'', luego consideremos el grafo de dependencia
\[
    G := \left ( \bigcup_{p} A_p , \bigcup_{p, q} \{A_p A_q | p \cap q \neq \emptyset\} \right ).
\]
Como $\Delta (G) \leq nk^2 / (k-1)$, y $P(A_p) = r^{1-k} \leq \frac{1}{e (\Delta (G) +1)}$ si $n \leq \frac{(k-1)r^{k-1}}{e k^2} - \frac {k-1} {k^2}$, el Lema local de Lovász \ref{lema:lovasz sobre grafo de dependencia} implica que
\[
    P(\bigcap_{p} A_p^c) > 0,
\]
es decir, existe una $r$-coloración $c$ para cualquier $n \leq \frac{(k-1)r^{k-1}}{e k^2} - \frac {k-1} {k^2}$, que es libre de $k$-progresiónes aritméticas monocromáticas. De aquí se obtiene el resultado.
\end{proof}

\begin{theorem}[Spencer, 1975]
\[
    R(k) \geq (1 + o(1)) \frac{\sqrt 2}{e} k 2^{\frac k 2}.
\]

\end{theorem}
\begin{proof}
Tomamos $K_n$ y una $2$-coloración aleatoria. A todo $K_k \cong S \subset K_n$ le asociamos el evento $A_S = $``$S$ es monocromático'', y luego construimos el grafo de dependencia
\[
    G:= \left ( \bigcup_S A_S, \bigcup_{S,T} \{A_S A_T | e(S \cap  T) \geq 1\} \right ).
\]
Notar que $P(A_S) = 2^{- \binom k 2}$, y que $\Delta (G) \leq \binom k 2 \binom{n-2}{k-2} \leq \frac{k^4}{n^2}\binom n k$.

Si $n = (1 + \varepsilon) \frac{k \sqrt 2}{e} 2^{\frac k 2}$, se sigue que
\[
    \binom n k 2^{- \binom k 2} \leq \left ( \frac{e n}{k} 2^{- \frac {k-1}2} \right )^k = (1 + \varepsilon)^k \ll \frac{n^2}{k^4} \quad (k \to \infty),
\]
equivalentemente, $\frac{k^4}{n^2} \binom n k 2^{- \frac k 2} \ll 1$.
Así,
\[
    P(A_S) = 2^{- \binom k 2} \ll \frac{1}{e \left ( \frac{k^4}{n^2} \binom n k +  1 \right )}.
\]
Finalmente, el Lema de Lovász \ref{lema:lovasz sobre grafo de dependencia} implica que lo que queremos.
\end{proof}


\begin{lemma}[Lema local de Lovász asimétrico]\label{lema:lema local asimetrica}
Sea $G$ un grafo de dependencia en $\mathcal A = \{A_1, \ldots, A_n\} \subset \mathcal P (\Omega)$. Si existen $x_i \in [0, 1)$ tales que
\[
    P(A_i) \leq x_i \prod_{A_i A_j \in E(\mathcal G)} (1 - x_j)
\]
para todo $i \in [n]$, entonces
\[
    P (\bigcap_{i \in [n]} A_i^c) \geq \prod_{i \in [n]} (1-x_i) > 0
\]
\end{lemma}

\begin{theorem}
Existe una constante $c > 0$ tal que
\[
    R(3, k) \geq \frac{c k^2}{\log^2 k}, \quad \forall k \geq 3.
\]
\end{theorem}
\begin{proof}
Sea $\varepsilon > 0$ lo suficientemente chico y tomemos $n = \frac{\varepsilon^{-4} k ^2}{\log^2 k}$ y $p = \frac{\varepsilon}{\sqrt n}$. Para todo $S \subset K_n$ con $S \cong K_3$, definimos $A_S = \{ S \subset \mathcal G (n,p)\}$ y para todo $T \subset K_n$, $T \cong K_r$, con $B_T := \{ T \cap \mathcal G (n,p) = \emptyset\}$. Basta ver que
\[
    P (\bigcap_{S \cong K_3} A_S \cap \bigcap_{T \cong K_r} B_T) > 0.
\]

Consideremos $\mathcal A$ el conjunto de los $K_3$ en $K_n$ y $\mathcal B$ el conjunto de los $K_k$ en $K_n$. Consideremos el grafo de dependencia
\[
    G = ( \mathcal A \cup \mathcal B, E),
\]
donde $\{A, B\} \in E$ si $A$ y $B$ comparten almenos una arista. Notar que todo $S \in \mathcal A$ tiene $\leq 3n$ vecinos en $\mathcal A$ y $\leq 3n^{k-2}$ vecinos en $\mathcal B$; por otro lado, $T \in \mathcal B$ tiene $\leq k^2 n$ vecinos en $\mathcal A$ y $\leq k^2 n^{k-2}$ vecinos en $\mathcal B$. Tomemos las cantidades $x_S = 2p^3$ y $x_T = n^{-k}$ para $S \in \mathcal A$ y $T \in \mathcal B$. Tenemos que
\begin{align*}
P(A_S) = p^3 &\leq 2 p^3 (1-2p^3)^{3n} (1-n^{-k})^{3 n^{k-2}} \quad (\varepsilon \to 0^+)\\
&\leq x_S \prod_{S U \in E(G)} (1- X_U),
\end{align*}
y
\begin{align*}
    P(B_T) = (1-p)^{\binom k 2} \leq \exp \left (- p \binom k 2 \right ) &= \exp (- \varepsilon^{-1} \log k (k-1)/2) \\
    &= k^{-\varepsilon^{-1} (k-1)/2} \\
    &< n^{-k}(1-2 p^3)^{k^2n} (1- n^{-k})^{k^2 n^{k-2}} \quad (\varepsilon \to 0^+)\\
    &\leq x_T \prod_{T U \in E(G)} (1-X_U).
\end{align*}
Luego por el Lema local de Lovász asimétrico \ref{lema:lema local asimetrica}, existe $G \in \mathcal G (n,p)$ que no contiene copias de $K_3$ ni conjuntos independientes de más de $k$ vértices. Por lo tanto se sigue el resultado.
\end{proof}





\section{Grafos $K_3$ libres}

\begin{definition}
    $E \subset \{0,1\}^n$ es \textbf{creciente} si
    \[
    x \in E \quad \text y \quad x \leq y \quad \Longrightarrow \quad y \in E.
    \]
    Donde tomamos el orden parcial $\leq$ en los vectores dada por el orden coordenada a coordenada.

    Similarmente podemos definir que $E$ sea \textbf{decreciente}.

\end{definition}

\begin{lemma}[Harris]
Sean $\{x_i\}_{i \in [n]}$ e $\{y_i\}_{i \in [n]}$ \textit{muestras aleatorias} de $\{0,1\}$ escogidas independientemente con probabilidad
\[
P (x_i = 1) = P (y_i = 1) = p.
\]
Si $E, F \subset \{0,1\}^n$ son ambas crecientes o decrecientes y $p > 0$, entonces
\[
P(E \cap F) \geq P(E) P(F).
\]

De manera opuesta, si una es creciente y la otra decreciente, entonces
\[
    P(E \cap F) \leq P (E) P (F).
\]
\end{lemma}

\begin{proposition}\label{proposicion:probabilidad de que un grafo aleatorio contenga un triangulo}
Si $c > 0$ y $p = \frac c n$,
\[
P (K_3 \subset \mathcal G (n, p)) \leq 1 - e^{- c^3/6} + o(1) \quad (n \to \infty).
\]
\end{proposition}
\begin{proof}
Sean $A_i$ los eventos indicadores asociados al $i$-ésimo triángulo $T_i \subset [n]$. Podemos pensar $A_i \subset \{0,1\}^{\binom n 2}$. Notar que $A_i$ es creciente, por lo tanto $A_i^c$ es decreciente, y que $P (A_i) = p^3$. Sea $m := \binom n 3$. Por el lema de arriba:
\[
P(K_3 \not \subset \mathcal G (n,p)) = P (\bigcap_{i = 1}^m A_i^c) \geq \prod_{i = 1}^m P(A_i^c) = (1- p^3)^m \longrightarrow e^{-c^3 / 6} \quad (n \to \infty)
\].
\end{proof}



\subsection{Desigualdades de Jason}

Sean $ T_1, \ldots, T_t \subset [N]$ y $p \in (0,1)$, y sea $R \subset [N]$ un conjunto aleatorio tal que $P( x \in R) = p_1 , \: x \in [N]$. Definamos los eventos $A_i = \{T_i \subset R\}$. Notar que $A_i$ es creciente. Escribamos $i \sim j$ si $T_i \cap T_j \neq \emptyset$ e $i \neq j$. Observar que si $i \not \sim j$ entonces $A_i$ y $A_j$ son independientes entre sí. Escribamos
\[
\mu = \sum_i P(A_i) \quad \text y \quad \Delta = \sum_{i \sim j} P (A_i \cap A_j).
\]

\begin{lemma}[Desigualdades de Jason]
\[
    P (\bigcap_{i \in [t]} A_i^c) \leq \exp (- \mu + \Delta / 2).
\]
Además, si $\Delta \geq \mu$, entonces
\[
P (\bigcap_{ i \in [t]} A_i^c) \leq \exp ( - \frac{\mu^2}{2 \Delta}).
\]
\end{lemma}

Daremos otra demostración de la Proposición \ref{proposicion:probabilidad de que un grafo aleatorio contenga un triangulo}:

\begin{proof}
    Tomemos $N = \binom n 2$ y una biyección entre $[N]$ y las aristas de $K_n$ de modo que el conjunto aleatorio $R$ sea mapeado en $\mathcal G (n, p)$. Si $\{T_i\}$ son los distintos triángulos en $[n]$, la primera desigualdad de Jason implica que
    \[
        P (K_3 \not \subset \mathcal G (n, p)) \leq e^{- \mu + \Delta / 2},
    \]
    donde $\mu = p^3 \binom n 3 \to c^3 / 6$ y $\Delta \leq p^5 n^4 \to 0$.
\end{proof}


\begin{lemma}
Si $\varepsilon > 0$ y $m \geq \frac{n}{\log ^2_2 n}$, entonces
\[
    P (\alpha (\mathcal G (n, 1/2)) < (2 - \varepsilon) \log_2 n) \leq \exp \left ( \frac{-n^2}{\log^9_2 n} \right )
\]
para todo $n$ lo suficientemente grande.
\end{lemma}

\begin{theorem}
Con probabilidad alta,
\[
    \chi (\mathcal G (n, 1/2)) = \left (\frac 1 2 + o(1) \right ) \frac{n}{\log_2 n}
\]
cuando $n \to \infty$.
\end{theorem}

\begin{proof}
Por un lado, el Corolario \ref{corolario:cota inferior para el numero cromatico del grafo aleatorio con p = 1/2 es la mitad de n /log2n} nos da la primera desigualdad:
\[
\chi (\mathcal G (n, 1/2)) \geq \left (\frac 1 2 + o(1) \right )
\frac{n}{\log_2 n}.
\]

Por otro lado, el lema anterior implica que el número esperado de subconjuntos al menos $\frac n {\log^2_2 n}$ vértices en $\mathcal G (n, 1/2)$ con al menos $\frac n {\log^2_2 n}$ vértices, sin conjuntos independientes de tamaño al menos $(2- \varepsilon) \log_2 n$, es a lo más
\[
2^n \exp \left (\frac{- n^2}{\log^9_2 n} \right ) \longrightarrow 0 \quad (n \to \infty).
\]
Consecuentemente, con probabilidad alta, todo subgrafo de $\mathcal G (n, 1/2)$ con por lo menos $\frac{n}{\log^2_2 n}$ vértices, contiene un conjunto independiente de tamaño $(2-\varepsilon) \log n$. Sea $\mathcal G (n, 1/2)$ con esta propiedad y entonces podemos hallar de manera golosa conjuntos independientes disjuntos $\{A_i\}_{i = 1}^r$ de tamaño $(2-\varepsilon) \log_2 n$ (hay a lo más $n / (2-\varepsilon) \log_2 n$ de estos) hasta que
\[
    \sum_{i = 1}^r \abs{A_i} \geq n - \frac{n}{\log^2_2 n},
\]
entonces
\[
    \chi (\mathcal G (n, 1/2)) \leq \frac{n}{(2-\varepsilon) \log_2 n} + \frac{n}{\log ^2_2 n} = \left (\frac{1}{2 - \varepsilon} + o(1) \right ) \frac{n}{\log_2 n} \quad ( \varepsilon \to 0).
\]
De donde se sigue la otra desigualdad deseada.

\Inkscape{Coloreamos cada parte $A_i$ ($1 \leq i \leq r \leq \frac{n}{(2-\varepsilon) \log_2 n}$), y el resto de los $\leq \frac{n}{\log_2^2 n}$ vértices de distinto color.}{"./Figuras/Conexidad-de-grafos-aleatorios/Dibujo-2.pdf_tex"}
\end{proof}













\section{Elección aleatoria dependiente}

\subsection{El número de Ramsey-Turán}

\begin{definition}
El \textbf{número de Ramsey-Turán} de un grafo $H$ (límitado por una función $k(n)$) es la cantidad
\[
RT (n, H, k(n)) := \max \Set{e(G) | G \not \supset H \text{ tiene $n$ vértices y } \alpha (G) \leq k(n)}.
\]
\end{definition}

\begin{obs}
\[
    RT (n, K_3, o (n)) = o(n^2).
\]
En efecto, la vecindad $N_G (v)$ de un grafo $G$ libre de triángulos es un conjunto independiente, con lo cual $\alpha (G) = o (n)$, y por lo tanto $\Delta (G) = o (n)$. Esto implica que $e(G) = o (n^2)$.
\end{obs}

\begin{theorem}[Sudakov (2003)]
Para todo $\varepsilon > 0$,
\[
    RT (n, K_4, n^{1-\varepsilon}) = o (n^2) \quad (n \to \infty).
\]

\end{theorem}

\begin{proof}
La estrategia será la siguiente: supongamos que podemos encontrar un conjunto $A \subset V(G)$ de vértices de $G$ de tamaño $k = n^{1- \varepsilon}$ de tal suerte que para todo par de vértices $u,v \in A$ hay al menos $k$ vecinos en común. $A$ es un conjunto independiente o contiene una arista $uv$. Además, la vecindad en común entre $u$ y $v$ tiene tamaño al menos $k$, o es un conjunto independiente o conteniendo una arista $xy$. De esta manera, si $\alpha (G) < k$, se seguirá que $G$ contiene un $K_4$, por ejemplo el grafo inducido por los vértices $u,v,x,y$.

\Inkscape{Ilustración de la estrategia.}{"./Figuras/Eleccion-aleatoria-dependiente/Dibujo-1.pdf_tex"}

El siguiente lema nos permite encontrar dicho conjunto $A$ en cualquier grafo con densidad positiva:
\vspace{-20pt}
\begin{quote}
\begin{lemma}[Lema de elección aleatoria dependiente\footnote{
Para una demostración, ver el Lema 10.3.3 de \cite{botler2022combinatoria}
}]\label{lema:eleccion aleatoria dependiente}
Sea $G$ un grafo con $n$ vértices, y sean $r,s \in \naturals$. Si existe $t \in \naturals$ tal que
\[
    \frac{2^t e(G)^t}{n^{2t - 1}} - \binom n s \left ( \frac r n \right )^t \geq a,
\]
entonces existe un subconjunto $A \subset V(G)$ tal que:
\begin{enumerate}[(i)]
\item $\abs A \geq a$.
\item Todo conjunto con $s$ vértices de $A$ tiene al menos $r$ vecinos en común.
\end{enumerate}
\end{lemma}
\end{quote}

Ahora, tomemos $\varepsilon > 0$ arbitrariamente pequeño. Basta probar que todo grafo $G$ con $n$ vértices tal que
\[
    e(G) \geq \varepsilon n^2 \quad \text y \quad \alpha (G) \leq k = k(n) := n^{1- \varepsilon}
\]
contiene una copia de $K_4$. Para eso, utilizamos el Lema de elección aleatoria dependiente \ref{lema:eleccion aleatoria dependiente} con $s = 2$ y $a = r = k$ para encontrar un conjunto $A \subset V(G)$ de tamaño $k$ tal que para todo par de vértices en $A$ hay por lo menos $k$ vecinos en común. Para eso, debemos probar que
\[
    \frac{2^t e(G)^t}{n^{2t-1}} - \binom n 2 \left ( \frac k n \right )^t \geq k
\]
para algún $t \in \naturals$. Como $e(G) \geq \varepsilon n^2$ y $k = n^{1-\varepsilon}$, esto se deduce de la desigualdad
\[
    (2\varepsilon)^t n - n^{2 - \varepsilon t} \geq n^{1-\varepsilon},
\]
que es verdadera si $t \geq 2 / \varepsilon$ y $n$ es lo suficientemente grande.

Consecuentemente, el lema nos dice que existe un subconjunto de vértices $A$ con $\abs A \geq k$, tal que para todo par de vértices de $A$ hay al menos $k$ vecinos en común. Como $\alpha (G) \leq k$, debe existir una arista $uv \in E(G)$ en $A$, y como $u$ y $v$ tienen al menos $k$ vecinos en común, su vecindad en común contiene una arista $xy$. De esta manera los vértices $u,v,x,y$ inducen un $K_4$ en $G$, como queríamos.
\end{proof}

\begin{theorem}
Sea $k(n) \gg \sqrt{n \log n}$, entonces
\[
    RT (n, K_5, k(n)) \geq \frac{n^2}{4},
\]
y si $k(n) \ll \sqrt{n \log n}$, entonces
\[
    RT (n, K_5 , k(n)) = o (n^2).
\]
\end{theorem}
\begin{proof}
Para la primera afirmación, requerimos enunciar el siguiente teorema de \cite[Teorema 9.2.8]{botler2022combinatoria}:
\begin{quote}
\[
    \left ( \frac 1 4 + o (1 ) \right ) \frac{k^2}{\log k} \leq R(3, k) \leq (1 + o (1)) \frac{k^2}{\log k} \quad (k \to \infty).
\]
\end{quote}
De la primera desigualdad se sigue que para $n$ lo suficientemente grande, existe un grafo libre de triángulos $H$ con $n/2$ vértices y $\alpha (H) = O (\sqrt{n \log n})$. Ahora, para construir un grafo $G$ con $n$ vértices, simplemente tomamos dos copias de $H$ y agregamos todas las $n^2/4$ aristas entre ellas. Como $H$ es $K_3$-libre, se sigue que $G$ es libre de $K_5$ como queríamos.

\Inkscape{Grafo $G$ formado a partir de la unión de dos copias de $H$ unidas por todas las $n^2/4$ aristas entre ellas.}{"./Figuras/Eleccion-aleatoria-dependiente/Dibujo 2.pdf_tex"}

Para la segunda afirmación, sea $\varepsilon > 0$ y supongamos que $G$ es un grafo con
\[
e(G) \geq \varepsilon n^2 \quad \text y \quad \alpha (G) \leq k := k(n).
\]
Para ver que $G$ contiene una copia de $K_5$, vamos primero a usar el Lema de elección aleatoria dependiente \ref{lema:eleccion aleatoria dependiente} con $s = 3$, $a = R(3,k)$ y $r = k$ para encontrar un conjunto $A \subset V(G)$ de tamaño $R(3,k)$ tal que para toda terna de vértices en $A$ haya al menos $k$ vecinos en común. Para esto, debemos probar previamente que
\[
\frac{2^t e(G)^t}{n^{2t - 1}} - \binom n 3 \left ( \frac k n \right )^t \geq R(3, k)
\]
para algún $t \in \naturals$. Como $e(G) \geq \varepsilon n^2$, $k \ll \sqrt{n \log n}$, y $R(3,k) = O (k^2 / \log k) \ll n$ por la segunda desigualdad del principio, basta ver que
\[
    (2 \varepsilon)^t n - n^{3- t/2} (\log n)^{t/2} \geq R(3, k),
\]
lo cual es cierto para $t = 6$ y $n$ lo suficientemente grande.

Así, el lema nos provee de un conjunto de vértices $A$ de $G$ con $\abs A \geq R(3,k)$, tal que para toda terna de vértices de $A$, hay al menos $k$ vecinos en común. Como $\alpha (G) \leq k$, se sigue que existe un triángulo $uvw$ en $A$, y como $u,v,w$ tienen al menos $k$ vecinos en común, su vecindad contiene una arista $xy$. Por lo tanto, los vértices $u,v,w,x,y$ forman un $K_5$ en $G$, como queríamos.

\Inkscape{Ilustración del conjunto $A$ en $G$ con $\abs A \geq R(3,k)$, el cual contiene un triángulo $u,v,w$ con un vecindario en común conteniendo la aristas $xy$.}{"./Figuras/Eleccion-aleatoria-dependiente/Dibujo-3.pdf_tex"}
\end{proof}

\subsection{Número extremal de grafos bipartitos}

\begin{theorem}
Sea $H$ un grafo bipartito con partes $A$ y $B$, y supongamos que cada vértice de $B$ tiene grado máximo $s$. Entonces
\[
\ex{n}{H} = O (n^{2- 1 / s}),
\]
donde la constante implícita depende solamente de $H$.
\end{theorem}

\begin{obs}
Tomando $H = K_{s,t}$ recuperamos el Teorema \ref{th:teorema de kovani sos turan - extremalidad de Kst}.
\end{obs}


Para poder probar este teorema ecesitamos un lema previo:
\begin{lemma}\label{lema:un lema sobre grafos bipartitos H para probar resultado del metodo probabilistico y numero extremal de H}
Sea $H$ un grafo bipartito con partes $A$ y $B$, tal que cada vértice de $B$ tiene a lo más grado $s$. Sea $G$ un grafo tal que existe $U \subset V(G)$ de tal suerte que:
\begin{enumerate}[(i)]
\item $\abs U = \abs A$.
\item Todos los subconjuntos de $U$ de tamaño $s$ tienen al menos $v(H)$ vecinos en común.
\end{enumerate}
Entonces $H \subset G$.
\end{lemma}
\begin{proof}
Usando la propiedad (i) del conjunto $U$, podemos biyectar los vértices de $A$ con los de $U$. Vamos a mapear los vértices de $B$ de manera golosa, tomemos $B = \{v_1, \ldots, v_t\}$ y supongamos que ya hemos mapeado los vértices $v_1, \ldots, v_{i-1}$ para algún $1 \leq i \leq t$ en $G$. Consideremos la vecindad $N_H (v_i)$, sea $S_i$ el conjunto de vértices correspondiente de $U$, observemos que $\abs{S_i} \leq s$, pues los elementos de $B$ tienen grado a lo más $s$.

Ahora, por la propiedad (ii) del conjunto $U$, se sigue que los vértices de $S_i$ tienen al menos $v(H)$ vecinos en común en $G$. Para mapear $v_i$, simplemente elegimos cualquier elemento de esta vecindad en común que no haya sido utilizado. Notar que existe una posible elección, pues hemos mapeado hasta el momento menos de $v(H)$ vértices. Esto finaliza la demostración del lema.

\Inkscape{Ilustración del algorítmo glotón que permite incrustar $H$ en $G$. Notar que en el $i$-ésimo paso hay que buscar un vecino en común de $N_H(v_i) \subset U$ en $G$, que no se haya elegido antes, para poder incrustar a $v_i$. Esto se puede hacer pues hay $\geq v(H)$ opciones. }{"./Figuras/Eleccion-aleatoria-dependiente/Dibujo-4.pdf_tex"}
\end{proof}

\begin{proof}[Demostración del teorema]
Ahora, sea $G$ un grafo con $n$ vértices tal que $e(G) \geq C n^{2-1/s}$ para una constante $C >0$. Para probar que $G$ contiene una copia de $H$, primero utilizaremos el Lema de elección aleatoria dependiente \ref{lema:eleccion aleatoria dependiente} con $s = s$, $a = \abs A$ y $r = v(H)$, para encontrar un conjunto $U \subset V(G)$ de tamaño $\abs A$ tal que todo subconjunto $S \subset U$ de tamaño $s$ tiene almenos $v(H)$ vecinos en común. Previamente, debemos verificar que
\[
\frac{2^t e(G)^t}{n^{2t -1}} - \binom n s \left ( \frac{v(H)}{n} \right )^t \geq \abs A
\]
para algún $t \in \naturals$. Como $e(G) \geq C n^{2- 1/s}$ y $\abs A \leq v(H)$, se sigue que
\[
    (2C)^t n^{1- t/s} - v(H)^t n^{s-t} \geq v(H),
\]
que vale para $t = s$ si $C = C(H)$ es lo suficientemente grande. Luego se sigue que existe $U \subset V(G)$ con $\abs U \geq \abs A$ tal que todos los subconjuntos de $U$ de tamaño $s$ tienen al menos $v(H)$ vecinos en común. Pero la conclusión del lema de arriba \ref{lema:un lema sobre grafos bipartitos H para probar resultado del metodo probabilistico y numero extremal de H} nos indica que $H \subset G$, como queríamos.
\end{proof}



\subsection{El número de Ramsey de un hipercubo}

Utilizando el Lema de elección aleatoria dependiente \ref{lema:eleccion aleatoria dependiente} estudiaremos el número de Ramsey $r(Q_k)$ del grafo \textit{hipercubo $k$-dimensional} $Q_k$, que más precisamente se define como:
\begin{definition}
Para cada $k \in \naturals$, el \textbf{hipercubo $k$-dimensional} $Q_k$ es el grafo con conjunto de vértices $\{0,1\}^k$ y conjunto de aristas
\[
    E(Q_k) := \Set{xy | \# \{i \in [k] : x_i \neq y_i\} = 1}.
\]
\end{definition}

\begin{obs}
Notemos que $Q_k$ es un grafo bipartito $k$-regular con ambas partes de tamaño $2^{k-1}$.
\end{obs}

\begin{theorem}[Shi (2001)]
    \[
    r(Q_k) \leq 2^{3k}.
    \]
\end{theorem}
\begin{proof}
Sea $n := 2^{3k}$, y sea $c$ una $2$-coloración de las aristas de $K_n$ de color rojo-azul. Supongamos sin pérdida de generalidad que al menos la mitad de las aristas son rojas. Sea $G$ el grafo inducido por las aristas rojas. Afirmamos que $Q_k \subset G$.

En efecto, para probar que $G$ contiene una copia de $Q_k$, vamos a primero usar el Lema de elección aleatoria dependiente \ref{lema:eleccion aleatoria dependiente} con $s = k$, $a = 2^{k-1}$ y $r = 2^k$, para encontrar un conjunto $U \subset V(G)$ de tamaño $2^{k-1}$ de tal suerte que todo subconjunto $S \subset U$ de tamaño $k$ tiene al menos $2^k$ vecinos en común. Para esto, hay que verificar que
\[
    \frac{2^t e(G)^t}{n^{2t-1}} - \binom n k \left ( \frac{2^k}{n} \right )^t \geq 2^{k-1}
\]
para algún $t \in \naturals$. Como  $e(G) \geq \binom n 2 / 2 = n^2(1-\frac 1 n)/4$ y $n = 2^{3k}$, basta ver que
\[
2^{3k-t}(1- \frac{1}{2^{3k}})^t - 2^{3k^2 - 2k t} \geq 2^{k-1},
\]
lo cual vale para todo $3 k /2 \leq t \leq 2k$ si $k \geq 2$ (el caso $k = 1$ es trivial). En efecto, basta ver que
\[
    2^k (1- \frac 1 {2^{3k}})^{2k} - 1 \geq 2^{k-1}.
\]
Esto se puede probar por inducción en $k \geq 2$. El caso base vale; en general, por hipótesis inductiva tenemos que
\begin{align*}
2^{k+1} (1- \frac {1}{2^{3k + 3}})^{2k + 2} &\geq 2 (1- \frac{1}{2^{3k+3}})^2 (2^{k-1} + 1) \\
&= 2^k + 2 - \frac{2^{k-1}+ 1}{2^{3k}} + \frac{2^{k-1} + 1}{2^{6k + 1}},
\end{align*}
esto último es mayor o igual a $2^k + 1$ si es que probamos que
\[
    2^{6k + 3} + 2^{k-1} + 1 \geq 2^{4k + 2} + 2^{3k + 3}.
\]
Pero esto es claramente cierto para $k \geq 2$.

Así, el lema implica que existe un conjunto $U \subset V(G)$ con $\abs U \geq 2^{k-1} $ tal que para todo subconjunto de tamaño $k$ hay al menos $2^k$ vecinos en común. Pero el Lema \ref{lema:un lema sobre grafos bipartitos H para probar resultado del metodo probabilistico y numero extremal de H} junto con la observación que hicimos antes del teorema, implican que $Q_k \subset G$, como queríamos ver.
\end{proof}

\begin{obs}
Hemos probado un resultado de extremalidad: existe una copia de $Q_k$ en todo grafo con almenos $2^{3k}$ vértices y al menos $n^2/4$ aristas (donde $n := 2^{3k}$). Es decir,
\[
    \ex {2^{3k}}{Q_k} < n^2 / 4 = 4^{3k-1}.
\]
\end{obs}

\begin{remark}
Una mejor cota es de la forma $O(k 2^{2k})$, probada por Conlon (2009), también por Fox y Sudakov (2009).
\end{remark}































%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%import{nombre de carpeta/}{Nombre del archivo}
%\subfile{Apendice/Apendice.tex}





%--------------------------------
\newpage

\bibliographystyle{alpha}
\bibliography{main}{}

%--------------------------------







\end{document}

