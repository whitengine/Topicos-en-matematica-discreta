\documentclass[12pt]{report}


\usepackage{fouriernc}%la fuente
%\usepackage[sc]{mathpazo} %antigua fuente

\usepackage[utf8]{inputenc}

\usepackage[a4paper,width=150mm,top=25mm,bottom=25mm]{geometry}



\usepackage{subfiles} %esto es para modularizar el overleaf
%para usar este paquete solamente hay que usar el comando
%\subfile{}



\usepackage{graphicx}

\graphicspath{{./Figuras/Teoria extremal de grafos/}{./Figuras/}{./Figuras/Numeros extremales en grafos bipartitos/}{./Figuras/Teoria de Ramsey/}} %esto es para que encuentre las figuras hechas con pdf_tex en inkscape

\usepackage{framed}
\usepackage[dvipsnames]{xcolor} %agrega mas colores para xcolor.

%\usepackage[outdir=./]{epstopdf} %sin esto importar eps es imposible



\usepackage{xparse}
\usepackage{xstring}

\usepackage{stmaryrd} %para poner el comando \mapsfrom "<---|"

\usepackage{amssymb}

\usepackage{amsmath}

\usepackage{subfig}

\usepackage{mathrsfs} % para tener mas tipos de texto: \mathscr que es una letra mayuscula cursiva.

\usepackage{tikz-cd}

\usepackage{tkz-graph}%este paquete es para crear grafos con el ambiente \begin{tikzpicture}

\usepackage{caption}

\usepackage[shortlabels]{enumitem}

\usepackage{mathabx}
\let\widering\relax %esto es porque hay problemas con el comando \widering que se define en la fuenta fouriernc y en el paquete \usepackage{mathabx}

\usepackage[spanish,activeacute]{babel}

\usepackage{xparse}
\usepackage{xstring}

\usepackage{braket} %para definir \set , \Set y que los conjuntos se vean mas lindos

\usepackage{mathtools}

\usepackage[shortlabels]{enumitem}

\usepackage{hyperref}
\hypersetup{
    colorlinks,
    citecolor=red,
    filecolor=red,
    linkcolor=red,
    urlcolor=red
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsthm}

\theoremstyle{plain}
\newtheorem{theorem}{Teorema}[section]
\newtheorem{lemma}[theorem]{Lema}
\newtheorem{proposition}[theorem]{Proposición}
\newtheorem{proposition/definition}[theorem]{Proposición/Definición}
\newtheorem{corollary}[theorem]{Corolario}
\newtheorem{conjecture}[theorem]{Conjetura}
\newtheorem{afirmacion}[theorem]{Afirmación}
\newtheorem{recuerdo}[theorem]{Recuerdo}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definición}
\newtheorem{hypothesis}[theorem]{Hipótesis}
\newtheorem{example}[theorem]{Ejemplo}
\newtheorem{obs}[theorem]{Observación}
\newtheorem{notation}[theorem]{Notación}
\newtheorem{remark}[theorem]{Comentario}


%por alguna razon el teorema $warning  est aen uso, asi que lo remuevo de maqnera trucha
\newtheorem{warn}[theorem]{\textbf{ADVERTENCIA}}
\renewenvironment{warning}{\begin{warn}}{\end{warn}}

%crear ejercicio
\newtheorem{exercise}[theorem]{Ejercicio}
%solución
\newenvironment{solution}{\begin{proof}[Solución]}{\end{proof}}





%como crear un nuevo ambiente de teorema o proposición que este sobreado con un recuadro de "color". primero hacemos

%\newenvironment{Theorem}{\colorlet{shadecolor}{color} \begin{shaded} \begin{theorem} }{ \end{theorem} \end{shaded} }

%Notar que primero hay que definir el color del sobreado con el comando
%"\colorlet{shadecolor}{color}" y luego hay que usar el environment "shaded". Adentro de este ponemos el environment que queremos, en nuestro caso queremos "pintar" el environment "\begin{theorem}".


%se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newenvironment{Definition}{\colorlet{shadecolor}{Apricot!12} \begin{shaded} \begin{definition} }{ \end{definition} \end{shaded} }

\newenvironment{Example}{\colorlet{shadecolor}{Goldenrod!16} \begin{shaded} \begin{example}}{ \end{example} \end{shaded}}

\newenvironment{Remark}{\colorlet{shadecolor}{Orchid!12} \begin{shaded} \begin{remark}}{ \end{remark} \end{shaded}}

\newenvironment{Warning}{\colorlet{shadecolor}{red!12} \begin{shaded} \begin{warning}}{ \end{warning} \end{shaded}}

\newenvironment{Conjecture}{\colorlet{shadecolor}{magenta!16} \begin{shaded} \begin{conjecture}}{ \end{conjecture} \end{shaded}}

\newenvironment{Theorem}{\colorlet{shadecolor}{OliveGreen!18} \begin{shaded} \begin{theorem}}{ \end{theorem} \end{shaded}}

\newenvironment{Lemma}{\colorlet{shadecolor}{LimeGreen!12} \begin{shaded} \begin{lemma}}{ \end{lemma} \end{shaded}}

\newenvironment{Proposition}{\colorlet{shadecolor}{Green!12} \begin{shaded} \begin{proposition}}{ \end{proposition}\end{shaded}}

\newenvironment{Corollary}{\colorlet{shadecolor}{TealBlue!16} \begin{shaded} \begin{corollary}}{ \end{corollary} \end{shaded}}

\newenvironment{Obs}{\colorlet{shadecolor}{Dandelion!22} \begin{shaded} \begin{obs}}{ \end{obs} \end{shaded}}

\newenvironment{Exercise}{\colorlet{shadecolor}{Lavender!12} \begin{shaded} \begin{exercise}}{ \end{exercise} \end{shaded}}

%%%%%COLORES%%%%%%%%%%%%
%Hay varios comandos del paquete Xcolor:
%\color{blue,green,red,yellow,orange,black,white,pink,purble,etc...} hace que todo el bloque de texto se transforme en este color, se puede encerrar entre {} el bloque de texto que uno quiere colorear
%\textcolor{color}{text} escribe el texto "text" en "color".
%\colorbox{color}{text} pinta un rectangulo de "color" detrás del "text".
%\shaded



%lista de colores base de xcolor, como son colores de la extension del paquetem, empiezan con la primera letra mayuscula: si usaramos solo el paquete {xcolor} entonces no sería necesario.

%red, Green (fluorecente), Blue (muy obscuro), Cyan, Magenta, Yellow, Black, Gray, lightgray, White, darkgray, lightgray, Brown, lime (este verde mas lindo manzana), olive (marron verdoso feo), Orange, pink, Purple, teal (verde marino), Violet

%marco los colores lindos: red, Cyan, Magenta, Yellow, Black, Gray, White,  lime, Orange, pink, teal, Violet

%Colores que incluye el paquete dvipsnames: Apricot (color beige), Brown, Goldenrod, JungleGreen, Salmon, Lavender, SpringGreen, Turquoise, Plum, Emerald, BurntOrange (naranja piola), ForestGreen (verde oscuro), BrickRed (rojo obscuro)


\newcommand{\red}[1]{\textcolor{BrickRed}{#1}}

			\newcommand{\comentario}[1]{\red{#1}}

\newcommand{\green}[1]{\textcolor{SpringGreen}{#1}}

\newcommand{\blue}[1]{\textcolor{Cyan}{#1}}

\newcommand{\darkblue}[1]{\textcolor{Cyan!70!Black}{#1}}

\newcommand{\yellow}[1]{\textcolor{yellow!80!Black}{#1}} %se puede cambiar la tonalidad de un color "yellow!80" es el color amarillo pero al 80%  y el 20% es mezclado con blanco, i.e. está aclarado. Pero "yellow!80!Black" es 80% amarillo y 20% negro, i.e. es obscurecido 20%.

\newcommand{\black}[1]{\textcolor{Black}{#1}}

\newcommand{\gray}[1]{\textcolor{Gray}{#1}}

\newcommand{\purple}[1]{\textcolor{Purple}{#1}}

\newcommand{\beige}[1]{\textcolor{Apricot}{#1}}

\newcommand{\darkgreen}[1]{\textcolor{ForestGreen}{#1}}

\newcommand{\pink}[1]{\textcolor{Lavender}{#1}}

\newcommand{\salmon}[1]{\textcolor{Salmon}{#1}}

\newcommand{\brown}[1]{\textcolor{RawSienna!50!Black}{#1}}

\newcommand{\white}[1]{\textcolor{White}{#1}}

\newcommand{\orange}[1]{\textcolor{BurntOrange}{#1}}













%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%grupos de matrices
%SL
\newcommand{\SL}[2]{\operatorname{SL}_{#1} ( #2)}
%GL
\newcommand{\GL}[2]{\operatorname{GL}_{#1} ( #2)}

%matriz identidad
\newcommand{\Id}{\operatorname{Id}}



%enteros Z
\newcommand{\integers}{\mathbb{Z}}
%racionales
\newcommand{\rationals}{\mathbb{Q}}
%naturales
\newcommand{\naturals}{\mathbb{N}}
%reales R
\newcommand{\reals}{\mathbb{R}}
%imaginarios
\newcommand{\complex}{\mathbb{C}}
%p-adicos
\newcommand{\padics}{\mathbb{Q}_p}
%enteros p-adicos
\newcommand{\padicintegers}{\mathbb{Z}_p}

%cuerpos finitos
%Fp
\newcommand{\Fp}{\mathbb{F}_p}
%Fq
\newcommand{\Fq}{\mathbb{F}_q}



%valor absoluto p-adico
\newcommand{\abs}[1]{\left \vert #1 \right \vert}
%valor absoluto p-adico
\newcommand{\Abs}[1]{\left \vert \left \vert #1 \right \vert \right \vert}
%valuacion p-adica
\newcommand{\val}[1]{\operatorname{val} (#1)}

%Hom
\newcommand{\Hom}{\operatorname{Hom}}

%imagen y núcleo
\newcommand{\Imagen}{\operatorname{Im}}
\newcommand{\Ker}{\operatorname{Ker}}

%coker
\newcommand{\Coker}{\operatorname{Coker}}

%limite inverso
\newcommand{\liminv}{\varprojlim}


%un poco de typeset para categorias
\newcommand{\catname}[1]{{\operatorfont\textbf{#1}}}


\renewcommand{\hat}[1]{\widehat{#1}}
\renewcommand{\bar}[1]{\overline{#1}}

%declaro un comando nuevo para escribir restricción de funciones
\newcommand\rest[2]{{% we make the whole thing an ordinary symbol
  \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
  #1 % the function
  \vphantom{\big|} % pretend it's a little taller at normal size
  \right|_{#2} % this is the delimiter
  }}


%%%%   COMANDO ALGEBRA CONMUTATIVA   %%%%

%altura de un ideal:
\newcommand{\height}{\textsc{height}}

%Clausura topológica
\newcommand{\closure}[1]{\overline{#1}}

%longitud de un A-modulo. Notacion: \length_A M
\newcommand{\length}{\operatorname{length}}

%Anulador de un $A$-módulo.
\newcommand{\Ann}[1]{\operatorname{Ann} (#1)}

%Cuerpo de fracciones. Notacion $\FracField A$.
\newcommand{\FracField}[1]{\operatorname{Fr} (#1)}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%






%%%%   COMANDO TEORÍA DE NÚMEROS  %%%%

%Discriminante
\newcommand{\discriminant}[1]{\mathfrak{d} (#1 )}

%%%%Ideales primos%%%
%escribe una letra en notación mathfrak, para denotar a un ideal o elemento primo.

\newcommand{\primo}[1]{\mathfrak{#1}}
\newcommand{\Primo}[1]{\mathfrak{\MakeUppercase{#1}}}

%anillo de enteros O_K
\renewcommand{\O}{\mathcal{O}}
%anillo de enteros con subindice de cuerpo (input, por ejemplo $K$).
\newcommand{\integralring}[1]{O_{#1}}

%caracteristica de un cuerpo Char k
\newcommand{\Char}[1]{\operatorname{Char} #1}

%traza. Notación \trace = Tr
\newcommand{\trace}{\operatorname{Tr}}

%Traza de extensiones. Notación \Tr L K \alpha = \operatorname{Tr}_{L/K} (\alpha)
\newcommand{\Tr}[1]{\operatorname{Tr}_{L/K} (#1)} %la extension es L/K por default
\newcommand{\tr}[3]{\operatorname{Tr}_{#1/#2} (#3)}

%Norma de extensiones. Notación \Norm L K \alpha = \operatorname{N}_{L/K} (\alpha)
\newcommand{\Norm}[1]{\operatorname{N}_{L/K} (#1)}%la extension es L/K por default
\newcommand{\norm}[3]{\operatorname{N}_{#1/#2} (#3)}


%discriminante de una forma bilineal simetrica. notacion \disc{B} = \operatorname{disc} ( B)
\newcommand{\disc}[1]{\operatorname{disc} (#1)}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%COMANDO GRAFOS%%%%%%%%%%%%%

%\ceil funcion techo
\newcommand{\ceil}[1]{\left\lceil #1  \right\rceil}

%\floor funcion piso
\newcommand{\floor}[1]{\left\lfloor #1  \right\rfloor}

%diámetro de un grafo
\newcommand{\diam}[1]{\operatorname{diam} (#1)}

%radio de un grafo
\newcommand{\rad}[1]{\operatorname{rad}(#1)}

%Kappa:
\newcommand{\Kappa}{\mathcal{K}}

%Defecto:
\newcommand{\defecto}[1]{\mathrm{df}(#1)}

%Conjunto de últimos vértices de una familia \mathcal P de caminos dirigidos: \ter{\mathcal P}
\newcommand{\ter}[1]{\operatorname{ter} (#1)}

%numero de coloreo de un grafo G:
\newcommand{\col}[1]{\operatorname{col} (#1)}

%número de lista coloreo de un grafo G:
\newcommand{\ch}[1]{\operatorname{ch} (#1)}



%Número extremal
\newcommand{\ex}[2]{\operatorname{ex} (#1, #2)}









%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcounter{numeroSeccion}[section]%ponemos un contador que empieza en 0 y que cuenta el número de seccion

\newcounter{numeroCapitulo}[chapter]

\newcounter{numeroDibujo}[numeroSeccion]


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Cada dibujo se puede automatizar:
%1) necesitamos el archivo "Dibujo n.png" en la carpeta "Clase m", donde $n$ es el número del dibujo y $m$ es el número de la clase.



\renewcommand\thefigure{\thesection.\arabic{figure}}

%el comando Dibujo tiene dos inputs \Dibujo{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Dibujo}{O{1} m m}{
\stepcounter{numeroDibujo}
\begin{center}\label{Figura:Capitulo \thenumeroCapitulo - Seccion \thenumeroSeccion Dibujo \thenumeroDibujo}
\includegraphics[width=#1\columnwidth]{#3}
\captionof{figure}{#2}
\end{center}
}


%el comando Inkscape tiene dos inputs \Inkscape{input 1}{input 2}, el primer input es [OPCIONAL] y representa el ancho del dibujo, y el segundo es el caption de la figura.
\NewDocumentCommand{\Inkscape}{O{1} m m}{
\stepcounter{numeroDibujo}
\begin{center}\label{Figura:Capitulo \thenumeroCapitulo - Seccion \thenumeroSeccion Dibujo \thenumeroDibujo}
\def\svgwidth{#1\textwidth}
\input{#3}
\captionof{figure}{#2}
\end{center}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Apuntes - Tópicos en matemática discreta}
\author{Enzo Giannotta}






\begin{document}

\maketitle

%--------------------------------- ACA VA LA TABLA DE CONTENIDOS

\tableofcontents

%---------------------------------






\chapter{Teoría extremal de grafos}

En este curso trabajaremos con grafos simples, usualmente denotados: $G=(V,E)$.

\section{Teoría extremal de grafos}

¿Cuál es la máxima cantidad de aristas que puede tener un grafo de $n$ vértices sin que aparezca una cierta estructura?

¿Cómo lucen estos grafos maximales?

\begin{example}
\begin{enumerate}
\item Cuando la estructura es un ciclo, la cantidad de aristas es $n-1$ y los grafos maximales son los árboles.
\item Cuando la estructura es un ciclo impar. ¿Cómo lucen los grafos sin ciclos impares y que tienen una cantidad máxima de aristas? Son los completos balanceados $K_{\ceil {\frac n 2},\floor{\frac n 2}}$. En efecto, para que un grafo bipartito con $n$ vértices tenga una cantidad máxima de aristas, tiene dos partes $\abs X, \abs Y$ con $\abs X + \abs Y = n$ y si maximiza la cantidad de aristas es un grafo $K_{\abs X, \abs Y}$. Es decir, tiene $\abs X \cdot \abs Y$ aristas y si maximizamos, hay que maximizar la función $f(y) = (n-y)y$ con $1 \leq y \leq n-1$ e $y$ entero; esto sucede sii $y = \lfloor {\frac n 2} \rfloor$ o $y = \lceil \frac n 2 \rceil$.
\end{enumerate}
\end{example}

\begin{definition}
Sean $G$ y $H$ dos grafos. Decimos que $G$ es \textbf{H}-libre (o \textbf{libre de $H$}) si $H \nsubset G$. El \textbf{número extremal} de $H$ es la cantidad
\[
    \ex n H = \max \{e (G) | G \text{ es un grafo de $n$ vértices $H$-libre}\},
\]
donde $e(G)$ siempre denotará el número de aristas de $G$.

Si $G$ es $H$-libre y $\Abs G = \ex n H$, decimos que $G$ es \textbf{extremal} respecto de $n$ y $H$.
\end{definition}


\begin{theorem}[Mantel, 1907]
Sea $n \in \naturals$, $G$ un grafo $K_3$-libre con $n$ vértices. Entonces, $e(G) \leq \ceil{\frac n 2} \floor {\frac n 2}$. Además, $e(G) = \ceil{\frac n 2} \floor {\frac n 2} \Leftrightarrow G = K_{\ceil{\frac n 2}, \floor {\frac n 2}}$\footnote{Cuando $n = 1,2$ tenemos que $G$ es el completo $K_n$}.
\end{theorem}
\begin{proof}
Por inducción en $n$. Los casos $n = 1, n=2$ son un vértice, un $1$-camino respectivamente. Luego vale para $n=1,2$. Ahora, supongamos que $n \geq 3$. Sea $G$ un grafo $K_3$-libre con $n$ vértices, y $uv \in E(G)$ (si $G$ no tuviera aristas, podríamos agregar una arista y seguiría siendo $K_3$-libre); consideremos $G' = G \setminus \{u,v\}$. Tenemos que $G'$ también es $K_3$-libre y tiene $n-2$ vértices. Por inducción, $G'$ satisface
\[
    e(G') \leq \ceil{\frac {n-2} 2} \floor {\frac {n-2} 2}.
\]
Más aún, como $G$ es $K_3$-libre, no existen vértices $w \in G'$ tal que sea adyacente a $u$ y $v$ al mismo tiempo. Luego existen a lo más $n-2$ aristas en $E(G) \setminus E(G')$ sin contar la arista $uv$. Es decir,
\[
    e(G) \leq e(G') + n-1 \leq \ceil{\frac n 2} \floor {\frac n 2}.
\]
\Inkscape{Ilustración}{"./Figuras/Teoria extremal de grafos/Dibujo 1.pdf_tex"}


Para la segunda parte, $e(G) =\ceil{\frac n 2} \floor {\frac n 2} \Leftrightarrow G = K_{\ceil {\frac{n}{2}} , \floor {\frac{n}{2}}}$. Es claro que si $G = K_{\ceil{\frac n 2}, \floor {\frac n 2}}$ luego $e (G) = \ceil{\frac n 2}, \floor {\frac n 2}$. Veamos la recíproca. Sea $G$ con $n$ vértices y cantidad máxima de aristas tal que es $K_3$-libre. Los casos $n=1,2$ son triviales, luego podemos suponer que $\abs G \geq 3$. Como $G$ es $K_3$-libre, existen una aristas $uv \in E(G)$ por maximalidad. Por inducción, $G':= G \setminus \{u,v\}$ es un $K_{\ceil{\frac {n-2} 2}, \floor {\frac {n-2} 2}}$, digamos con partición $X',Y' \subset V(G')$ de sus vértices. Como $G$ es $K_3$-libre, ni $u$ ni $v$ pueden tener vecinos en $G'$ que estén en ambas particiones $X',Y'$, además, no puede haber una partición que no tenga a $u$ y $v$ como vecinos en $G$ pues podríamos agregar aristas entre vértices de esa particiones: contradiciendo maximalidad. Sin pérdida de generalidad, los vecinos de $u$ en $G'$ están en $X$ y los de $v$ en $Y$. Más aún, por maximalidad, todos los vértices de $X$ son vecinos con $u$ y todos los de $Y$ con $v$. Así, $G$ es un $X,Y$ bigrafo tomando $X := X' \cup \{v\}$ e $Y := Y' \cup \{u\}$. Notar que esto prueba que $G$ es un $K_{\ceil{\frac n 2}, \floor {\frac n 2}}$.


\end{proof}


\begin{definition}
El \textbf{grafo de Turán} $T_k (n)$ es el grafo $k$-partito completo con la mayor cantidad de aristas, es decir, los cardinales de las particiones difieren a lo más en $1$ entre sí (por maximalidad). Notamos
\[
    t_k(n) := e(T_k (n)).
\]
\end{definition}

\begin{obs}
Podemos calcular $t_k(n)$. Sea $\alpha \in \naturals$ el cardinal más grande de una partición de $T_k (n)$. Entonces las demás particiones tienen cardinal $\alpha$ o $\alpha -1$. Sea $r$ la cantidad de particiones con cardinal $\alpha -1$ y $k-r$ de cardinal $\alpha$. Tenemos que sumando los cardinales de todas las particiones:
\[
    \alpha k - r = n.
\]
Como $0 \leq r < k$, $r$ es el resto de la división de $n$ por $k$ y $\alpha$ es el cociente. Despejando obtenemos que $\alpha = \frac{n+r}{k}$ es decir, $\alpha = \lceil \frac{n}{k} \rceil$. En particular $\alpha -1 = \lfloor \frac{n}{k} \rfloor$. Juntado todo, tenemos que la cantidad total de aristas es:
\[
    \alpha^2 \binom{k-r}2 + \alpha (\alpha -1) (k-r)r + (\alpha-1)^2 \binom{r}2,
\]
i.e.,
\[
    \boxed{t_k(n) = \lceil \frac{n}{k} \rceil^2 \binom{k-r}2 + \lceil \frac{n}{k} \rceil \lfloor \frac{n}{k} \rfloor (k-r) r + \lfloor \frac{n}{k} \rfloor^2 \binom r 2.}
\]
\end{obs}


\begin{theorem}[Turán, 1941]\label{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}
Sean $n,k \in \naturals$, $G$ un grafo $K_{k+1}$-libre con $n$ vértice. Entonces
\[
    e(G) \leq t_k (n).
\]
Además, $e(G) = t_k (n) \Leftrightarrow G = T_k (n)$\footnote{Cuando $n = 1,2, \ldots, k-1$ tenemos que $G$ es el completo $K_n$}.
\end{theorem}

\begin{proof}
Hagamos inducción en $n$. Para $n \leq k$ es trivial. Sea ahora $G$ con $n \geq k+1$ que a su vez es $K_{k+1}$-libre y arista maximal. Esto implica que agregar cualquier arista hace aparecer un $K_{k+1}$ como subgrafo. Entonces $G$ contiene un $K_{k}$. Sea $A$ el conjunto de vértices de un subgrafo $K_{k}$ en $G$. Consideremos luego $G' = G\setminus A$. El grafo $G'$ es $K_{k+1}$-libre y tiene $n-k$ vértices. Cada $x \in V(G')$ tiene a lo más $k-1$ vecinos en $A$ dentro del grafo $G$, pues $G$ es $K_{k+1}$-libre. Luego por hipótesis inductiva:
\[
    e(G') \leq t_k(n-k).
\]
Si juntamos esto con la hipotesis inductiva, tenemos que
\[
    e(G) \leq e(G') + (n-k) (k-1) + \binom {k} 2    \leq t_k (n-k) + (n-k) \cdot (k-1) + \binom {k} 2 = t_k (n),
\]
donde el segundo término es la cantidad de aristas entre $A$ y $V(G')$.

Veamos ahora la segunda afirmación. Por definición, $G = T_k (n)$ tiene $t_k (n)$ aristas. Recíprocamente, supongamos que $G$ con $n$ vértices y cantidad máxima de aristas $e(G)$ tal que es $K_{k+1}$-libre. Los casos $n \leq k$ son triviales, luego supongamos que $n \geq k+1$. Por maximalidad, $G$ contiene un $K_{k}$ como subgrafo; llamemos $A$ a su conjunto de vértices en $G$ y consideremos $G' := G \setminus A$. Notar que
\[
    e(G') \geq e(G)- \left ( (n-k) (k-1) + \binom {k} 2 \right ) = t_k (n) -(n-k) (k-1) - \binom{k} 2 = t_k(n-k),
\]
pues cada vértice de $G'$ tiene a lo más $k-1$ vecinos en $A$. Como $G'$ es $K_{k+1}$-libre, en realidad vale la igualdad: $e(G') = t_k (n-k)$, por la primera parte que ya demostramos. Llamemos $X_1, X_2, \ldots, X_k$ a las particiones de $G'$. Como vale la igualdad arriba, tenemos que cada vértice de $G'$ tiene exactamente $k-1$ vecinos en $A$. Para cada $x' \in G'$ llamemos $\alpha(x')$ al único vértice de $A$ que no es adyacente a $x'$ en $G$. Más formalmente, $\alpha : V(G') \rightarrow A$ es una función; afirmamos que:
\begin{enumerate}[(i)]
\item $\alpha$ es sobreyectiva.
\item Si $x_i ' \in X_i$ y $x_j ' \in X_j$ para $i \neq j$, entonces $\alpha (x_i') \neq \alpha (x_j')$.
\end{enumerate}
Antes de probar la afirmación, notemos que esta prueba que
$\rest{\alpha}{X_i}$ es constante para cada $i = 1, \ldots, k$ (y por lo tanto tiene sentido el abuso de notación $\alpha (X_i)$ para denotar al único vértice de $A$ que no es adyacente a ningún vértice $x' \in X_i$). Veamos entonces la afirmación:
\begin{enumerate}[(i)]
\item Supongamos que $\alpha$ no es sobreyectiva: existe un $a_0 \in A$ tal que para todo $i = 1, \ldots, k$ existe $x_i ' \in X_i$ adyacente a $a_0$ en $G$. Pero esto implica entonces que los vértices $x_1' , \ldots, x_k ', a_0$ forman un $K_{k+1}$ en $G$, absurdo.
\item En efecto, si $\alpha (x_i ') = a_0 = \alpha (x_j ')$, entonces $x_i, x_j$ y los vértices de $A \setminus \{a_0\}$ juntos forman un $K_{k+1}$ en $G$, absurdo.
\end{enumerate}

Así, podemos extender la partición de $G'$ a todo $G$: definimos $\tilde X_i := X_i \cup \{\alpha (X_i)\}$. Es claro que de esta manera $G$ es un grafo $k$-partito completo. Como $G$ es maximal en su cantidad de aristas, entonces $G = T_k (n)$.
\end{proof}




\begin{theorem}[Erdös - segunda demostración del teorema]
Sean $n, k  \in \naturals    $ y $G$ un grafo $K_{k+1}$-libre con $n$ vértices. Entonces existe un grafo $H$ que es $k$-partito con $V(H) = V(G)$ tal que:
\[
    d_H (v) \geq d_G (v) , \quad \forall v \in V(G).
\]
\end{theorem}
\begin{proof}[Erdös]
Haremos inducción en $k$. Para $k = 1$ no hay que hacer nada. Sea ahora $k \geq 2$. Sea $v \in V(G)$ con $d_G (v) = \Delta (G)$. La vecindad de $v$, $G' := G[N_G (v)]$ debe ser $K_{k}$-libre. Sea $A := G \setminus N_G (v)$. Notar que
\[
    d_{G} (u) \leq d_{G'} (u) + \abs A.
\]
Por hipótesis inductiva existe un grafo $H'$ que es $(k-1)$-partito con $V(H') = V(G')$ y
\[
    d_{H'} (u) \geq d_{G'} (u), \quad \forall u \in V(G').
\]
Sea $H$ el grafo obtenido a paratir de $H'$ añadiendo los vértices de $A$ y conectando todos los vértices entre $A$ y $V(H')$. Observar que $H$ es $k+1$-partito y como $v$ tiene grado máximo en $G$, tenemos que para cada $u \in A$:
\[
    d_G (u) \leq d_G (v) = \abs{V(H')} = d_H (u)
\]
y para $u \in V(H')$ sabemos que:
\[
    d_G (u) \leq d_{G'} (u) + \abs A    \underset{H.I.}{\leq} d_{H'} (u) + \abs A = d_H (u).
\]
\end{proof}

\begin{exercise}
A partir de la demostración deducir que el grafo $K_{k+1}$-extremal es $T_k (n)$ y es único.
\end{exercise}
\begin{solution}
Sea $G$ un grafo $K_{k+1}$-extremal y $H$ el grafo $r$-partito obtenido por el Teorema anterior. Así, $V(H) = V(G)$ y $d_H (v) \geq d_G (v)$ para todo vértice $v$. Esta desigualdad implica que
\[
    e(H) \geq e(G),
\]
y por lo tanto, $H$ también es $K_{r+1}$-extremal. Pero por definición, $t_k (n) \geq e(H)$. Pero ya vimos que los grafos $K_{r+1}$ extremales tienen $\geq t_k (n)$ aritas. Con lo cual, en realidad $e(G) = e(H)$ y más aún, $d_H (v) = d_G (v)$ para todo $v$.

Esto nos indica que inspeccionando la demostración más detalladamanete, se tiene que $G'$ es un $T_{k-1} (\Delta)$ (con $\Delta := \delta (G)$) y que $G$ es luego $T_k (n)$.
\end{solution}

\begin{obs}\label{obs:notar que si H es no bipartito entonces ex(n,H)= Theta (n2)}
Sea $H$ un grafo con $\chi (H) \geq 3$, es decir no bipartito, entonces
\[
    \ex n H = \Theta (n^2).
\]
\end{obs}
\begin{proof}
En primer lugar, si $G$ es un grafo que contiene a $H$, luego no puede ser bipartito. En particular, si $G = K_{\ceil { \frac n 2} , \floor {\frac n 2}}$, entonces es $H$-libre al ser bipartito; de hecho tiene $n$ vértices y $e(G) = \ceil { \frac n 2} \floor {\frac n 2}$. Consecuentemente
\[
    (n-1)^2/4 \leq  \ceil { \frac n 2} \floor {\frac n 2} \leq \ex n H.
\]

Por otro lado, la cantidad de aristas maxima de $G$ es $\binom n 2$ (en general para cualquier grafo con $n$ vértices) y por lo tanto $\ex n H = \Theta (n^2)$.
\end{proof}




\section{Números extremales en grafos bipartitos}


\begin{recuerdo}[Desigualdad de Jensen]
Vamos a usar la desigualdad de Jensen: si $\varphi$ es una función convexa entonces:
\[
    \boxed{\varphi(\mathbb E (X)) \leq \mathbb E (\varphi (X)).}
\]
\end{recuerdo}


\begin{exercise}
Probar las siguientes dos desigualdades elementales para el binomio de Newton:
\[
    \left(\frac n k \right)^k \overset{\text{Cota 1}}{\leq} \binom n k \overset{\text{Cota 2}}{\leq} \left(\frac{n \cdot e}{k}\right)^k.
\]
\end{exercise}
\begin{solution}
\begin{enumerate}
\item[]
\item[Cota 1:] Notar que
\[
    \binom n k = \frac{n}{k} \cdot \frac{n-1}{k-1} \cdots \frac{n-k+1}{1}\geq \left ( \frac n k \right )^k,
\]
pues $\frac n k \leq \frac{n - j}{k - j}$ para todo $j = 0 , \ldots, k$.
\item[Cota 2:] Notar que se tiene una mejor cota:
\[
    \binom n k = \frac{n \cdot (n-1) \cdots (n-k + 1)}{k!} \leq \frac{n^k}{k!}.
\]
Por lo tanto, como $e^x = \sum_{k = 0}^\infty \frac{x^k}{k!}$, se sigue que $e^k \geq \frac{k^k}{k!}$, y luego
\[
    \frac{n^k}{k!} \leq \frac{n^ke^k}{k^k},
\]
como queríamos.
\end{enumerate}
\end{solution}

\begin{theorem}[Erdös, 1938]
Para todo $n \in \naturals$
\[
    \ex n {C_4} \leq n^{\frac 3 2}.
\]
\end{theorem}

\begin{definition}
Una \textbf{cereza} es un $2$-camino $x_0 x_1 x_2$. Llamaremos a $x_1$ el \textbf{centro} y a $x_0,x_2$ las \textbf{hojas}.
\end{definition}

\Inkscape{Dibujo de cereza.}{"./Figuras/Numeros extremales en grafos bipartitos/Dibujo 1.pdf_tex"}

\begin{proof}
Sea $G$ un grafo $C_4$-libre con $n$ vértices. Contaremos cereza en $G$ para acotar el número de aristas $e(G)$.

Para cada vértice $v \in V(G)$ hay exactamente
\[
    \binom{d_G(v)}{2} \text{ cerezas con centro en $v$}.
\]
Por lo tanto, en $G$ hay
\[
    \sum_{v \in V(G)} \binom{d_G(v)}{2} \text{ cerezas en $G$}.
\]
Por la desigualdad de Jensen la sumatoria se minimiza cuando todos los grados son iguales:
\begin{align*}
    \sum_{v \in V(G)} \binom{d_G(v)}{2} &\geq n \cdot \binom{2 e(g) / n}{2} \\
                                        &\overset{Cota 1}{\geq} n \cdot \left ( \frac{e(G)}{n} \right )^2 = \frac{e(G)^2}{n}.
\end{align*}
Por otro lado, dado un par $\{u,v\}$ de hojas de cerezas distintas, entonces tendríamos un subgrafo $C_4$ en $G$, absurdo; por lo tanto hay a lo más
\[
    \binom{n} 2 \text{ cerezas en $G$}.
\]

Juntando todo:
\[
    \frac{e(G)^2}{n} \leq \binom n 2 = \frac{n(n-1)}{2},
\]
consecuentemente $e(G)^2 \leq n^3$, i.e., $e(G) \leq n^{\frac{3}{2}}$.
\end{proof}




\begin{theorem}[Kövani, Sós, Turán]\label{th:teorema de kovani sos turan - extremalidad de Kst}
Sean $s, t \in \naturals$, $s \leq t$. Entonces existe una constante $c = c(s,t) > 0$ tal que
\[
    \ex n {K_{s,t}} \leq c \cdot n^{2 - \frac 1 s}, \quad \forall n \in \naturals.
\]
\end{theorem}

\begin{definition}
Una \textbf{$s$-cereza} es un $K_{1,s}$. Similarmente tenemos la noción de \textbf{centro} y \textbf{hojas} (las cuales son $s$).
\Inkscape{Dibujo de $s$-cereza.}{"./Figuras/Numeros extremales en grafos bipartitos/Dibujo 2.pdf_tex"}
\end{definition}

\begin{proof}
Sea $G$ un grafo $K_{s,t}$-libre en $n$ vértices. Para cada $v \in V(G)$ hay $\binom{d_G(v)}{s}$ $s$-cerezas. Por lo tanto en $G$ hay
\[
    \sum_{v \in V(G)} \binom{d_G(v)}{s} \quad \text{$s$-cerezas},
\]
con lo cual
\[
    \sum_{v \in V(G)} \binom{d_G (v)} s \overset{\text{Cota 1}}{\geq} \sum_{v \in V(G)} \frac{d_G (v)^s}{s^s} \overset{\text{Jensen}}{\geq} \frac{n}{s^s} \left ( \frac{2e(G)}{n} \right)^s .
\]
Procediendo de manera análoga a la demostración del teorema anterior, tenemos que un conjunto de $s$ vértices del grafo puede ser conjunto de hojas de a lo más $(t-1)$ cerezas, pues de lo contrario habría una copia de $K_{s,t}$. Por lo tanto, hay en total a lo más
\[
    (t-1) \cdot \binom{n}s \text{ $s$-cerezas}.
\]

Juntando todo:
\[
    n \left ( \frac{2 e(G)}{s n} \right)^s \leq (t-1) \cdot \binom n s \overset{\text{Cota 2}}{\leq} (t-1) \cdot \left (\frac{n e}{s} \right )^s,
\]
luego
\[
    \frac{2 e(G)}{s n} \leq \frac{(t-1)^{\frac 1 s}}{n^{\frac 1 s}} \cdot \frac{n e}{s},
\]
equivalentemente,
\[
    e(G) \leq {\frac{(t-1)^{\frac 1 s} s e}{2 s}} \cdot n^{2-\frac{1}{s}} = c(s,t ) \cdot n ^{2 - \frac 1 s}.
\]
\end{proof}

\begin{exercise}
Demostrar que
\[
    \ex n H = o (n^2) \quad \Leftrightarrow \quad H \text{ es bipartito}.
\]
\end{exercise}
\begin{solution}
Como $H$ es bipartito, existen $s,t \in \naturals$, digamos $s \leq t$, tales $H \subset K_{s,t}$. Así, por el Teorema de \ref{th:teorema de kovani sos turan - extremalidad de Kst},
\[
    \ex n H \leq c(s,t) \cdot n^{2 - \frac{1}{s}},
\]
pues si $G$ no contiene a $H$, tampoco contiene a $K_{s,t}$. Así, obtenemos que $\ex n H = o(n^2)$.

Recíprocamente, supongamos que $H$ no es bipartito, luego por la Observación \ref{obs:notar que si H es no bipartito entonces ex(n,H)= Theta (n2)}, $\ex n H = \Theta (n^2)$. Con lo cual, si $\ex n H= o (n^2)$, necesariamente $H$ es bipartito.
\end{solution}


\section{Números extremales para árboles}



\begin{theorem}
Sean $n,k \in \naturals$ y $T$ un árbol con $k+1$ vértices. Entonces,
\[
    \ex n T \leq (k-1) \cdot n.
\]
\end{theorem}

\begin{lemma}\label{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices}
Sean $k \in \naturals$ y $T$ un árbol con $k+1$ vértices. Entonces si $G$ es un grafo con $\delta (G) \geq k$, luego contiene a $T$ como subgrafo.
\end{lemma}
\begin{proof}
Haremos inducción en $k$. Para $k = 1$ es claro, pues existe un vértice con al menos un vecino. En general, supongamos que $k \geq 2$. Sea $h$ una hoja de $T$ y consideremos el árbol $T' = T \setminus \{h\}$. Por hipótesis inductiva, $T' \subset G$. Sea $p$ el único vecino de $h$ en $T$, i.e. $p \in T'$. Como $T$ tiene $k+1$ vértices, $p$ tiene a lo más $k-1$ vecinos en $T'$, luego $p$ tiene un vecino en $G$ que no está en $T'$ pues $\delta_G (p) \geq k$. Entonces podemos incrustar $T$ en $G$ considerando $h$ como este vértice.
\end{proof}

\begin{lemma}\label{lema:lema 2 - teorema de extremalidad de arboles}
Todo grafo $G$ contiene un subgrafo $H$ con $\delta (H) > \varepsilon (H) \geq \frac{e(G)}{n}$, donde $n = \abs G$.
\end{lemma}
\begin{proof}
Construiremos una secuencia de subgrafos de $G$:
\[
    G =: G_0 \supset G_1 \supset \cdots
\]
de la siguiente manera, si $v_i \in G_i$ es un vértice con $d_{G_i} (v_i) \leq \varepsilon (G_i) := \frac{e(G_i)}{\abs{G_i}}$, entonces definimos $G_{i+1} := G_i \setminus \{v_i\}$. Eventualmente esta secuencia termina, digamos en $H := G_{j_0}$.

Notar que $\varepsilon (G_{i+1}) \geq \varepsilon (G_i)$, y por lo tanto $\varepsilon (H) \geq \varepsilon (G)$. En efecto,
\[
    \varepsilon (G_{i+1}) = \frac{e(G_{i+1})}{\abs{G_{i+1}}} = \frac{e(G_i) - d_{G_i} (v_i)}{\abs{G_i} - 1},
\]
que es mayor o igual que $\frac{e(G_i)}{\abs{G_i}}$ si y solo si
\[
    (e(G_i) - d_{G_i} (v_i)) \abs{G_i} \geq e(G_i)(\abs{G_i} - 1),
\]
equivalentemente,
\[
    e(G_i) \geq \abs{G_i} d_{G_i} (v_i),
\]
i.e.,
\[
    \frac{e(G_i)}{\abs{G_i}} \geq d_{G_i} (v_i),
\]
que es cierto por construcción. Por otro lado, por minimalidad de $H$, se sigue que $\delta (H) > \varepsilon (H)$.
\end{proof}

\begin{proof}[Demostración del teorema]
Sea $G$ un grafo con $\geq (k-1) \cdot n + 1$ aristas. Por el segundo lema, $G$ contiene $H$ con
\[
    \delta (H) \geq \frac{e(G)}{n} > \frac{(k-1) n}{n},
\]
y por el primer lema $T \subset H \subset G$.
\end{proof}

\begin{conjecture}[Erdös, Sós, 1963]
Se conjetura que en el teorema anterior se tiene una mejor cota:
\[
    \ex n T \leq \frac 1 2 (k-1) n.
\]

Notar que de ser verdadera la conjetura, entonces esta cota es tight cuando $n$ es un múltiplo de $k$: Sea $G$ el grafo obtenido al unir $\frac n k$ copias de $K_k$, así $e(G) = \frac n k \binom k 2 = \frac n 2 (k-1)$.

Esta conjetura es verdadera en el caso \underline{$T$ un camino}:
\end{conjecture}

\begin{theorem}[Erdös \& Gallai, 1959]
Sean $n, k \in \naturals$. Entonces,
\[
    \ex n {P_k} \leq \frac{(k-1) \cdot n}{2}
\]
\end{theorem}
\begin{exercise}
A partir de la demostración de este teorema, obtenga que los grafos extremales son únicos.
\end{exercise}

\begin{lemma}\label{lema:grafo G conexo con n vertices tiene un camino de largo al menos 2 delta o n-1}
Todo grafo conexo $G$ con $n$ vértices contiene un camino de largo
\[
    k := \min \{2 \delta (G), n-1\}.
\]
\end{lemma}
\begin{proof}
Tomemos $P := v_0, \ldots, ,v_l$ camino de largo máximo. Sabemos que $N_G (v_0), N_G (v_l) \subset V(P)$ por maximalidad de $P$. Si $V(P) = V(G)$ ganamos. Así que supongamos que no; supongamos también que $l < k\leq 2\delta (G)$. Demostraremos que existe un ciclo de longitud $l$ contenido en $G[V(P)]$, así llegaremos a una contradicción pues al existir un vértice $x$ fuera de $G[V(P)]$ en $G$, podríamos extender el ciclo a un camino de longitud al menos $k+1$ en $G$ conectándolo con $x$.

\Inkscape{Notar que en este caso $v_0 P v_{i-1} v_l P v_i v_0$ es un ciclo de longitud $\abs P$ en $G[V(P)]$.}{"./Figuras/Numeros extremales para arboles/figura.pdf_tex"}

En efecto, supongamos que no existe tal ciclo, luego para cada $i \in \{1, \ldots, l-1\}$ se tiene que $v_{i-1}v_l \not \in E(G)$ o $v_0 v_i \not \in E(G)$. Entonces
\[
    2 \delta(G) \leq d_G (v_0) + d_G (v_l) \leq l < 2 \delta (G),
\]
absurdo.
\end{proof}


\begin{proof}[Demostración del teorema]
Haremos inducción en $n$. Afirmamos que $G$ es $P_k$-libre en $n$ vérties, entonces
\[
    e(G) \leq \frac{(k-1)\cdot n}{2}.
\]
El caso base es $n \leq k$, luego $e(G) \leq \binom n 2 = \frac{n (n-1)}{2} \leq \frac{n (k-1)}{2}$. Luego supongamos que $n \geq k+1$. Si $G$ no es conexo: sean $G_1, \ldots, G_r$ las componentes conexas, por hipótesis
\[
    e(G_i) \leq \frac{\abs{G_i} (k-1)}{2},
\]
entonces
\[
    e(G) = \sum_{i = 1}^r e(G_i) \leq \frac{k-1}{2} \sum_{i =1}^r \abs {G_i} = \frac{n (k-1)}{2}.
\]

Ahora, supongamos que $G$ es conexo. Si $n-1 \leq 2 \delta (G)$, entonces por el Lema \ref{lema:grafo G conexo con n vertices tiene un camino de largo al menos 2 delta o n-1}, $G$ contiene un camino de largo $n-1 \geq k$, absurdo. Con lo cual, podemos asumir que $2 \delta (G) \leq n-1$, y por el Lema, $G$ contiene un camino de largo $2 \delta (G)$ que debe cumplir
\[
    2\delta (G) < k \quad \Leftrightarrow \quad \delta (G) \leq \frac{k-1}{2}.
\]
Sea $v$ un vértice de grado $\leq \frac{k-1}{2}$, consideremos $G' := G \setminus \{v\}$. Por hipótesis inductiva
\[
    e(G') \leq \frac{(n-1)(k-1)}{2},
\]
con lo cual,
\[
    e(G) \leq e(G') + \frac{k-1}{2} \leq \frac{(n-1)(k-1)}{2} + \frac{k-1}{2} = \frac{n(k-1)}{2}.
\]
\end{proof}



\section{Estabilidad y supersaturación}

\begin{theorem}[Füredi, 2015]\label{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos}
Sean $n,t \in \naturals$, y $G$ con $n$ vértices. Si $G$ está \textbf{$t$-lejos} de ser bipartito\footnote{Esto significa que si $H$ es un subgrafo bipartito de $G$, entonces $e(H) \leq e(G)-t$.}, entonces hay al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos en $G$.
\end{theorem}
\begin{proof}
Para cada $u \in V(G)$, definimos
\[
    B_u := N_G (u) \quad \text{y} \quad A_u := V(G) \setminus B_u.
\]
Luego la cantidad de tríangulos de $G$ es:
\[
    k_3 (G) = \frac 1 3 \sum_{u \in V(G)} e(B_u).
\]

Para cada $u \in V(G)$, si borro las aristas de $G[B_u]$ y las de $G[A_u]$, obtengo un subgrafo bipartito de $G$: el $(A_u,B_u)$-bigrafo; luego tuvimos que haber quitado al menos $t$ aristas porque $G$ está $t$-lejos de ser bipartito, es decir:
\[
    e(B_u) + e(A_u) \geq t.
\]

Además, para cada $u \in V(G)$
\[
    \sum_{v \in A_u} d_G (v) = e(B_u, A_u) + 2e (A_u).
\]
Como
\[
    e(G) = e(A_u) + e(A_u, B_u) + e(B_u),
\]
se sigue que $e (A_u) = e(B_u) - e(G) + \sum_{v \in A_u} d_G (v)$ (juntando ambas ecuaciones). Ahora, por la desigualdad $e(B_u) + e (A_u)\geq t$, se tiene que
\[
    e(B_u) \geq t - e(A_u) = t +e(G) - e(B_u) - \sum_{v \in A_u} d_G (v)
\]
y por lo tanto
\[
    2 e(B_u) \geq t + e(G) - \sum_{v \in A_u} d_G (v).
\]
Sumando sobre todos los $u \in V(G)$ y utilizando que $k_3 (G) = \frac 1 3 \sum_{u \in V(G)} e (B_u)$, concluimos:
\[
    k_3 (G) \geq \frac 1 2 \cdot \frac 1 3 (n t + n e(G) - \sum_{u \in V(G) } \sum_{v \in A_u} d_G (v));
\]
sin embargo, afirmamos que vale la siguiente igualdad:
\[
    \sum_{u \in V(G)} \sum_{v \in A_u} d_G (v) = \sum_{x \in V(G)} d_G (x) ( n - d_G (x));
\]
ya que cada término de la sumatoria se acota inferiormente por $\frac n 2  \cdot (n - \frac n 2) = \frac{n^2}{2}$, concluimos el resultado.

Veamos la afirmación: notar que para cada $x \in V(G)$, su cantidad de aristas $d_G (x)$ es contada exactamente $\abs {A_x} = n - d_G (x)$ veces del lado izquierdo de la sumatoria.
\end{proof}

Como corolario, se prueban los siguientes dos teoremas:
\begin{theorem}[Estabilidad]
Sean $n,t \in \naturals$, y $G$ es $K_3$-libre con $n$ vértices. Si $e(G) \geq \frac{n^2}{4}- t$, entonces $G$ contiene un grafo bipartito con al menos $e(G)-t$ aristas.
\end{theorem}
\begin{proof}
Si $G$ no tuviera un grafo bipartito con al menos $e(G) - t$ aristas, entonces $G$ estaría $(t+1)$-lejos de ser bipartito. Por el Teorema \ref{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos} tiene al menos
\[
    \frac{n}{6} \left ( e(G) - \frac{n^2}{4} + (t + 1) \right ) \geq \frac n 6
\]
triángulos, i.e., al menos uno, lo cual es absurdo.
\end{proof}

\begin{theorem}[Supersaturación]
Sean $n,t \in \naturals$, y $G$ un grafo con $n$ vértices. Si $e(G) \geq \frac{n^2}{4} + t$, entonces $G$ contiene al menos $t \cdot n /3$ triángulos.
\end{theorem}
\begin{proof}
Notar que $G$ está $t$-lejos de ser bipartito, en efecto, un grafo bipartito de orden $m \leq n$ tiene a lo más $\frac{m^2}{4}\leq \frac{n^2}{4}$ aristas, pero $G$ tiene al menos $\frac{n^2}{4} + t \geq \frac{m^2}{4} + t$ aristas. Luego por el Teorema \ref{th:teorema de furedi si G esta t lejos de ser bipartito entonces tiene triangulos}, $G$ tiene
\[
    \frac{n}{6} \left ( e(G) - \frac{n^2}{4} + (t + 1) \right ) \geq \frac{n}{3} t
\]
triángulos.
\end{proof}


\bigskip

\begin{theorem}[Füredi, 2015 -- Estabilidad]\label{theorem:teorema de estabilidad de furedi}
Sean $n,k \in \naturals$, $t \geq 0$ y $G$ un grafo $K_{k+1}$-libre en $n$-vértices. Si $e(G) \geq t_k (n)- t$, entonces $G$ contiene un subgrafo generador $k$-partito con al menos $e(G)-t$ aristas.
\end{theorem}
\begin{proof}
Haremos inducción en $k$. El caso $k = 1$ tenemos que $t_k (n) = 0$ y siempre se cumple. Entonces supongamos que $k \geq 2$. Tomemos $u \in V(G)$ con $d_G (u) = \Delta (G)$. Definamos $G' := G[B]$ con $B = N_G (u)$. Sea $A = V(G) \setminus B$. El grafo $G'$ es $K_k$-libre porque $G$ es $K_{k+1}$-libre, luego por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}, $e(G') \leq t_{k-1} (d)$ con $d := \abs B$ y entonces podemos definir $t' := t_{k-1}(d) - e(G') \geq 0$ y aplicar hipótesis inductiva al grafo $G'$. Así, $G'$ contiene un subgrafo $H'$ generador $(k-1)$-partito con al menos $e(G') - t' = 2 e(G') - t_{k-1} (d)$ aristas.

 Probemos que
\[
    H := \Big (V(H') \cup A, E(H') \cup E(A,B) \Big)
\]
tiene al menos $e(G) - t$ aristas, y así $H$ es un subgrafo $k$-partito generador de $G$ con al menos $e(G)- t$ aristas. En efecto, queremos probar que
\[
    e(H') + e(A, B) \geq e(G) - t;
\]
como $e(G) = e(A,B) + e(G') + e(A)$, la desigualdad de arriba es equivalente a
\[
    e(H') \geq e(G') + e(A) - t \quad \Leftrightarrow \quad e(H') - e(G') + t \geq e(A).
\]
Ya que $e(H') \geq e(G') - t'$, nos queda que la última desigualdad es cierta si $e(A) \leq t - t'$.

Sabemos que
\[
     2 e(A) + e(A,B) = \sum_{v \in A} d_G (v) \leq d \cdot (n - d),
\]
donde la desigualdad sale de que la sumatoria tiene $(n-d)$ términos y cada grado $d_G(v) \leq \Delta (G) = d_G(u) = \abs B = d$;
y reemplacemos $e(A,B) = e(G) - e(A) - e(G')$ y nos queda
\[
    e(A) + e(G) - e(G') \leq d \cdot (n-d).
\]
Ahora, notar que
\[
    t_k (n) \geq t_{k-1} (d) + d \cdot (n-d),
\]
pues el lado izquierdo es la cantidad de aristas de un grafo de Turán (la cual es máxima) y el lado derecho es la cantidad de aristas de un grafo $k$-partito en $n$-vértices: el obtenido a patir del grafo de turán $T_{k-1} (d)$ agregando $n-d$ vértices y conectándolos a las $k-1$ particiones de $T_{k-1} (d)$. Juntando todo,
\[
    e(A ) \leq d \cdot (n-d) - \overbrace{e(G)}^{\geq t_k (n) -t} + \overbrace{e(G')}^{=t_{k-1} (d) - t'} \leq d \cdot (n-d) - t_k (n) + t + t_{k-1} (d) - t' \leq t - t'
\]
como queríamos probar.
\end{proof}



\section{Teorema de Erdös-Stone}


\begin{notation}
Notaremos por $K_s (t)$ al grafo de Turán $T_{s} (t \cdot s)$.
\end{notation}

\begin{theorem}[Erdös-Stone, 1946]\label{th:teorema de Erdos-stone}
Sea $H$ un grafo con $e(H) \geq 1$. Entonces
\[
    \ex n H \leq \left ( 1 - \frac{1}{\chi (H) - 1}  + o (1) \right) \cdot \frac{n^2}{2} \quad (n \to \infty). \\
\]
\end{theorem}

\begin{obs}
Sea $H$ un grafo con $e(H) \geq 1$. Entonces
\[
    t_{\chi (H) -1} (n) \leq \ex n H,
\]
pues todo grafo $G$ necesita de al menos $\chi (H)$ colores para tener a $H$ incrustado, por lo tanto $T_{\chi (H) - 1} (n)$ es $H$-libre.
\end{obs}

\begin{obs}\label{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2}
\[
t_{\chi (H) - 1 } (n) \sim \left ( 1 - \frac{1}{\chi (H)- 1}\right ) \frac{n^2}{2}.
\]
Con lo cual, la desigualdad de Erdös-Stone es asintóticamente justa.
\end{obs}
\begin{proof}
En efecto, esto equivale a probar que
\[
    t_{k} (n) \sim \left (1 - \frac 1 {k} \right ) \frac{n^2}{2} \quad (n \to \infty),
\]
para $k \geq 2$ fijo. Escribiendo $n = q k + r$ con $0 \leq r < k$, tenemos que
\[
    t_k (q k) \leq t_k (n) \leq t_k((q+1)k),
\]
pero para cualquier $q \in \naturals$ es fácil de calcular el número de aristas del grafo de Turán $T_k (q k)$:
\[
    t_k (q k) = \left ( 1 - \frac 1 k \right ) \frac{(q k)^2}{2},
\]
con lo cual $t_k (q k) , t_k ((q+1)k) \sim \left ( 1 - \frac 1 k \right)  \frac {n^2}{2}$ y por lo tanto $t_k (n)$ también.
\end{proof}

\begin{lemma}\label{lema:erdos-stone lema 1}
Sea $c \in (0,1)$ y sea $\varepsilon > 0$. Si $G$ es un grafo con $n$ vértices, con $n$ lo suficientemente grande tal que
\[
    e(G) \geq c \frac{n^2}{2},
\]
entonces existe un subgrafo $G' \subset G$ con
\[
    \abs{G'} \geq \varepsilon n \quad \text y \quad \delta (G') \geq (c- \varepsilon) \abs{G'}.
\]
\end{lemma}
\begin{proof}
Sea $G_n, G_{n-1}, G_{n-2}, \ldots, G_t$ la secuencia de subgrafos de $G$ obtenida de la siguiente manera: $G_n := G$ y el grafo $G_{n - (i+1)}$ se obtiene a partir de $G_{n-i}$ borrando un vértice $v \in V(G_{n-i})$ con $d_{G_{n-i}} (v) < (c - \varepsilon) \cdot \abs{G_{n-i}}$; además, $G_t$ es el último grafo de la secuencia. Notar que $\abs{G_{n-i}} = n - i$.

Afirmamos que $t \geq \varepsilon n$ para $n$ lo suficientemente grande, y por ende, $G_t$ será el subgrafo que buscabamos: por construcción $\delta (G_t) \geq (c - \varepsilon) \abs{G_t}$. Para eso, calculamos la cantidad total de aristas borradas para la obtención de $G_t$:
\[
    \sum_{i = 0}^{n-(t+1)} d_{G_{n-i}} (v_i) < (c-\varepsilon) \sum_{i = 0}^{n-(t+1)} n-i = (c-\varepsilon) (n-t) (n+t+1)/2,
\]
y como $G_t$ tiene a lo más $\binom t 2$ aristas, tenemos que
\[
    e(G) \leq (c- \varepsilon) (n-t) (n+ t + 1)/2 + \binom t 2 .
\]

Supongamos por el absurdo que $t \leq \varepsilon n$. Nuestro objetivo es acotar el lado derecho:
\begin{align*}
e(G) \leq (c- \varepsilon) (n-t) (n+ t + 1)/2 + \binom t 2  &= (c- \varepsilon) \frac{(n^2 + n  - (t^2 + t))}{2} + \frac{t(t-1)}{2} \\
&\leq (c-\varepsilon) \frac{n^2 + n}{2 } + \frac{\varepsilon n (\varepsilon n - 1)}{2} \\
&= (c- \varepsilon + \varepsilon^2)\frac{n^2}{2} + (c - 2\varepsilon) \frac{n}{2}.
\end{align*}


Notar que el lado derecho es un polinomio cuadrático en la variable $n$ con coeficiente principal $\frac{c-\varepsilon + \varepsilon^2}{2} < \frac c 2$
y por lo tanto para $n$ lo suficientemente grande, se contradice la desigualdad $c\frac{n^2}{2} \leq e(G)$. Así, $t \geq \varepsilon n$.
\end{proof}

\begin{lemma}\label{lema:erdos-stone lema 2}
Para todo $r, t \in \naturals$ y $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $G$ es un grafo con $n \geq n_0$ vértices y
\[
    \delta (G) \geq \left ( 1 - \frac 1 r + \varepsilon \right ) n
\]
luego $K_{r+1} (t) \subset G$.
\end{lemma}
\begin{proof}
Procedemos por inducción en $r$. Para $r = 1$, tenemos que $K_2 (t) = K_{t,t}$ y sabemos que en este caso $\ex n {K_{t,t}} = o (n^2)$. Como $n$ es lo suficientemente grande, $K_{t,t} \subset G$. En efecto, se tendrá que
\[
    e(G) = \frac 1 2 \sum_{v \in G} d_G (v ) \geq \frac{\delta (G) n}{2} \geq \left (1 - \frac 1 r + \varepsilon \right ) \frac{n^2}{2}.
\]


Ahora, supongamos que $r \geq 2$. Primero, encontraremos por hipótesis inductiva, una copia de $K_{r} (q)$ con $q \geq t/\varepsilon$; escribamos $A := \bigcup_{i = 1}^r A_i$ a la partición de los vértices de $K_r (q)$.

Luego, definimos $X \subset B := V(G) \setminus A$, el conjunto de todos los vértices que tienen al menos $t$ vecinos en cada $A_i$. Mostramos que $\abs X \to \infty$ cuando $n \to \infty$. Para esto, acotamos $e(A,B)$ por abajo:
\begin{align*}
    e(A,B) &= \sum_{v \in A}  d_G (v) - 2 e(A) \\
        &\geq q r  \left (1 - \frac 1 r + \varepsilon \right )n - 2 \frac{(q r)^2}{2}.
\end{align*}
Y acotamos por arriba:
\[
    e(A,B) \leq \abs X  q r + ( \abs B - \abs X) ( q (r-1) + t - 1).
\]
Juntando ambas desigualdades, tenemos:
\[
    n\underbrace{(q r \varepsilon - t  + 1)}_{>0} + q^2 (- r^2 +r - 1) - q (t- 1) \leq \abs X \underbrace{( q - t +1)}_{> 0}
\]
Por lo tanto, se sigue lo que queremos cuando $n \to \infty$.

Finalmente, demostramos que existen conjuntos
\[
    B_i \subset A_i \text{ con } \abs {B_i} = t \text{ y $t$ vértices $x \in X$ que satisfacen } N_G (x) \supset B_i,
\]
de donde concluiremos que $K_{r+1} (t) \subset G$.
Sea $x \in X$, existen a lo más $\binom q t$ formas de elegir $B_i^x$ en $A_i$, donde $B_i^x$ satisface $\abs{B_i^x} = t$ y $N_G (x) \subset B_i^x$. Si $\abs X > \binom q t ^r \cdot (t-1)$, entonces por el principio del palomar tenemos lo que queremos.
\end{proof}

\begin{proof}[Demostración del Teorema]
Observemos que $H$ está contenido en el grafo $\chi (H)$-partito, completo y con partes de tamaño $\abs H$, es decir, en $K_{\chi (H)} (\abs H)$. Con lo cual, basta probar el teorema para $H' := K_{r} (t)$ con $r := \chi (H)$ y $t := \abs H$. De hecho, probaremos que para cualquier $r \geq 2$, $t \in \naturals$, $ \varepsilon > 0$, existe $n_0 \in \naturals$ tal que:
\[
    \ex n { K_{r} (t)} \leq \left (1 - \frac 1 {r-1} + \varepsilon \right ) \frac{n^2}{2} \quad (n \geq n_0).
\]

Sea $\varepsilon > 0$ arbitrariamente pequeño. Sea $n$ lo suficientemente grande, y $G$ con $n$ vértices tal que
\[
    e(G) \geq \left ( 1 - \frac 1 {r-1} + \varepsilon \right ) \frac{n^2}{2}.
\]
Aplicamos el primer lema \ref{lema:erdos-stone lema 1} con $c = 1 - \frac 1 {r-1} + \varepsilon$ y $\frac{\varepsilon}{2}$. Así, obtenemos un subgrafo $G' \subset G$ con
\[
    \abs{G'} \geq \frac{\varepsilon}{2} n \quad \text y \quad \delta (G') \geq \left ( 1 - \frac 1 {r-1} + \frac{\varepsilon}{2} \right ) \abs{G'}.
\]
Como $n$ es lo suficientemente grande: $\frac{\varepsilon}{2} n \geq n_0$, y por el segundo lema \ref{lema:erdos-stone lema 2}, $G'$ contiene a $K_{r} (t)$, y por lo tanto $G$ también. El resultado se sigue.
\end{proof}


\begin{definition}
$G$ está \textbf{$t$-cerca} de ser $r$-partito si existe un subgrafo $r$-partito de $G$ con al menos $e(G) - t$ aristas.
\end{definition}





\begin{theorem}[Teorema de Estabilidad de Erdös-simonovits]\label{Teorema de Estabilidad de Erdos-simonovits version H general}
Para todo grafo $H$ con $e(H) \geq 1$, para todo $\varepsilon > 0$ existe $\delta > 0$ tal que: si $G$ es $H$-libre en $n$-vertices y
\[
    e(G) \geq \left ( 1 - \frac {1}{\chi (H) - 1} - \delta \right) \binom n 2.
\]
Entonces $G$ está $(\varepsilon n^2)$-cerca de ser $(\chi (H) - 1)$-partito.
\end{theorem}

Haremos la demostración con $H = K_{r+1}$ y para $H$ general lo haremos con el Lema de Regularidad \ref{theorem:lema de regularidad de szemeredi}.

\begin{quote}\label{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}
Para todo $\varepsilon > 0$ lo suficientemente chico, existe $\delta > 0$ tal que: si $G$ es $K_{r+1}$-libre en $n$-vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta\right) \overbrace{\binom n 2}^{\sim \frac {n^2}2},
\]
entonces $G$ está $(\varepsilon n^2)$-cerca de ser $r$-partito.
\end{quote}

Requerimos probar dos lemas previos:

\begin{lemma}\label{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 1}
Sea $r \in \naturals$ y $\delta > 0$ y $n$ suficientemente grande. Si $G$ es $K_{r+1}$-libre con $n$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta^2\right) \frac{n^2}2,
\]
entonces existe $G' \subset G$ con $\abs{G'} \geq (1 - \delta)n $ y
\[
    \delta (G') \geq \left ( 1 - \frac 1 r - \delta \right) \abs { G'}.
\]
\end{lemma}
\begin{proof}
De la demostración del Lema \ref{lema:erdos-stone lema 1} se deduce un enunciado más fuerte:
\begin{quote}
Dados $r \in \naturals$ y $c\in (0,1)$. Para todo $\varepsilon > 0$ existe $n_0 \in \naturals$ tal que para todo grafo $G$ con $n \geq n_0$ vértices y
\[
    e(G) \geq c \frac{n^2}{2},
\]
existe un subgrafo $G_{t} \subset G$ con $\abs {G_t} = t \geq \varepsilon n$ y $\delta (G_t) \geq (c- \varepsilon) \abs{G_t}$; más aún,
\[
    e(G) \leq e(G_t) + (c- \varepsilon) (n-t) (n+t+1)/2.
\]
\end{quote}

Ahora, dado $\delta > 0$, el cual sin pérdida de generalidad lo podemos asumir $\delta < \frac 1 2$, tomamos $c := \left ( 1 - \frac 1 r - \delta^2 \right ) > 0$ y $\varepsilon = \delta - \delta^2>0$. Supongamos que $G$ es un grafo con $n$ vértices $K_{r+1}$-libre, y
\[
    e(G) \geq \left ( 1 - \frac 1 r - \delta^2 \right ) \frac{n^2}{2} = c \frac {n^2}{2},
\]
luego existe un subgrafo $G_t \subset G$ con $t \geq (\delta - \delta^2) n$ vértices. Como en la demostración de la Observación \ref{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2} se ve que $t_r (t) \sim  \left ( 1 - \frac 1 r \right) \frac{t^2}{2} \:\: (t \to \infty)$, podemos suponer que existe $n_0 \in \naturals$ tal que si $n \geq n_0$, entonces $t_r (t) \leq \left ( 1 - \frac 1 r + \gamma \right ) \frac{t^2}{2}$, para $\gamma := \frac{\delta^2}{2}$.

Ahora, como $G$ es $K_{r+1}$-libre, entonces $G_t$ también y se tiene que
\[
    e(G_t) \leq \ex t {K_{r+1}} \leq t_r (t) \leq \left (1 - \frac 1 r + \frac{\delta^2}{2} \right) \frac{t^2}{2},
\]
por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}. Juntando esto con lo mencionado al principio, tenemos que
\begin{align*}
    c \frac{n^2}{2} \leq e(G) &\leq e (G_t) + (c- \varepsilon) (n-t) (n+t+1)/2 \\
    &\leq \left (1 - \frac 1 r + \frac{ \delta^2}2 \right) \frac{t^2}{2} + (c- \varepsilon) (n-t) (n+t+1)/2 \\
    &= \left (1 - \frac 1 r + \frac{ \delta^2}2 \right) \frac{t^2}{2} + (c- \varepsilon) \frac{(n^2 + n - t^2 - t)}{2},
\end{align*}
esto implica que para $n$ lo suficientemente grande de tal suerte que $\frac{(c - \varepsilon)}{2} n \leq \frac{\varepsilon }{2} \frac{n^2}{2}$,
\[
    \varepsilon \frac{n^2}{4}  \leq (\delta + \frac{\delta^2}{2}) \frac{t^2}{2}.
\]
Reemplazando $\varepsilon = \delta - \delta^2$ en la última desigualdad, y despejando $t$:
\[
    \sqrt{\frac{\delta - \delta^2}{2 \delta + \delta^2}} n \leq t.
\]
Como la expresión de la izquierda es más grande que $(1 - \delta)$ cuando $\delta < \frac 1 2$, se sigue que para todo $n$ lo suficientemente grande,
\[
    \abs {G_t}  = t \geq (1 - \delta) n.
\]
Es decir, $G_t$ es el subgrafo $G'$ de $G$ que cumple las propiedades deseadas del enunciado.
\end{proof}

\begin{lemma}\label{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2}
Para todo $r \in \naturals$, para todo $\varepsilon > 0$, existe $\delta > 0$ tal que si $G$ es $K_{r+1}$-libre con $n$ vértices y
\[
    \delta (G) \geq \left ( 1 - \frac 1 r - \delta \right) n,
\]
entonces existe una partición $V(G) = A_0 \coprod A_1 \coprod \cdots \coprod A_r$ tal que $\abs {A_0} \leq \varepsilon n$ y $A_i$ son conjuntos independientes para todo $i \geq 1$.
\end{lemma}
\begin{proof}
Si tomamos $\delta >0$ lo suficientemente pequeño, entonces $G$ contiene una copia de $K_r$ por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)} (esto ocurre si $e(G) \geq \left ( 1 - \frac 1 {r-1} \right)\frac{n^2}{2}$; tomar $\delta < \frac 1 {r-1} - \frac 1 r$ y notar que en la demostración de la Observación \ref{obs:tenemos que el numero de turan es asintotico a (1-1/r)n2/2} se ve que $t_r (t) \sim  \left ( 1 - \frac 1 r \right) \frac{t^2}{2} \:\: (t \to \infty)$).

Sea $A$ un conjunto de vértices que induce un $K_r$ en $G$. Sean $B := V(G) \setminus A$ y $X := \set{v \in V(G) | \abs{N_G (v) \cap A} \leq r -2}$, vamos a mostrar que $X$ es pequeño.
\begin{align*}
\left ( 1 - \frac 1 r - \delta \right ) n r - r (r-1) &\leq e(A, B) \quad \quad \left ( 2 e(A) + e(A,B) = \sum_{v \in A} d_G (v) \geq r \left (1 - \frac 1 r - \delta \right )n \right )\\
                &\leq (r-1) \large ((n-r) -\abs X \large) + (r-2) \abs X  = (r-1) (n-r) - \abs X,
\end{align*}
manipulando la desigualdad, obtenemos:
\[
    \abs X \leq \delta n r.
\]
Tomando $\delta < \min \{\frac{\varepsilon}{r}, \frac 1{r-1} - \frac 1 r\}$, el $A_0$ será $X$ y los consjuntos independientes son:
\[
    A_u = \{u\} \cup \{v \in B \setminus X | vu \not \in E(G)\}
\]
para cada $u \in A$.
\end{proof}

Ahora estamos en condiciones de demostrar el Teorema de Estabilidad de Erdos-Simonovits para $H = K_{r+1}$ \ref{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}:

\begin{proof}[Demostración del Teorema de Estabilidad de Erdos-Simonovits para $H =K_{r+1}$ \ref{Teorema de Estabilidad de Erdos-simonovits version H un r+1 completo}]

Sea $\varepsilon > 0$ chico, tomemos $\delta = (\delta ')^2$ donde $\delta'$ se obtiene del Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2} con $\varepsilon ' < \frac \varepsilon 2$. Notar que de la demostración podemos suponer que si $\varepsilon > 0$ es chico, luego $\delta ' < \frac {\varepsilon ' }2$ también. Por hipótesis
\[
    e(G) \geq \left ( 1 - \frac 1 r - (\delta ')^2 \right ) \frac{n^2}{2},
\]
entonces por el Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 1}: existe $G' \subset G$ con $n' := \abs{G'} \geq ( 1 - \delta ')n$ y $\delta (G') \geq \left ( 1 - \frac 1 r - \delta' \right) \abs {G'} = n'$. Por el Lema \ref{lemma: Teorema de Estabilidad de Erdos-simonovits - lema 2}: para $\varepsilon ' < \frac \varepsilon 2$ se tiene que existe $A_0, A_1, \ldots, A_r$ partición de $G'$ con $\abs {A_0} < \varepsilon ' n ' \leq \varepsilon ' n$ y $A_i$ conjuntos independientes para todo $i \geq 1$. Así el subgrafo generado por los $A_i$ con $i \geq 1$ es $r$-partito. Además, para obtener este subgrafo, hay que quitar a lo más
\[
    \varepsilon ' n ^2 + \varepsilon ' n^2 < \varepsilon n^2 \quad \quad ( \delta , \delta ' \ll 1)
\]
aristas de $G$, es decir, $G$ está $\varepsilon n^2$-cerca de ser $r$-partito. En efecto, las aristas de $G[V(G) \setminus V(G')]$ junto con $E_G(V(G'), V(G) \setminus V(G'))$ aportan $\leq \binom { \delta ' n} 2 + n' \cdot (n - n') \leq \delta ' n^2 + \delta ' n^2 \leq \varepsilon ' n^2$, y las de $G[V(A_0)]$ junto con $E_G(V(A_0), V(G) \setminus V(A_0))$ aportan
\[
    \leq \binom{\varepsilon' n}2 + (\varepsilon ' n) \cdot (\delta ') n \leq \varepsilon ' n^2.
\]
\end{proof}







\section{Ejercicios}

\begin{exercise}
Puebe el teorema de Mantel de manera alternativa. Considere un conjunto independiente $B$ de tamaño máximo en un grafo $K_3$-libre  y la suma de los grados de los vértices que no están en $B$.
\end{exercise}

\begin{solution}
Sea $G$ un grafo $K_3$-libre con orden $n$ y $B$ un conjunto independiente de $G$ de tamaño máximo; consideremos $A := V(G) \setminus B$. Inspeccionemos la sumatoria
\[
    \sum_{v \in A} d_G (v);
\]
notar que $d_G (v) = \abs{N_G (v)}$ y que $N_G (v)$ es un conjunto de vértices aislados en $G$: si $x,y$ son dos vecinos de $v$ entonces $xy \not \in E(G)$ porque de lo contrario $G$ tendría un triángulo $xyv$. Así, como $\abs B$ es máximo, se sigue que $\abs{N_G (v)} \leq \abs B$. Esto implica que
\[
    \sum_{v \in A} d_G (v) \leq \abs A \abs B   .
\]
Más aún, como $A,B$ particionan $V(G)$: $\abs A + \abs B = n$. Luego $\abs{A} \cdot \abs B$ se maximiza cuando $\abs A \abs B = \floor{\frac n 2} \ceil{\frac n 2} = t_2 (n)$. Así,
\[
    e(G) = e(A,B) + e(A) \leq e(A,B) + 2 e(A) = \sum_{v \in A} d_G (v) \leq t_2 (n),
\]
como queríamos probar.
\end{solution}

\begin{remark}
Que $\abs A \cdot \abs B$ con $\abs A + \abs B = n$ se maximiza cuando $\abs A \cdot \abs B = \floor {\frac n 2} \ceil {\frac n 2}$ se deduce de que reemplazando $\abs B = n - \abs A$, el problema equivale a maximizar $\abs A \cdot (n - \abs A)$. Más formalmente, el problema equivale a maximizar $f (x) = x (n - x)$ con $x$ número natural en el intervalo $[0, n]$. Simplemente notemos que $f'(x) = n - 2 x$, luego $f$ es creciente en $[0, \frac n 2]$ y decreciente en $[ \frac n 2 , n]$, pero como $\floor{\frac n 2}$ es el mayor número entero $\leq \frac n 2$, $f$ alcanza máximo en $[0, \frac n 2]$ cuando $x = \floor {\frac n 2}$, similarmente, $f$ alcanza máximo en $[\frac n 2, n]$ cuando $x = \ceil{\frac n 2}$. Como $f(\floor{\frac n 2}) = f (\ceil {\frac n 2})$, se sigue que $f$ se maximiza en $x = \floor {\frac n 2}$ y $x = \ceil {\frac n 2}$, es decir, el valor máximo de $f$ es $f (\floor{\frac n 2}) = \floor{\frac n 2} \ceil{\frac n 2}$.
\end{remark}


\begin{exercise}
Demuestre que si $G$ es un grafo con $n = 2k+1$ vértices, entonces $G$ contiene un camino de largo $k$, digamos $P_k$, o el complemento de $G$ tiene un triángulo.
\end{exercise}
\begin{solution}
Supongamos por el absurdo que ninguna de las dos situaciones pasa. Por un lado, si el complemento $\bar G$ de $G$ no contiene triángulos, el Teorema de Mantel nos dice que
\[
    e(\bar G) \leq \ex n {K_3} \leq k (k+1).
\]
Como $(2k + 1) k = \binom n 2 = e(G) + e(\bar G)$, deducimos que
\[
    k^2 \leq e(G).
\]

Por otro lado, si $G$ no contiene $P_k$-caminos, el Teorema de Erdös \& Gallai dice que
\[
    e(G) \leq \ex n {P_k} \leq \frac{(k-1)n}{2} = \frac{(k-1)(2k+1)}{2}.
\]

Juntando ambas desigualdades, llegamos al absurdo:
\[
    k^2 \overset{!!!}{\leq} \frac{(k-1)(2k+1)}{2}.
\]
Por lo tanto, $G$ contiene un $P_k$-camino o $\bar G$ un triángulo.
\end{solution}

\begin{exercise}
Demuestre que si $T$ es un árbol con $k$ vértices, entonces $T\subseteq G$ o el complemento de $G$ contiene un triángulo si $n := \abs G = 2k -1$.
\end{exercise}

\begin{solution}
Supongamos por el absurdo que $G$ es un grafo con $n = 2k-1$ vértices que no contiene a un árbol $T$ con $k$ vértices, y que $\bar G$, su complemento, no contiene triángulos. En particular, la primera suposición implica que $\delta (G) \leq k-2$ por el siguiente lema, cuya demostración vimos en clase:
\textit{
\begin{quote}
Sean $t \in \naturals$ y $T$ un árbol con $t+1$ vértices. Entonces si $G$ es un grafo con $\delta (G) \geq t$, luego contiene a $T$ como subgrafo.
\end{quote}
}
Mientras que la segunda suposición ($\bar G$ no tiene triángulos), implica que dado un vértice $w \in V(G)$, entonces para cada par de vértices $w', w''$ no adyacentes a $w$ se tiene que $w' w'' \in E(G)$. En otras palabras, para todo $w \in V(G)$, el subgrafo $G[A_w]$ inducido por el conjunto $A_w := V(G) \setminus \left\{N_G (w) \cup \{w\} \right\}$ es completo; notar que como $\abs {A_w} = n - (d_G (w) +1)$, este grafo es isomorfo a $K_{n - d_G (w) - 1}$.

Finalmente, para llegar al absurdo, consideremos $v \in V(G)$ un vértice con grado $d_G (v) = \delta (G) \leq k-2$, entonces $G[A_v]$ es un subgrafo de $G$ isomorfo a $K_{n - \delta(G) - 1}$, i.e. un completo con al menos
\[
    n - \delta (G) - 1 = (2k -1) - \delta (G) - 1 \geq (2k-1) - (k-2) - 1 = k
\]
vértices, luego contiene una copia de $T$, con lo cual $G$ también: absurdo. Consecuentemente, $G$ contiene una copia de $T$ o $\bar G$ tiene triángulo(s).
\end{solution}

\begin{solution}[Segunda solución]
Otra manera de resolver el ejercicio es haciendo inducción $k \geq 1$: supongamos que $G$ es un grafo de orden $2k-1$ con $\bar G$ libre de triángulos, probaremos que $T \subset G$ para cualquier árbol $T$ de orden $k$. El caso $k=1$ es trivial.

En general, supongamos que $k \geq 2$ y tomemos una hoja $h$ de $T$, consideremos $T' := T \setminus \{h\}$ y escribamos $p \in T'$ para el padre de $h$ en $T$. Ahora, si $G$ es completo ya ganamos, pues $K_{2k-1} \supset T$, con lo cual podemos suponer que existen $v,w \in V(G)$ tales que $vw \not \in G$, y consideremos $G' := G \setminus \{v,w\}$. Notar que $\bar{G}'$ es $K_3$-libre y $G'$ tiene orden $2(k-1) -1$, luego por hipótesis inductiva $G'$ contiene a $T'$. Por otro lado, $p \in T'$ tiene que ser vecino de $w$ o de $v$ en $G$, de lo contrario $\bar G$ tendría un triángulo! Esto prueba que $T \subset G$.
\end{solution}

\begin{exercise}
Pruebe que si $e(G)> n^2/4$, entonces $G$ contiene al menos $\lfloor n/2 \rfloor$ triángulos.
\end{exercise}
\begin{solution}
El Teorema de Füredi (2015) dice:
\textit{
\begin{quote}
Sean $n,t \in \naturals$, y $G$ con $n$ vértices. Si $G$ está $t$-lejos de ser bipartito, entonces hay al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos en $G$.
\end{quote}
}

Sea $H \subset G$ el subgrafo bipartito con cantidad de aristas $e(H)$ máxima de $G$. Como $e(H) \leq \frac {n^2}{2} < e(G)$, tenemos que $H \subsetneq G$; y podemos escribir $t := e(G) - e(H) \geq 1$. En particular, como $e(H)$ es máximo, tenemos que $G$ está $t$-lejos de ser bipartito. Con lo cual, el Teorema de Füredi implica que $G$ contiene al menos
\[
    \frac{n}{6} \left(e(G)-\frac{n^2}{4}+t\right)
\]
triángulos; en particular, si $e(G) - \frac{n^2}{4} + t \geq 3$ ganamos, pues en este caso habrían al menos $\frac{n}{2} \geq \floor{\frac n 2}$ triángulos. Por otro lado, esta cantidad es menor que $3$ si y solo si $t =1$ y $H = T_2 (n)$. En este caso, $H = K_{\floor{\frac n 2}, \ceil{\frac n 2}}$. Tomemos una aristas $f \in E(G) \setminus E(H)$, con lo cual $f$ tiene sus extremos en una de las dos particiones de $H$; en el peor de los casos está en la partición más grande, es decir, para todo vértice $v$ de la partición de $H$ con menor cantidad de vértices: $\floor{\frac n 2}$, se forma un triángulo distinto con vértices $v$ y los extremos de $f$. En particular, $G$ contiene en este caso al menos $\floor{\frac n 2}$ triángulos.
\end{solution}

\begin{exercise}
Sean $G$ y $H$ grafos. Demuestre que si $G$ tiene $n$ vértices y al menos $2 \cdot \ex n H$ aristas, entonces $G$ contiene al menos $\ex n H$ copias de $H$.
\end{exercise}
\begin{solution}
Supongamos que $G$ no contiene $e := \ex n H $ copias de $H$, luego quitando una arista por cada copia de $H$ en $G$ obtenemos un grafo $H$-libre con al menos $e(G) - (e-1) \geq 2 e - (e-1) = e + 1$ aristas. Sin embargo, por definición de $e$, se sigue que este grafo tiene a lo más $e$ aristas, absurdo. Esto prueba que $G$ tiene al menos $e$ copias de $H$.
\end{solution}

\begin{exercise}
Sea $k \in \mathbb{N}$ y $n\in \mathbb{N}$ suficientemente grande.
Demuestre que todo grafo $G$ con $n$ vértices y al menos $n^2/4$ aristas contiene un grafo $H$ con al menos $k$ vértices y $\delta(H)\geq \frac{\abs H}{2}$.
\end{exercise}
\begin{solution}
Probaremos un enunciado más fuerte:
\textit{
\begin{quote}
Sea $k \in \naturals$ y $n \in \naturals$ suficientemente grande. Entonces todo grafo $G$ con $n$ vértices y al menos $\frac{n^2}{4}$ aristas contiene a $H:= K_{k,k}$.
\end{quote}
}

Esto prueba el ejercicio pues el grafo $H := K_{k,k}$ tiene $2k \geq k$ vértices y $\delta (H) = k = \frac {v(H)}{2}$.

Ahora probemos este enunciado más fuerte. Para eso utilizaremos el Teorema de Kövani, Sós, y Turán (abreviado ``KST''):
\textit{
\begin{quote}
Sean $s, t \in \naturals$, $s \leq t$. Entonces existe una constante $c = c(s,t) > 0$ tal que
\[
    \ex n {K_{s,t}} \leq c \cdot n^{2 - \frac 1 s}, \quad \forall n \in \naturals;
\]
\end{quote}
}
lo aplicamos al caso $s = t = k$.

\bigskip

Así, el Teorema de KST dice que
\[
    \ex n H \leq c \cdot n^{2 - \frac 1 k}, \quad \forall n \in \naturals
\]
con $c > 0$ una constante que depende solo de $k$.
Tomando $n_0 \in \naturals$ para que $\frac{n^2}{4} > c n^{2 - \frac 1 k}$ valga para todo $n\geq n_0$, se sigue que $G$ siempre debe tener a $H$ como subgrafo: de lo contrarío se llegaría al absurdo:
\[
    \frac{n^2}{4} \leq e(G) \leq \ex n H \leq c n^{2 - \frac 1 k}.
\]
\end{solution}

\begin{solution}[Segunda solución]
Por el Lema \ref{lema:lema 2 - teorema de extremalidad de arboles}, $G$ contiene un subgrafo $H'$ tal que
\[
    \delta (H') > \varepsilon (H') \geq \varepsilon (G).
\]
Como $\varepsilon (G) = \frac{e(G)}{\abs G} \geq \frac{n}{4}$, se tiene que para $n$ lo suficientemente grande, $H'$ contiene a $K_{1, k}$, y por lo tanto $H := K_{1,k}$ sirve. En efecto,
\[
    \delta (H) = k \geq \frac{k+1}{2} = \frac{\abs H}{2}.
\]
\end{solution}







\section{Regularidad}

\begin{definition}
Dada una partición de los vértices de un grafo $G$, digamos $ V(G) = X \coprod Y$, definimos la \textbf{densidad} del par $(X,Y)$ como la cantidad
\[
    d(X,Y) := \frac{e(X,Y)}{\abs X \abs Y}.
\]
\end{definition}

\begin{definition}
Dado $\varepsilon > 0$. Sean $A,B \subset V(G)$ con $G$ un grafo. Diremos que el par $(A,B)$ es \textbf{$\varepsilon$-regular} si para todo $X  \subset A$, $Y \subset B$ con
\[
    \abs X \geq \varepsilon \abs A \quad \text e \quad \abs{Y} \geq \varepsilon \abs B
\]
tenemos
\[
    \abs{d (X,Y) - d(A,B)} \leq \varepsilon.
\]
\end{definition}

\begin{definition}
Sea $G$ un grafo. Una partición $V(G ) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$, se dice \textbf{equipartición}, si
\[
    \abs {V_0} \leq \abs{V_1} = \abs{V_2} = \cdots = \abs{V_k}.
\]
Al conjunto $V_0$ lo llamamos \textbf{conjunto excepcional}.
\end{definition}

\begin{definition}
Sea $G$ un grafo con $n$ vértices y $\varepsilon > 0$. Diremos que una partición $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ es \textbf{$\varepsilon$-regular}, si $\abs{V_0} \leq \varepsilon n$ y a lo más $\varepsilon k^2$ pares $(V_i,V_j)$ con $1 \leq i , j \leq k$ no son $\varepsilon$-regulares.
\end{definition}

\begin{theorem}[Lema de Regularidad de Szemerédi]\label{theorem:lema de regularidad de szemeredi}
Para todo $\varepsilon > 0$, $m \in \naturals$, existe $M = M (\varepsilon, m) \in \naturals$ tal que para cualquier grafo $G$ con $\abs G \geq M$, existe una \underline{equipartición} $\varepsilon$-regular
\[
    V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k
\]
con $m \leq k \leq M$.
\end{theorem}
\begin{proof}
\begin{definition}
Dado un grafo $G$ con $n$ vértices y partición de sus vértices $\mathcal P = \{ V_1, \ldots, V_k \}$, definimos la \textbf{media cuadrática} del par $(V_i,V_j)$ para cada $i\neq j$ como
\[
    d_2 (V_i , V_j) := \frac{e(V_i,V_j)^2}{\abs{V_i} \abs {V_j} n^2},
\]
y la \textbf{media cuadrática} de la partición $\mathcal P$ como
\[
    d_2 (\mathcal P) = \sum_{1 \leq i < j \leq k} d_2 (V_i, V_j) = \sum_{1 \leq i < j \leq k} \frac {\abs {V_i} \abs{ V_j}}{n^2} d(V_i, V_j)^2 \leq 1.
\]
\end{definition}

\begin{definition}
Una partición $\mathcal P'$ de $G$ se dice que \textbf{refina} a una partición $\mathcal P$ (o que es un \textbf{refinamiento} de $\mathcal P$) si cada parte de $\mathcal P$ es una unión de algunas partes de $\mathcal P'$.
\end{definition}

\begin{lemma}
Si $\mathcal P'$ es un refinamiento de $\mathcal P$, entonces
\[
d_2 (\mathcal P') \geq d_2 (\mathcal P).
\]
\end{lemma}

\begin{lemma}
Sea $G$ un grafo y $\mathcal P$ una partición de $V(G)$. Si $(X,Y)$ es un par no $\varepsilon$-regular en $\mathcal P$. Entonces, existen particiones $\{X_1, X_2\}$ de $X$ y particiones $\{Y_1, Y_2\}$ de $Y$ tales que
\[
\sum_{1 \leq r, s \leq 2} \frac{\abs{X_r} \abs{Y_s}}{n^2} \cdot d(X_r, Y_s)^2 \geq d(X,Y)^2 + \varepsilon^4.
\]
\end{lemma}

\begin{lemma}
Sea $G$ un grafo con $n$ vértices y $\mathcal P$ partición de $G$ que no es $\varepsilon$-regular. Entonces existe un refinamiento $\mathcal P'$ de $\mathcal P$ tal que:
\begin{enumerate}[(i)]
\item $d_2 (\mathcal P') \geq d_2 (\mathcal P) + \varepsilon^5$.
\item $\# \mathcal P ' \leq k \cdot 2^{k-1}$.
\end{enumerate}
\end{lemma}

Ahora, veamos la demostración del teorema. Sea $\mathcal P_0 = \{V_0, V_1, \ldots, V_m\}$ una partición de $G$ con $\underbrace{\abs {V_0}}_{1 \leq \abs{V_0} \leq m-1} = n - n \floor{\frac n m}$ y $\abs{V_i} = \floor{\frac{n}{m}}$ para todo $i = 1 , \ldots, m$. Si $\mathcal P_0$ no es $\varepsilon$-regular, existe $\mathcal P_1$ refinamiento de $\mathcal P_0$ tal que $d_2 (\mathcal P_1) \geq d_2 (\mathcal P_0) + \varepsilon^5$ y
\[
\abs{\mathcal P_1} \leq m \cdot 2^m.
\]

Ahora, obtenemos una equipartición de $\mathcal P_1'$ a partir de $\mathcal P_1$: particionando cada parte de $\mathcal P_1$ en conjuntos de tamaño
\[
\frac{\frac{\varepsilon^6}{2}n}{\# \mathcal P _1},
\]
y un conjunto despreciable de tamaño $< \frac{\frac{\varepsilon^6}{2}n}{\# \mathcal P _1}$. En total, el conjunto de los vértices despreciados lo agregamos al \textit{conjunto excepcional} $V_0$, es decir, agregamos $< \frac{\varepsilon^6}{2}n$ vértices. Afirmamos que $\mathcal P_1'$ está acotado por arriba por algo que depende de $\varepsilon$ y $m$:
\[
\# \mathcal P _ 1 ' \leq \frac{n}{\frac{\varepsilon^6 n}{2}}\big / \# \mathcal P_1 = \frac{2 \# \mathcal P _1}{\varepsilon^6} \leq \frac{m2^{m+1}}{\varepsilon^6}.
\]
Por el primer lema, $d_2 (\mathcal P_1 ') \geq d_2 (\mathcal P_1) \geq d_2 (\mathcal P_0) + \varepsilon^5$.

Si no obtenemos una partición $\varepsilon$-regular, entonces continuamos refinando, para así obtener una secuencia de equiparticiones:
\[
\mathcal P_0, \mathcal P _1 ' , \mathcal P_2 ' , \ldots, \mathcal P _k'.
\]
Como $d_(\mathcal Q) \leq 1$ para cualquier partición $\mathcal Q$ de $G$, y $d_2 (\mathcal P_{i+1}) \geq d_2 (\mathcal P_i') + \varepsilon^5$, tenemos que $k \leq \varepsilon^{-5}$.
Entonces, luego de a lo más $\varepsilon^{-5}$ iteraciones, habremos encontrado una partición $\varepsilon$-regular con una cantidad de partes acotada por $M$ que solamente depende de $m $ y $\varepsilon$. Por último, el conjunto excepcional de dicha partición es
\[
\leq (m-1) + \frac{\varepsilon^6 n}{2} \varepsilon^{-5} < \varepsilon n.
\]


\end{proof}

\begin{corollary}
Se puede probar el Teorema de Erdös-Stone \ref{th:teorema de Erdos-stone}:
\begin{quote}
Dado un grafo $H$, para todo $\delta >0$ existe $n_0 \in \naturals$ tal que si $G$ es un grafo con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 r + \delta \right ) \frac{n^2}{2},
\]
entonces $H \subset G$, donde $r = \chi (H) - 1$.
\end{quote}
\end{corollary}

La idea de la demostración del corolario será la siguiente:

\bigskip

Tomemos $\delta > 0$ arbitrariamente pequeño, aplicamos el Lema de Regularidad de Szemeredi con $\varepsilon $ lo suficientemente pequeño y $m > \frac 1 \varepsilon$. Así existe $M \in \naturals$, y obtenemos una equipartición $\varepsilon$-regular
\[
 V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k,
\]
con $M \geq k \geq m > \frac 1 \varepsilon$, de cualquier grafo $G$ con $\abs G \geq M$.

Borramos de $G$ todas las aristas sobre las que ``no hay control'':
\begin{enumerate}[(a)]
\item Las que ven a $V_0$.
\item Aristas dentro de las partes $V_i$ con $i \geq 1$.
\item Las aristas entre pares no $\varepsilon$-regulares.
\item Aristas entre pares no densos, i.e., ``tenemos menos que $\delta / 2$ densidad''.
\end{enumerate}

Después, obtenemos el gafo reducido $R$: dado por contraer cada $V_i$ a un vértice $w_i$ con $i \geq 1$, y borrar aristas múltiples. Así, $R$ tiene conjunto de vértices $w_1, \ldots, w_r$ donde $w_{i}w_j \in E(R)$ sii $(V_i, V_j)$ es $\varepsilon$-regular y denso.

Aplicamos lemas de inmersión en ``aristas'' de grafo - grafo reducido:
\[
    \text{Si $H \subset R$} \quad \Rightarrow \quad H \subset G.
\]

\begin{lemma}\label{lema:regularidad de szemeredi - lema 1}
Sea $V_0 \coprod V_1 \coprod \cdots \coprod V_k$ una partición $\varepsilon$-regular de un grafo $G$ de $n$ vértices, con $k \geq \frac 1 \varepsilon$. Entonces, hay un máximo de:
\begin{enumerate}[(a)]
\item $\varepsilon n^2$ aristas con un extremo en $V_0$.
\item $\varepsilon n^2$ aristas dentro de una parte $V_i$ con $i\geq 1$.
\item $\varepsilon n^2$ aristas entre pares (con $i,j \neq 0$) que no son $\varepsilon$-regulares.
\item $\delta n^2$ aristas entre pares (con $i,j \neq 0$) de densidad $< \delta$.
\end{enumerate}
\end{lemma}
\begin{proof}
\begin{enumerate}[(a)]
\item Como $\abs{V_0} \leq \varepsilon n$ entonces hay a lo más
\[
    \varepsilon n (1-\varepsilon) n + \binom{\varepsilon n}{2} < \varepsilon n^2 \text{ aristas en (a)}.
\]
\item Cada $V_i$ tiene $\leq \frac n k$ vértices (pues estamos en una equipartición), y entonces hay a lo más $k \cdot \binom{\frac n k}{2} \leq \frac \varepsilon 2 n^2$ aristas para (b).
\item Hay a lo más $\varepsilon k^2$ pares que no son $\varepsilon$-regulares y cada par tiene a lo más $\left ( \frac n k \right)  ^2$ aristas entre sí. Consecuentemente, aportan a lo más $\varepsilon k^2 \cdot \left ( \frac n k \right )^2 = \varepsilon n^2$ aristas en (c).
\item En el peor caso, los $\binom k 2$ pares son poco densos. En este caso, por definiciónde densidad:
\[
    e(V_i, V_j) \leq \delta \left ( \frac n k \right )^2, \quad \forall 1 \leq i, j \leq k,
\]
y entonces, hay a lo más $\delta \left ( \frac n k \right )^2 \binom k 2 \leq \delta n^2$ aristas en pares ``poco densos'', i.e., en (d).
\end{enumerate}
\end{proof}

\begin{lemma}\label{lema:regularidad de szemeredi - lema 2}
Sea $\varepsilon > 0$, y sea $(A,B)$ un par $\varepsilon$-regular de un grafo $G$. Entonces,
\[
    \big ( d(A,B) - \varepsilon \big ) \abs B \leq \abs{N_G (v) \cap B} \leq \big ( d(A,B)
    + \varepsilon \big ) \abs B
\]
para todo $v \in A$, salvo a lo más $2 \varepsilon \abs A$.
\end{lemma}
\begin{proof}
Consideremos el conjunto $X \subset A$ de los vértices que no cumplen alguna de las dos desigualdades. Probaremos que $\abs X < 2 \varepsilon \abs A$ por el absurdo. Si este no fuera el caso, tendríamos que $\abs X \geq 2 \varepsilon \abs A$ y por lo tanto hay al menos $\varepsilon \abs A$ vértices que no cumplen la primera desigualdad o la segunda. Supongamos que estamos en el perimer caso, el segundo caso es análogo. Es decir, supongamos que existe un conjunto $X' \subset A$ con $\abs{X'} \geq \varepsilon \abs A$ tal que para todo $v \in X'$,
\[
    \big ( d(A,B) - \varepsilon \big) \abs B > \abs{N_G (v) \cap \abs B}.
\]
Sumando en la desigualdad anterior sobre todos los $v \in X'$, tenemos que
\[
    \big ( d(A,B) - \varepsilon \big ) \abs B \abs A > e(X', B),
\]
por lo tanto $\big ( d (A,B) - \varepsilon \big ) >d(X', B)$, i.e.,
\[
    \abs {d(A,B) - d(X', B)} > \varepsilon.
\]

Consideremos ahora $Y' = B$, en particular $\abs {Y'} \geq \varepsilon \abs B$ si $\varepsilon > 0$ es chico. Luego por $\varepsilon$-regularidad del par $(A,B)$, tenemos que
\[
    \abs{d(A,B) - d(X', B)} \leq \varepsilon,
\]
absurdo.
\end{proof}



\begin{lemma}[Slicing]\label{lema:regularidad de szemeredi - lema slicing}
Sea $\alpha \geq \varepsilon > 0$, y sea $(A,B)$ un par $\varepsilon$-regular en un grafo $G$. Para cualquier $X \subset A, Y \subset B$ con
\[
    \abs X \geq \alpha \abs A \quad \text y \quad \abs Y \geq \alpha \abs B
\]
se tiene que el par $(X,Y)$ es $\max\{\frac{\varepsilon}{\alpha}, 2 \epsilon\}$-regular. Además, por $\varepsilon$-regularidad del par $(A,B)$, se tiene que
\[
    \abs {d(X,Y) - d (A,B)} \leq \varepsilon.
\]

\end{lemma}
\begin{proof}
La última afirmación es clara. Veamos la primera, para eso consideremos $\varepsilon ' = \max \{ \frac{\varepsilon}{\alpha} , 2 \varepsilon \}$. Sean $Z \subset X$ y $W \subset Y$ tales que $\abs Z \geq \varepsilon ' \abs X$ y $\abs W \geq \varepsilon ' \abs Y$, entonces $\abs Z \geq \varepsilon \abs A$ y $\abs W \geq \varepsilon \abs B$. Luego por $\varepsilon$-regularidad del par (A,B), se tiene que
\[
    \abs{d(Z,W) - d(A,B)} \leq \varepsilon.
\]
Además, por $\varepsilon$-regularidad del par $(A,B)$, se tiene que
\[
    \abs{d(X,Y) - d(A,B)} \leq \varepsilon.
\]
Juntando ambas desigualdades tenemos que:
\begin{align*}
\abs{d(Z,W) - d(X,Y)} &\leq \abs{ d(Z, W) - d(A,B)} + \abs{d(X,Y) - d(A,B)} \\
    &\leq \varepsilon + \varepsilon \leq 2 \varepsilon \leq \varepsilon '.
\end{align*}
\end{proof}

\begin{definition}[Reducido]
Dado un grafo $H$, $n \in \naturals$, $\varepsilon, \delta > 0$, definimos
\[
    \mathcal G (H,n, \varepsilon, \delta)
\]
como la familia de grafos $G$, tales que existe una equipartición $V(G)  = A_1 \coprod \cdots \coprod A_l$ con $A_i$ de cardinal $n$ e independiente, y un etiquetamiento de los vértices $V(H) = \{w_1, \ldots, w_l\}$ tal que para cada $w_i w_j \in E(G)$, el par $(A_i, A_j)$ es un par $\varepsilon$-regular y además $d(A_i, A_j)\geq\delta$.
\end{definition}

\begin{lemma}[Lema de inmersión general]\label{lema:regularidad de szemeredi - lema inmersion general}
Para todo grafo $H$ y todo $\delta > 0$, existen $\varepsilon > 0$ y $n_0 \in \naturals$ tales que
\[
    G \in \mathcal G (H, n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{lemma}
\begin{proof}
Haremos inducción en $\abs H$. Cuando $\abs H = 1$ es trivial. Supongamos entonces que $\abs H \geq 2$. Escribamos $V(H) = \{w_1, \ldots, w_l\}$ y sea $V(G) = A_1 \coprod \cdots \coprod A_l$ una partición de acuerdo a la definición de $\mathcal G (H, n , \varepsilon , \delta)$: $(A_i, A_j)$ $\varepsilon$-regular y $d(A_i, A_j) \geq \delta$ para cada $i \leq l-1$ tal que $w_i w_l \in E(H)$.

Elijamos $\varepsilon $ lo suficientemente pequeño y apliquemos el Lema \ref{lema:regularidad de szemeredi - lema 2} a cada $(A_i, A_l)$ con $w_i w_l \in E(H)$: todos, excepto a lo más $2 \varepsilon \abs {A_l}$ vértices $v \in A_l$ satisfaciendo:
\[
    \abs{N_G (v) \cap A_i} \geq (\delta - \varepsilon) \cdot \abs{A_i}
\]
\Inkscape[1.5]{}{"./Figuras/Regularidad/Dibujo 1.pdf_tex"}
Como $2 \varepsilon \abs{A_l} (l-1) < n$, existe $v \in A_l$ tal que
\[
    \abs{N_G (v) \cap A_i} \geq (\delta - \varepsilon) \abs{A_i}, \quad \forall i \leq l-1
\]
con $w_i w_l \in E(H)$. Definimos
\[
    \tilde X_i = \begin{cases}
    A_i \cap N_G (v) & \text{ si $w_i \in N_H (w_l)$} \\
    A_i & \text{ si no},
    \end{cases}
\]
y por cada $\tilde X_i$ construimos un subgrafo $X_i$, de manera que todos los $X_i$ tengan el mismo cardinal.

Ahora, tomando $\alpha = \delta - \varepsilon \geq \varepsilon >0 $, podemos aplicar el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing} en $X_i, X_j$ cuando $w_i w_j \in E(H)$ para asegurar que son pares $\max\{\frac{\varepsilon}{\delta - \varepsilon}, 2 \varepsilon\}$-regulares y densidad al menos $\delta - \varepsilon$. Luego queremos usar la hipótesis inductiva: sea $H' := H \setminus \{w_l\}$ y $G':= G[\bigcup_{i = 1}^{l-1} X_i]$. Así, existen $\varepsilon ' > 0$ y $n'_0 \in \naturals$ tales que
\[
    G' \in \mathcal G (H', n', \varepsilon ', \delta - \varepsilon), n' \geq n_0 ' \quad \Rightarrow \quad H' \subset G'
\]
Con lo cual, si escogemos $\varepsilon$ tal que $\max \{\frac{2 \varepsilon}{\delta - \varepsilon}, 2 \varepsilon\} < \varepsilon '$ y $n_0$ lo suficientemente grande, de tal suerte que $(\delta - \varepsilon) n_0 \geq n'_0$, tenemos por hipótesis inductiva que $H' \subset G'$. Por lo tanto, $H \subset G$.
\end{proof}

\begin{lemma}[Lema de inmersión aplicable]\label{lema:regularidad de szemeredi - lema inmersion aplicable}
Sea $H$ un grafo y $\delta >0$. Defina $r = \chi (H)$. Entonces, existen $\varepsilon > 0$ y $n_0 \in \naturals$ tales que
\[
    G \in \mathcal G (K_r , n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{lemma}
\begin{proof}
El Lema \ref{lema:regularidad de szemeredi - lema inmersion general} garantiza que para todo $\delta ' > 0$ existen $\varepsilon ', n'_0$ tales que
\[
    G \in \mathcal G (K_r (t), n' , \varepsilon ' , \delta '), n' \geq n'_0 \quad \Rightarrow \quad K_r (t) \subset G,
\]
donde $t := \abs H$. Como $H \subset K_r (t)$, se tiene que en este caso $H \subset G$.

Concluimos gracias al siguiente ejercicio:
\begin{exercise}
\begin{enumerate}[(1)]
\item[]
\item Demostrar que para todo $\delta > 0$, $n' \in \naturals$ y $\varepsilon ' > 0$, existen $\varepsilon$ y $\delta'$ tales que
\[
    \mathcal G (K_r, n' t , \varepsilon, \delta) \subset \mathcal G (K_r (t), n', \varepsilon ', \delta ').
\]
\item Demostrar que para todo $\delta > 0$, $\varepsilon > 0$ y $n' \in \naturals$ es lo suficientemente grande, se tiene que si
\[
    G \in \mathcal G (K_r, n , \varepsilon, \delta) \quad \text{con } n't \leq n < (n'+1)t,
\]
entonces existe un subgrafo $G' \subset G$ tal que $G' \in \mathcal G (K_r, n't, 2\varepsilon, \delta - \varepsilon)$.
\end{enumerate}
\end{exercise}
\begin{solution}
\begin{enumerate}[(1)]
\item[]
\item Tomemos $n = n' t$. Fijemos un etiquetamiento $K_r = \{w_1, \ldots, w_r\}$ tal que $K_r (t) = \{w_i^j\}_{1 \leq i \leq r}^{1 \leq j \leq t}$ con $w_i^j w_{i'}^{j'} \in E(K_r (t))$ si y solo si $w_i w_{i'} \in E(K_r)$. Entonces si $G \in \mathcal G (K_r , n, \varepsilon, \delta)$, con equipartición $V(G) = \coprod_{i = 1}^r V_i$. Se sigue que podemos subdividir la partición: cada $V_i = \coprod_{j = 1}^t V_i^j$ en otra equipartición con partes de cardinal $n'$.

Ahora busquemos $\varepsilon$ y $\delta'$ tales que $G \in \mathcal G (K_r (t), n', \varepsilon ', \delta')$. Pero si $w_i^j w_{i'}^{j'} \in E(K_r (t))$, entonces $w_i w_{i'} \in E(K_r)$, y por lo tanto el par $(V_i, V_{i'})$ es $\varepsilon$ regular y como $\abs {V_i^j} = \frac{1}{t} \abs{V_i}$ para todo $1 \leq j \leq t$, el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing} garantiza que los pares $(V_i^j, V_{i'}^{j'})$ para $1 \leq j,j' \leq t$ son $\max \{t \varepsilon, 2 \varepsilon\}$-regularaes si $\varepsilon$ es lo suficientemente pequeño, i.e. $\frac 1 t > \varepsilon$. En cuanto a la densidad, nuevamente el Lema de Slicing garantiza que
\[
    d(A_i^j, A_{i'}^{j'}) \geq d(A_i, A_{i'}) - \varepsilon  \geq \delta - \varepsilon.
\]

Por lo tanto, tomamos $\varepsilon < \min \{\varepsilon '/2, \frac 1 t \varepsilon ', \frac 1 t, \delta / 2\}$ y $\delta' =  \delta /2$ y funciona.
\item Sea $G \in \mathcal G (K_r, n , \varepsilon, \delta)$. Luego $V(G) = V_1 \coprod \cdots \coprod V_k$ es una equipartición de $G$ con $\abs{V_i} = n$. Consiederemos cualquier subgrafo $G'$ de $G$ dado por quitar a cada conjunto $V_i$ los suficientes elementos tales que los vértices de $G'$ se equiparticionan en partes de tamaño $n't \geq \frac{n'}{n' + 1} n = (1 - \frac{1}{n'+1}) n = \left (1 - \frac{1}{\ceil {\frac{n}{t}}}\right ) n = \alpha n$, con $\alpha \geq \frac{1}{2}$ para $n'$ lo suficientemente grande ($t$ está fijo). Luego por el Lema de Slicing \ref{lema:regularidad de szemeredi - lema slicing},
\[
    G' \in \mathcal G (K_r, n' t, 2 \varepsilon, \delta - \varepsilon).
\]
\end{enumerate}
\end{solution}

En efecto, para todo $\delta > 0$, el primer ítem dice que
\[
    \mathcal G (K_r, n' t, \varepsilon , \delta '),
\]
para algún $\varepsilon$ y todo $n' \geq n_0'$. Luego, por el segundo ítem, existe $n_0 \in \naturals$ lo sufientemente grande tal que si
\[
    G \in \mathcal G (K_r, n, \varepsilon, \delta),
\]
entonces existe un subgrafo $G' \subset G$ tal que $G' \in \mathcal G (K_r, n' t, 2 \varepsilon , \delta - \varepsilon)$. Juntando ambas cosas obtenemos que
\[
    G \in \mathcal G (K_r, n , \varepsilon, \delta), n \geq n_0 \quad \Rightarrow \quad H \subset G.
\]
\end{proof}

\begin{theorem}[Regularidad de Erdös-Stone]
Para todo grafo $H$ con $e(H) \geq 1$ y cada $\delta > 0$, existe $n_0 \in \naturals$ tales que para todo grafo $G$ con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac{1}{\chi (H)- 1} + 4 \delta\right ) \frac{n^2}{2},
\]
entonces $H \subset G$.
\end{theorem}

\begin{remark}
Como $\delta > 0$ es arbitrario, podríamos reemplazar $4\delta$ por $\delta ' > 0$ arbitrario en el enunciado.
\end{remark}

\begin{proof}
Tomamos $\varepsilon > 0$ lo suficientemente pequeño dado por el Lema de inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable}, y aplicamos Regularidad \ref{theorem:lema de regularidad de szemeredi} para el caso $m \geq \frac 1 \varepsilon$ al grafo $G$ con $r = \chi (H) -1$ satisfaciendo la hipótesis del enunciado. Obtenemos una partición $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ con $m \leq k \leq M$ una equipartición $\varepsilon$-regular. Sea $G'$ el grafo obtenido a partir de $G$ borrando todas ``las aristas sobre las que no hay control'' con parámetro $\varepsilon$ (regularidad) y $\delta$ (densidad). Así, tenemos que $G'$ tiene al menos $e(G) - (3 \varepsilon + \delta) n^2$ aristas por el Lema \ref{lema:regularidad de szemeredi - lema 1}. Sea $R$ el ``grafo reducido'', se tiene
\[
    G' \in \mathcal G (R, n', \varepsilon , \delta)
\]
con $n' := \frac{n - \abs{V_0}}{k}$. Por lo tanto, si $K_{r+1} \subset R$, entonces por el lema de inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable} tendríamos que $H \subset G'$. En efecto, quitando algunas particiones de $V(G')$, obtenemos un subgrafo $G'' \subset G'$ tal que $G'' \in \mathcal G (K_{r+1}, n', \varepsilon, \delta)$.

Supongamos ahora que $K_{r+1} \not \subset R$. Luego por el Teorema de Turán \ref{th:teorema de Turan todo grafo K_k+1 libre en n vertices tiene cantidad de aristas e < t_k (n)}:
\[
    e(R) \leq t_r (k) \sim  \left (1 - \frac 1 r \right ) \frac{k^2}{2} \quad (k \to \infty),
\]
es decir, achicando $\varepsilon$ de ser necesario para que $k$ sea grande y $t_r (k) \leq \left ( 1 - \frac 1 r + \delta \right ) \frac{k^2}{2}$. Se tiene que
\[
    e(G') \leq \left ( 1 - \frac 1 r + \delta \right ) \frac{k^2}{2} \cdot \frac{n^2}{k^2} = \left (1 - \frac 1 r + \delta \right ) \frac{n^2}{2}.
\]
Consecuentemente,
\begin{align*}
e(G) &\leq \left ( 1 - \frac 1 r + \delta \right )\frac{n^2}{2} + 2(3 \varepsilon +\delta)\frac{n^2}{2} \\
    &= \left ( 1 - \frac 1 r + 6 \varepsilon + 3\delta \right ) \frac{n^2}{2} \\
    &< \left ( 1 - \frac 1 r + 4 \delta \right ) \frac{n^2}{2},
\end{align*}
absurdo.
\end{proof}

Segunda aplicación del Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi}:

\begin{theorem}[Erdös-Simonovits]\label{Teorema de Estabilidad de Erdos-simonovits version H general - formulacion 2}

Para todo grafo $H$, y para todo $\delta > 0$, existe $n_0 \in \naturals$ tal que $G$ es un grafo $H$-libre con $n \geq n_0$ vértices y
\[
    e(G) \geq \left ( 1 - \frac 1 {\chi (H) - 1} - \delta \right) \frac{n^2}{2},
\]
entonces $G$ está $(5 \delta n^2)$-cerca de ser $(\chi (H)-1)$-partito.
\end{theorem}

\begin{remark}
Notar que este enunciado es equivalente al enunciado que vimos antes: \ref{Teorema de Estabilidad de Erdos-simonovits version H general}.
\end{remark}

\begin{proof}
Sea $\varepsilon > 0$ lo suficientemente pequeño (que depende de $H$ y $\delta$). Aplicamos el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} para $\varepsilon$ y $m \geq \frac 1 \varepsilon$; obtenemos la equipartición $\varepsilon$-regular $V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k$ con $m \leq k \leq M$ para todo grafo con $\abs G \geq M$.

Luego consideramos el ``grafo reducido'' $R$ con parámetros $\varepsilon$ y $\delta$, y vértices $w_1, \ldots, w_k$. Sea $r = \chi (H) - 1$. Si $K_{r+1} \subset R$, entonces $H \subset G$ por el Lema de Inmersión aplicable \ref{lema:regularidad de szemeredi - lema inmersion aplicable}, lo cual nos lleva a una contradicción. Es decir, $R$ es $K_{r+1}$-libre.

Elijamos $t = 3 \delta k^2$. Si $e(R) < t_r (k)-t$, entonces por el Lema \ref{lema:regularidad de szemeredi - lema 1}, tenemos:
\begin{align*}
e(G) &\leq (\delta + 3 \varepsilon)n^2 + e(R) \cdot \left (\frac n k\right)^2 \\
    &< (\delta + 3 \varepsilon)n^2 + \left ( (1 - \frac 1 r) \frac{k^2}{2} - 3 \delta k^2 \right ) \frac{n^2}{k^2} \\
    &= (1 - \frac 1 r) \frac{n^ 2}{2} + \underbrace{(3 \varepsilon - 2 \delta)}_{< - \frac \delta 2} n^2 \\
    &<(1-\frac 1 r) \frac{n^2}{2} - \frac{\delta}{2} n^2,
\end{align*}
contradicción.

Con lo cual, el Teorema de Estabilidad de Füredi \ref{theorem:teorema de estabilidad de furedi} nos permite suponer que $R$ está $t$-cerca de ser $r$-partito. Es decir, hay una $r$-partición
\[
    V(R) = A_1 \coprod \cdots \coprod A_r
\]
con a lo más $t$ aristas dentro de las partes. Utilizando nuevamente el Lema \ref{lema:regularidad de szemeredi - lema 1} para acotar las aristas despecriables de la partición de $G$, y acotando las aristas dentro de las partes de la partición de $R$, concluimos que es posible borrar a lo más
\[
    \underbrace{t \cdot \left ( \frac n k \right )^2}_{\leq 3 \delta n^2} + \underbrace{(\delta + 3 \varepsilon)n^2}_{\leq 2 \delta n^2} \leq 5 \delta n^2
\]
aristas para obtener una $r$-partición de $G$.
\end{proof}


\bigskip

\begin{lemma}[Lema de conteo general]\label{lema:lema de conteo general - corolario del lema de regularidad de szemeredi}

Para todo grafo $H$, y todo $\delta > 0$, existen $\varepsilon > 0$ y $M \in \naturals$ tales que si
\[
    G \in \mathcal G (H, n, \varepsilon, \delta)
\]
para algún $n \geq M$, entonces $G$ contiene al menos
\[
    \frac{\delta^{e(H)} \cdot n^{\abs H}}{2}
\]
copias de $H$.
\end{lemma}
\begin{proof}
Haremos inducción en $\abs H$, y de hecho nuestra hipótesis inductiva será más fuerte:
\begin{quote}
Para todo grafo $H$, y todo $\delta > 0$, existen $\varepsilon > 0$ y $M \in \naturals$, tales que si
\[
    G \in \mathcal G (H, n , \varepsilon , \delta)
\]
para algún $n \geq M$, y más aún, dada una equipartición $G = V_1 \coprod \cdots \coprod V_l$ indexada según $H = \{w_1, \ldots, w_l\}$ con $(V_i, V_j)$ $\varepsilon$-regular y $d(v_i, V_j) \geq \delta$ siempre y cuando que $w_i w_j \in E(H)$, se tiene que hay al menos
\[
    \frac{\delta^{e(H)} \cdot n^{\abs H}}{2}
\]
copias de $H$, de tal forma que los vértices $x_j$ correspondientes a un $w_j$ vía un isomorfismo con $H$ pertenezcan a $V_j$ para todo $j = 1, \ldots, l$.
\end{quote}
Si $\abs H = 1$, la afirmación es inmediata. Si $\abs H = 2$ y no tiene aristas también es fácil. Si $\abs H = 2$ y $e(H) = 1$, luego basta probar que existen al menos $\delta \frac{n^2}{2}$ aristas en $E(V_0, V_1)$. Pero tomando $\varepsilon < \min \{\delta / 4, 1/8\}$, la $\varepsilon$-regularidad del par $(V_0,V_1)$ junto con $d(V_0,V_1)$ implican que existen vértices $v \in V_1$ tales que
\[
    (\delta - \varepsilon)n \leq \abs{N_G (v) \cap V_0}
\]
salvo $2 \varepsilon n$ vértices por el Lema \ref{lema:regularidad de szemeredi - lema 2}. Es decir, $E(V_0, V_1)$ tiene al menos
\[
    (\delta - \varepsilon)(1-2\varepsilon)n^2 \geq (\frac 3 4 \cdot \frac 3 4) \delta n^2 \geq \frac 1 2 \delta n^2
\]
aristas, como queríamos.

En general, supongamos que $\abs H \geq 3$. Si $G \in \mathcal G (H, n , \varepsilon , \delta)$ para $n \geq M$, entonces $G = V_1 \coprod \cdots \coprod V_l$ con $V_i$ todos de cardinal $n$ y para la escritura $H = \{w_1, \ldots, w_l\}$, $w_i w_j \in E(H)$ si y solo si $(V_i, V_j)$ es $\varepsilon$-regular y $d(V_i, V_j) \geq \delta$.

Consideremos $H' = H \setminus \{w_l\}$ y $G' := G \setminus V_l$, entonces $G' \in \mathcal G (H' , n , \varepsilon, \delta)$ y por hipótesis inductiva existe $M'$ tal que si $n \geq M'$, entonces $G'$ contiene al menos
\[
    \frac{\delta^{e(H')} \cdot n^{\abs {H'}}}{2}
\]
copias de $H'$, donde cada copia tiene su vértice correspondiente a $w_j$ en la parte $V_j$ para cada $j < l$. Ahora, por el Lema \ref{lema:regularidad de szemeredi - lema 2}, para todo $v \in V_l$, salvo $2 \varepsilon n$ vértices, se tiene que
\[
    (\delta - \varepsilon)n \leq \abs {N_G (v) \cap V_j}, \quad \forall j < l.
\]
Por lo tanto, tenemos al menos $(1-2 \varepsilon (l-1))n$ vértices en $V_l$, cada uno con al menos $(\delta - \varepsilon)n$ vecinos en cada $V_j$ con $j <l$, y por lo tanto, $(\delta - \varepsilon)n(l-1)$ vecinos en $G$.

En el peor de los casos, todos los vértices que no son vecinos de $v$ en $V_j$ pertenecen a una de estas copias de $H'$ para cada $j < l$, luego este $v$ forma al menos $\frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1)$ copias de $H$ en $G$. Es decir, $G$ tiene al menos
\[
\left ( \frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1) \right )(1 - 2 \varepsilon(l-1))n
\]
copias de $H$, donde cada copia tiene su vértice correspondiente a $w_j$ en la parte $V_j$ para cada $1 \leq j \leq l$. Así, basta probar que tomando $M \gg M'$ y $\varepsilon > 0$ lo suficientemente chico, esta cantidad es $\geq \frac{\delta^{e(H)} \cdot n^{l}}{2}$.

En efecto, esto equivale a que
\[
    \left ( \frac{\delta^{e ( H')} \cdot n^{l-1}}{2} - (1 - (\delta - \varepsilon))n(l-1) \right )(1 - 2 \varepsilon(l-1)) \geq \frac{\delta^{e(H)} \cdot n^{l-1}}{2}
\]
si y solo si,
\[
\frac{\delta^{e(H')} \cdot n^{l-1}(1 - 2 \varepsilon (l-1))}{2} - \frac{\delta^{e(H)}\cdot n^{l-1}}{2} \geq (1- (\delta - \varepsilon))(l-1)(1-2\varepsilon (l-1))n.
\]
Es decir, hay que probar
\[
    \left ( \delta^{e(H')}(1- 2 \varepsilon (l-1)) - \delta^{e(H)} \right )\frac{n^{l-2}}{2} \geq (1- (\delta - \varepsilon))(l-1)(1-2\varepsilon (l-1)).
\]
Pero como $l \geq 3$, se sigue que si $\varepsilon>0$ es lo suficientemente chico (por ejemplo $\varepsilon < \frac{1 - \delta^{e(H)- e(H')}}{2(l-1)}$), existe $M$ con $M \geq M'$ lo suficientemente grande, tal que si $n \geq M$, el lado izquierdo ess más grande que el lado derecho (que no depende de $n$) pues
\[
    \left ( \delta^{e(H')}(1- 2 \varepsilon (l-1)) - \delta^{e(H)} \right ) > 0.
\]
\end{proof}

Apliación $3$ del Lema de Regularidad de Szemeredi \ref{theorem:lema de regularidad de szemeredi}:

\begin{theorem}[Teorema de Roth]\label{th:teorema de Roth}
Para todo $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $n \geq n_0$ y $A \subset \{1 , \ldots, n\}$ con $\abs A > \varepsilon n$, entonces $A$ contiene una \textit{$3$-progresión aritmética}\footnote{En general, una \textbf{$k$-progresión aritmética} es una secuencia de enteros $a, a+d, a + 2d , \ldots, a + (k-1)d$.}.
\end{theorem}

\begin{lemma}[Lema de remoción de triángulos]\label{lema:lema de remocion de triangulos}

Para todo $\alpha > 0$, existe $\beta > 0$ tal que todo grafo $G$ con $n$ vértices y a lo más $\beta n^3$ triángulos, puede ser $K_3$-libre borrando a lo más $\alpha n^2$ aristas
\end{lemma}
\begin{proof}
Tomemos $0 < \delta < \frac{ \alpha}{3}$ y $\varepsilon < \frac{\delta}{9}$ lo suficientemente chico. Aplicamos el Lema de Regularidad de Szémeredi \ref{theorem:lema de regularidad de szemeredi} con parámetros $\varepsilon$ y $m \geq \frac 1 \varepsilon$, obteniendo una partición de un grafo $G$ con $\abs G \geq M \geq k \geq m$,
\[
    V(G) = V_0 \coprod V_1 \coprod \cdots \coprod V_k.
\]
Consideremos el grafo reducido $R$ con parámetros $\varepsilon$ y $\delta$. Notar que el subgrafo $G' := G \setminus V_0 \subset G$ cumple que $G' \in \mathcal G (R, n', \varepsilon, \delta)$ con $n' \geq \frac{(1- \varepsilon)n}{k} \geq \frac{1-\varepsilon}{M}n$.

Supongamos que $R$ tiene al menos un triángulo $K_3$. Entonces $G'$ tiene un subgrafo $G''$ dado por quedarnos solamente con las partes $V_i, V_j, V_k$ correspondientes a vértices $w_i,w_j,w_k$ que forman un triángulo en $R$; en particular, $G'' \in \mathcal G (K_3, n', \varepsilon, \delta)$. Aplicando el Lema de conteo general \ref{lema:lema de conteo general - corolario del lema de regularidad de szemeredi} para $H = K_3$ y el subgrafo $G'' \in \mathcal G (H, n' , \varepsilon, \delta)$, tenemos que $G''$, y por lo tanto $G$, tiene al menos:
\[
    \delta^3 \cdot \left ( \frac{(1 - \varepsilon)n}{k} \right )^3 > \frac{\delta^3}{2} \frac{(1- \varepsilon)^3}{M^3} \cdot n^3 > \beta n^3
\]
triángulos para $n$ lo suficientemente grande, donde $\beta < \frac{\delta^3}{2} \frac{(1- \varepsilon)^3}{M^3}$. Achicando $\beta$ de ser necesario, podemos asumir que $n$ es arbitrario.

Con lo cual, si $G$ tiene a lo más $\beta n^3$ triángulos, el párrafo anterior nos dice que $R$ no tiene triángulos. Así, al remover $\leq (\delta + 3 \varepsilon)n^2 < \alpha n^2$ aristas de $G$ (ver Lema \ref{lema:regularidad de szemeredi - lema 1}), nos quedamos sin triángulos.
\end{proof}

\begin{theorem}[Teorema de Roth]\label{theorem:teorema de Roth}
Para todo $\varepsilon > 0$, existe $n_0 \in \naturals$ tal que si $n \geq n_0$ y $A \subset \{1, \ldots, n\}$ con $\abs A > \varepsilon n$, entonces $A$ contiene una $3$-progresión aritmética.
\end{theorem}
\begin{proof}
Vamos a probar que si $A$ no contiene una $3$-progresión aritmética, entonces $\abs A = o (n)$.

Sea $\varepsilon > 0$, y $n$ lo suficientemente grande, supongamos que $\abs A \geq \varepsilon n$ y que no contiene $3$-progresiones aritméticas. Definimos un grafo $G$ con $V(G) = X \coprod Y \coprod Z$, disjuntos y $\abs X = \abs Y = \abs Z = 3n$ cada conjunto $X,Y,Z$ es una copia de $\{1, \ldots, 3n\}$.
\begin{align*}
E(X,Y) &= \set{xy | x\in X, y \in Y, y = x + a \text{ para algún $a \in A$}}. \\
E(Y,Z) &= \set{yz | y\in Y, z \in Z, z = y + a \text{ para algún $a \in A$}}. \\
E(X,Z) &= \set{xz | x\in X, z \in Z, z = x + 2a \text{ para algún $a \in A$}}.
\end{align*}

Si $xyz$ es un triángulo en $G$, entonces existen $a,a',a'' \in A$ tales que
\[
\left \{
  \begin{array}{ll}
  y = x+ a, &a \in A \\
  z = y + a', &a' \in A \\
  z = x + 2a'', &a'' \in A,
  \end{array}
  \right .
\]
y esto es una $3$-progresión aritmética $a, a'' = a +(a'-a''), a' = a + 2 (a'-a'')$ si $a,a', a''$ son distintos. Como $A$ no tiene $3$-progresiones aritméticas, entonces cada triángulo en $G$ es de la forma $xyz$ con $y = x+a$, $z = x + 2 a$. Lo cual implica que cada triángulo queda completamente determinado por $x$ y $a$. Consecuentemente $G$ tiene a lo más
\[
    3n \abs A \leq 3n^2 = o (n^3)
\]
triángulos.

Por el Lema de Remoción de Triángulos \ref{lema:lema de remocion de triangulos}, es posible borrar $o(n^2)$ aristas de $G$ para obtener un grafo libre de triángulos. Ahora, vamos a obtener una cota por abajo de la cantidad de triángulos arista disjunto que tiene $G$: consideremos el conjunto de tripletas de la forma $(x,x+a,x+2a)$, con $x\in X, a \in A$. Observar que cada tripleta corresponde con un triángulo de $G$ y todos son arista-disjuntos entre sí, por lo tanto $G$ contiene al menos $3n \abs A> 3 \varepsilon n^2$ triángulos disjuntos y por lo tanto si o si deben ser quitados para que $G$ sea libre de triángulos. Contradiciendo el Lema de Remoción de Triángulos.
\end{proof}










%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Teoría de Ramsey}

\begin{notation}
Cuando nos refiramos a una \textbf{$r$-coloración} de un grafo $G$, será una función $c : E(G) \to \{1, \ldots, r\}$ que a cada arista $e \in E(G)$, le asigna un \textbf{color} $c(e)$ (No necesariamente la coloración es \textit{propia}, es decir, pueden existir aristas adyacentes con el mismo color).
\end{notation}

\begin{notation}
Sea $G$ un grafo con una coloración $c$. Entonces dado un vértice $v \in V(G)$, podemos considerar los vecinos $w$ de $v$ tales que $c(vw) = i$. Notaremos a este subconjunto de vecinos de $v$ como $N^{i}_G (v)$, o simplemente $N^i (v)$ cuando el contexto sea claro.
\end{notation}


La teoría de Ramsey se motiva mediante el siguiente ejemplo:
\begin{example}\label{ejemplo:2-coloracion de K_6}
Toda $2$-coloración de $K_6$ genera un triángulo monocromático.
\end{example}
\begin{proof}
Sea $v \in V(K_6)$. Hay al menos $3$ aristas incidentes a $v$ que tienen el mismo color, digamos rojo, por el principio del palomar. Si en $N^{\text{rojo}} (v)$ hay aristas rojas, entonces hay un triángulo rojo. Si no, todas las aristas entre vértices de $N^{\text{rojo}} (v)$ son azules. Como, $\abs{N^{\text{rojo}}(v)} \geq 3$, entonces hay un triángulo azul en $K_6[N^{\text{rojo}}(v)]$, y por lo tanto había un triángulo azul en $K_6$.
\end{proof}

\begin{theorem}[Teorema de Ramsey (1930)]
Para todo $k, r \in \naturals$, existe un $n \in \naturals$ tal que toda $r$-coloración de $K_n$ genera un $K_k$ monocromático.
\end{theorem}
\begin{proof}
Sea $v_1 \in V(K_n)$. Existe algún color $c_1 \in \{1, \ldots, r\}$ tal que las aristas incidentes a $v_1$ de color $c_1$ son al menos
\[
    \frac{n-1}{r},
\]
escribamos $A_1 := N^{c_1}_{K_n} (v_1)$. Similarmente, sea $v_2 \in K_n [A_1]$, existe un color $c_2 \in \{1, \ldots,r \}$ tal que las aristas incidentes a $v_2$ en $K_n [A_1]$ son de color $c_2$ y por lo menos hay
\[
    \frac{\abs{A_1}-1}{r},
\]
escribamos $A_2 := N^{c_2}_{K_n[A_1]} (v_2)$.
Continuando este procedimiento, para $n$ lo suficientemente grande, obtenemos una secuencia
\[
    v_1, c_1, v_2, c_2, v_3, c_3, \ldots, v_t,c_t,
\]
en donde si $t \geq r k$, se sigue que existe un color que se repite al menos $k$ veces en esta secuencia, y por lo tanto, sus vértices $v_{i_1}, \ldots, v_{i_k}$ correspondientes forman un $K_k$ monocromático de se color.
\end{proof}

\begin{exercise}
Calcular una cota inferior para $n$.
\end{exercise}
\begin{solution}
Escribamo $a_1, a_2, \ldots$ para la secuencia de cardinales de los conjuntos $A_1, A_2, \ldots$. Inspeccionando la demostración anterior, vemos que $a_1 \geq \frac{n-1}{r}$ y que recursivamente $a_{t+1} \geq \frac{a_t - 1}{r}$, $t \geq 1$. Por lo tanto, tenemos que inductivamente:
\[
    a_{t+1} \geq \frac{n}{r^{t+1}} - \sum_{i = 1}^{t+1} \frac{1}{r^i} = \frac{n}{r^{t+1}}  - \frac{1}{r} \frac{1 - r^{t+1}}{1 - r}, \quad t \geq 0.
\]
Con lo cual, si $t \geq r k$ como en la demostración de arriba, se sigue que
\[
    n \geq a_{rk} \geq  \frac{n}{r^{rk}} - \frac{1}{r} \frac{1 - r^{rk}}{1 -r},
\]
y consecuentemente,
\[
    \boxed{n \geq \frac{r^{rk-1}}{1 - r}.}
\]
\end{solution}

\section{Números de Ramsey}

\begin{definition}
El número de Ramsey $R(k)$, es el mínimo $n$ tal que cualquier $2$-coloración de $K_n$ contiene una copia monocromática de $K_k$.
\end{definition}


\begin{example}
En el Ejemplo \ref{ejemplo:2-coloracion de K_6} vimos que $R(3) \leq 6$. Pero de hecho, es fácil encontrar una $2$-coloración de $K_5$ que no contiene triángulos monocromáticos, y por lo tanto, $R(3) = 6$:

\Inkscape{$2$-coloración de $K_5$ libre de triángulos monocromáticos.}{"./Figuras/Teoria de Ramsey/Figura 1.pdf_tex"}
\end{example}


\begin{definition}
Sean $G$, $H_1$ y $H_2$ grafos, escribimos $G \to (H_1, H_2)$ si toda $2$-coloración de $G$ con rojo-azul de E(G) contiene una copia de $H_1$ rojo o una copia de $H_2$ azul.

Para $s,t \in \naturals$ definimos
\[
    R(s,t) := \min \{n \in \naturals | K_n \to (K_s,K_t)\}.
\]
(En particular, $R(k) = R(k,k)$).
\end{definition}


\begin{theorem}[Erdös-Szekeres (1935)]
Para todo $k \geq 1$, se tiene que
\[
    R(k) \leq \binom{2k-2}{k-1} \leq \frac{4^{k-1}}{\sqrt {\pi (k-1)}}.
\]
\end{theorem}
\begin{proof}
La segunda desigualdad se deduce de una aplicación inmediata de las desigualdades probadas en \cite{herbertRobbins1955}. Concentrémonos en la primera desigualdad, y de hecho, probaremos una versión un poco más general:

\[
    R(s,t) \leq \binom{s + t - 2}{s-1}.
\]
Notar que tomando $s = t = k$ se prueba la primera desigualdad del teorema.

Para eso, necesitamos un lema previo:
\begin{lemma}
Para todo $s,t \geq 2$, se tiene
\[
    R(s,t) \leq R(s-1, t) + R(s,t-1).
\]
\end{lemma}
\begin{proof}
En efecto, sea $c$ una coloración de $E(K_n)$ con $n = R(s-1,t) + R(s,t-1)$. Queremos probar que hay una copia roja de $K_s$ o una copia azul de $K_t$. Sea $v \in K_n$, entones hay dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] Existen al menos $R(s-1,t)$ aristas rojas incidentes a $v$, o
\item[\textbf{Caso 2:}] Existen al menos $R(s,t-1)$ aristas azules incidentes a $v$.
\end{enumerate}
En cualquier caso extendemos completos monocromáticos en el vecindario de $v$ a un $K_s$ rojo o un $K_t$ azul, respectivamente.
\end{proof}

Ahora, probemos la desigualdad por inducción en $s+t$, el caso base es $R (1,t) = R(s,1) = 1$. En general, si $\min \{s,t\} \geq 2$, tenemos que por el lema de arriba
\begin{align*}
    R(s,t) &\leq R(s-1,t) + R(s,t-1) \\
        &\leq  \binom{s + t -3}{s-2} + \binom{s+t-3}{s-1} = \binom { s+ t -2 }{s-1}.
\end{align*}

\end{proof}

\begin{obs}\label{obs:cota inferior trivial del numero de ramsey (orden lineal)}
Existe una cota inferior muy mala, para valores de $k$ grandes, del número de Ramsey:
\[
    R(k) \geq 2 (k-1), \quad k \geq 2.
\]
\end{obs}
\begin{proof}
Supongamos $k > 3$, pues el caso $k = 2$ es trivial.

En efecto, sea $n = 2 (k-1)$, entonces particionando los vértices de $K_n$ en dos conjuntos $A_1, A_2$ de tamaño $k-1$, y pintando las aristas de $K_n[A_1]$ y $K_n[A_2]$ de azul, pero las aristas entre $A_1$ y $A_2$ de rojo, obtenemos una coloración libre de $K_k$ monocromáticos. En efecto, si existiera un $K_k$ monocromático, entonces no puede ser azul porque cada $A_i$ tiene $k-1$ vértices; por otro lado no puede ser rojo porque en una partición hay almenos un vértice y en otra almenos $2$ (estamos en el caso $k > 3$), digamos en $A_1$ y $A_2$ respectivamente, entonces en $K_n [A_2]$ debería haber una arista color rojo, absurdo.
\end{proof}
El siguiente teorema confirma que la cota anterior es \textit{muy poco óptima}.

\begin{theorem}[Erdös (1947)]
\[
    R(k)  \geq 2^{k/2}, \quad \forall k \geq 2.
\]
\end{theorem}
\begin{proof}
Consideremos $K_n$ con $n = \ceil{2^{k/2}}$ y supongamos que $k \geq 6$, notar que los casos $k = 2 , \ldots, 5$ valen por la cota de la Observación anterior \ref{obs:cota inferior trivial del numero de ramsey (orden lineal)} (que es mejor para $k$ chico).

Tenemos exactamente
\[
    2^{\binom n 2}
\]
2-coloraciónes de $E(K_n)$. Vamos a mostrar que la cantidad de $2$-coloraciones de $E(K_n)$ que contienen a $K_k$ monocromático es $< 2^{\binom m 2}$. Para eso, notar que en este caso tenemos $\binom n k$ formas de elegir una copia de $K_k$ y luego $2^{\binom n 2 - \binom k 2 + 1}$ formas de colorear el resto de las aristas. Por lo tanto, la cantidad de $2$-coloraciones que contienen un $K_k$ monocromático es menor o igual que
\begin{align*}
\binom n k 2^{\binom n 2 - \binom k 2 + 1} &\leq \left (\frac{en}{k} \right )^{k} 2^{\binom n 2 - \binom k 2 + 1} \\
&\leq \left ( \frac{e (2^{k/2} + 1)}{k} \right )^k 2^{-\frac{k(k-1)}{2}} 2 \cdot 2^ {\binom n 2},
\end{align*}
pero notar que si $k \geq 6$, entonces
\[
    \left ( \frac{e (2^{k/2} + 1)}{k} \right )^k 2^{\frac{k(k-1)}{2}} \cdot 2 \leq \left ( \frac{2^{k/2} + 1}{2} \right )^k 2^{- \frac{k(k-1)}{2}} \cdot 2< 1,
\]
de donde se sigue lo que queríamos. En efecto, se puede realizar un estudio cualitativo de la función para $k \in \reals_{\geq 6}$ utilizando cálculo elemental.
\end{proof}





\begin{definition}
En general, el \textbf{número de Ramsey con $r$ colores} $R_r (k)$ es el mínimo $n$ tal que todo $r$-coloreo de $K_n$ tiene un $K_r$ monocromático.
\end{definition}

\begin{theorem}
Para todo $r \geq 2$, se tiene que
\[
    2^r \leq R_r (3) \leq 3 \cdot r!.
\]
\end{theorem}
\begin{proof}
Primero veamos la cota inferior, para eso consideremos $n:= 2^r$ y encontraremos una $r$-coloración de $K_n$ sin triángulos monocromáticos. Haremos inducción en $r$, si $r = 2$ vale, pues podemos considerar la siguiente coloración:
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 6.pdf_tex"}
Para el paso inductivo, consideremos una partición en dos partes de $2^{r-1}$ vértices, donde el conjunto $A$ y el $B$ tienen $(r-1)$-coloraciones sin triángulos monocromáticos, por hipótesis inductiva, y luego pintamos las aristas entre $A$ y $B$ de color $r$ que nunca fue utilizado.
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 7.pdf_tex"}

Ahora veamos la cota superior. En el Ejemplo \ref{ejemplo:2-coloracion de K_6} vimos que $R_2(3) \leq 6 = 3 \cdot 2 !$, así vale el caso $r = 2$. Supongamos ahora que $r \geq 3$, y que $n = 3 \cdot r!$, sea $v_0 \in K_n$ fijo, y $c$ una $r$-coloración de $K_n$. Entonces existe un color $i \in  \{1, \ldots, r\}$ tal que
\[
    E_i^0 = \abs{\set{uv_0 \in K_n | c (uv) = i}} \geq \frac{3 \cdot r !}{r} = 3 \cdot (r-1)!
\]
y sea $A := N_{K_n}^i (v_0)$. Pueden ocurrir dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] El color $i$ aparece en una arista de $K_n [A]$, luego tenemos un triángulo de color $i$.
\item[\textbf{Caso 2:}] En $K_n [A]$ no aparece el color $i$, entonces la coloración $c$ inducida en $K_n [A]$ es una $(r-1)$-coloración, con lo cual por hipótesis inductiva existe un triángulo monocromático en $K_n [A]$, en particular en $K_n$.
\end{enumerate}

\Inkscape{Ilustración del Caso 1.}{"./Figuras/Teoria de Ramsey/Figura 2.pdf_tex"}
\end{proof}


\begin{definition}
El \textbf{número de Ramsey de $H_1$ versus $H_2$} está definido por:
\[
    r(H_1, H_2) = \min \{ n | K_n \to (H_1, H_2)\}.
\]

En particular, escribimos $r (H):= r (H,H)$.
\end{definition}


\begin{theorem}
\[
    r(K_3, P_k) = 2k +1.
\]
\end{theorem}
\begin{proof}
Primero acotaremos por abajo: sea $n = 2k$, consideramos la siguiente coloración de $K_n$:
\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 3.pdf_tex"}
Particionamos $K_n$ en dos partes de $k$ vértices cada uno y pintamos las aristas de color azúl, y las aristas entre ambas particiones las pintamos de rojo. Claramente no hay caminos de longitud $k$ de color azul porque las particiones tienen $k$ vértices y no hay triángulos rojos porque las aristas rojas inducen un grafo bipartito.

Para la cota superior, consideremos $K_n$ con $n = 2k + 1$. Sea $P$ un camino maximal de color azul; supongamos que $\abs{V (P)} \leq k$ y entonces $B := V(K_n) \setminus V(P)$ tiene al menos $k+1$ vértices. Sea $v_0$ un extremo de $P$, por maximalidad $v_0$ está conectado a cada vértice de $B$ por aristas rojas. Tenemos dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] Si en $K_n [B]$ hay aristas rojas entonces hay un triángulo de color rojo (con un vértice $v_0$).
\item[\textbf{Caso 2:}] Si en $K_n [B]$ no hay aristas rojas, entonces todas las aristas son azules y por lo tanto hay una copia de $K_{k+1}$ azul, y por lo tanto contiene a $P_k$ de color azul.
\end{enumerate}
\end{proof}

\begin{theorem}
Sea $T_k$ un árbol con $k$ aristas (i.e., $k+1$ vértices). Entonces
\[
    r(K_3, T_k) = 2k +1.
\]
\end{theorem}
\begin{proof}
Para la primera desigualdad se puede aplicar un razonamieneto similar a la demostración del teorema anterior. Veamos entonces solo la cota superior.

Sea $n = 2k + 1$ y consideremos $K_n$ con una coloración. Supongamos entonces que existe un vértice $v$ de grado rojo al menos $k+1$. Entonces la vecindad $N^{\text{rojo}} (v)$ induce un $K_{k+1}$ que si tiene alguna arista roja entonces existe un triángulo rojo en $K_n$, y si no, $K_n$ contiene un $K_{k+1}$ con aristas azules y en particular contiene un $T_k$ azul.

\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 4.pdf_tex"}

Ahora, supongamos que todo vértice tiene grado rojo $\leq k$. Esto implica que el grado mínimo del subgrafo azul inducido es $\geq k$, y por lo tanto el Lema \ref{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices} nos permite encontrar una copia de $T_k$ en el subgrafo azul inducido, en particular $K_n$ tiene una copia azul de $T_k$.
\end{proof}

\begin{theorem}[Chvátal (1977)]
Sea $T_k$ un árbol con $k$ aristas, y sea $s \geq 2$. Entonces
\[
    r(K_{s+1}, T_k) = s \cdot k  + 1.
\]
\end{theorem}
\begin{proof}
Primero veamos la cota inferior: sea $n = s\cdot k$, consideremos la siguiente coloración de $K_n$: el grafo azul consiste de $s$ copias de $K_k$ y las aristas rojas son las aristas entre los vértices de las copias de $K_k$.

\Inkscape{}{"./Figuras/Teoria de Ramsey/Figura 5.pdf_tex"}

Para la cota superior, haremos inducción en $s \geq 2$. Si $s = 2$, tenemos que $r (K_3, T_k) \leq 2 k + 1$ por el teorema anterior. Supongamos ahora que $s \geq 3$. Sea $n = s\cdot k + 1$. Sea $v$ un vértice con grado rojo $\geq (s-1)k + 1$, y sea $A$ la vecindad roja de $v$. Por hipótesis inductiba en $K_n[A]$, hay una copia de $K_s$ rojo, o una copia de $T_k$ azul y ganamos. Así, podemos asumir que el grado rojo de cada vértice es $\leq (s-1)k$. Esto implica que el grafo azul tendrá grado mínimo $\geq (s \cdot k +1 ) - 1 - (s + 1) k \geq k$. Con lo cual contiene una copia de $T_k$ por el Lema \ref{lemma:si G contiene un vertice de grado almenos k entonces contiene un arbol T con k + 1 vertices}.
\end{proof}

\begin{theorem}
Para todo $k \in \naturals$ se tiene que
\[
    \boxed{r (P_k) = \ceil{\frac{3k}{2}}}.
\]
\end{theorem}
\begin{proof}
Veamos primero la cota inferior. Sea $n := \ceil{\frac{3k}{2}}-1$. Consideremos un $K_k$ azul en $K_n$ y escribamos $A$ al conjunto de sus vértices; el resto de las aristas las pintamos de rojo. Notar que $B:= V(K_n) \setminus V(K_k)$ cumple
\[
    \abs B < \frac{k}{2}.
\]
Así, $K_n$ no tiene un $P_k$ azul. Veamos que tampoco tiene un rojo:

Tomemos un camino rojo $P$, luego no puede tener dos vértices adyacentes de $A$ (pues $K_n [A]$ es un completo azul). Por lo tanto en el peor de los casos $P$ tiene $\abs B$ vértices de $B$ tales que entre cada par consecutivos de estos hay un vértice de $A$. O sea,
\[
    \abs{P} \leq 2\abs{B} + 1 < k + 1.
\]
Es decir, tampoco tiene un $P_k$ rojo.

\Inkscape{Ilustración de esta situación.}{"./Figuras/Teoria de Ramsey/Figura 8.pdf_tex"}

\bigskip

Veamos ahora la cota superior.

\end{proof}

\section{Problema del final feliz}

\begin{quote}[El problema de E. Klein (1930)]
Para todo $k \in \naturals$, existe $n = n(k) \in \naturals$ tal que dados $n$ puntos en posición general del plano (i.e. no hay $3$ puntos colineales). Entonces el conjunto de puntos contiene $k$ puntos en posición convexa.
\end{quote}
Ella probó el caso $k = 4$ y $n = 5$: consideramos la cápsula convexa de los $5$ puntos, si los vértices son $4$ o $5$ de estos puntos ya ganamos, si no, existen dos puntos que están contenidos en el interior del triángulo convexo (formado por $3$ de estos puntos como vértices). Luego simplemente considerar la recta que une a estos dos puntos interiores, interseca a dos lados distintos del triángulo y por lo tanto hay $4$ puntos en posición convexa:

\Inkscape{Dibujo}{}

En general, se probó lo siguiente:

\begin{definition}
Sea una $r$-coloración de subconjuntos de $\{1, \ldots, n\}$ de tamaño $s$, digamos
\[
    c : \binom{\{1, \ldots, n\}}{s} \longrightarrow \{1, \ldots, r\}.
\]
Diremos que el conjunto $A \subset \{1, \ldots, n\}$ es monocromático si $c$ es constante en $\binom A s := \{S\subset A | \abs S = s\}$.
\end{definition}

\begin{theorem}[Teorema de Ramsey Generalizado]\label{th:teorema de Ramsey Generalizado}
Para todo $k,r,s \in \naturals$, existe $n \in \naturals$ tal que toda $r$-coloración de $\binom{\{1, \ldots, s\}}{s}$ contiene un conjunto monocromático de tamaño $k$.
\end{theorem}

\begin{remark}
Nosotros probamos el caso $K_n$ en lugar de $\binom{\{1,\ldots,n\}}{s}$ con $s = 2$ y $K_k$ monocromático.
\end{remark}

\begin{proof}[Problema de Klein]
Tomemos una coloración rojo-azul $c$ del conjunto $\binom{\{1, \ldots, n\}}{4}$. Y coloreemos $c(S)$ de rojo si y solo si los puntos de $S$ están en posición convexa. Por el Teorema de Ramsey Generalizado \ref{th:teorema de Ramsey Generalizado}, existe $n$ tal que $B \subset \{1, \ldots, n\}$ es monocromático y $\abs B = k$. Hay dos casos:
\begin{enumerate}
\item[\textbf{Caso 1:}] $B$ es rojo, y por lo tanto todos los subconjuntos de tamaño $4$ de $B$ tienen color rojo, i.e., están en posición convexa. Ahora, los puntos de $B$ están en posición convexa, de lo contrario, podríamos encontrar un punto de $B$ en el interior de un triángulo con vértices de $B$ (notar que esto vale por no-colinealidad: trazamos las diagonales entre vértices del polígono convexo el punto no puede estar en ninguna de estas rectas, i.e., está dentro de un triángulo), absurdo.
\item[\textbf{Caso 2:}] $B$ es azul, como $k \geq 5$, por el resultado preliminar de Klein, existen $4$ puntos en posición convexa, absurdo.
\end{enumerate}
\end{proof}
























%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%import{nombre de carpeta/}{Nombre del archivo}
%\subfile{Apendice/Apendice.tex}





%--------------------------------
\newpage

\bibliographystyle{alpha}
\bibliography{main}{}

%--------------------------------







\end{document}

